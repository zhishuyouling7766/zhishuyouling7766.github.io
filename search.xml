<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Android åº”ç”¨å‘å¸ƒç­¾å Keystore æ–‡ä»¶ç”Ÿæˆè®°å½•</title>
    <url>/2025/03/02/Android_Keystore_%E7%94%9F%E6%88%90%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<blockquote>
<p>åœ¨ Android ç³»ç»Ÿä¸­ï¼Œæ¯ä¸€ä¸ª APK å¿…é¡»ä½¿ç”¨ä¸€ä¸ªæœ‰æ•ˆçš„ç­¾åå¯†é’¥ï¼ˆKeystoreï¼‰è¿›è¡Œç­¾åï¼Œç³»ç»Ÿæ‰å…è®¸å…¶å®‰è£…ä¸è¿è¡Œã€‚å¯¹äº Qt å¼€å‘çš„ Android åº”ç”¨ï¼Œç”Ÿæˆå¹¶é…ç½® <code>.keystore</code> æ˜¯å‘å¸ƒé˜¶æ®µçš„å¿…è¦æ­¥éª¤ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ“Œ-ä¸€ã€Keystore-çš„ä½œç”¨"><a href="#ğŸ“Œ-ä¸€ã€Keystore-çš„ä½œç”¨" class="headerlink" title="ğŸ“Œ ä¸€ã€Keystore çš„ä½œç”¨"></a>ğŸ“Œ ä¸€ã€Keystore çš„ä½œç”¨</h2><ul>
<li>ğŸ” <strong>èº«ä»½è®¤è¯</strong>ï¼šç­¾åè¡¨æ˜è¿™ä¸ª APK æ¥è‡ªä½ è¿™ä¸ªå¼€å‘è€…ã€‚</li>
<li>ğŸ“¦ <strong>åº”ç”¨å‡çº§ç»‘å®š</strong>ï¼šä»¥åè¯¥åº”ç”¨çš„æ‰€æœ‰ç‰ˆæœ¬å¿…é¡»ä½¿ç”¨åŒä¸€ä¸ª keystore ç­¾åï¼Œå¦åˆ™æ— æ³•è¦†ç›–å®‰è£…ã€‚</li>
<li>ğŸª <strong>åº”ç”¨å•†åº—è¦æ±‚</strong>ï¼šå¦‚ Google Playã€åä¸ºåº”ç”¨å¸‚åœºç­‰ï¼Œå‡å¼ºåˆ¶è¦æ±‚ Release APK å¿…é¡»ç­¾åã€‚</li>
</ul>
<hr>
<h2 id="ğŸ§ª-äºŒã€éªŒè¯ç³»ç»Ÿæ˜¯å¦å·²å®‰è£…-JDK-å’Œ-keytool"><a href="#ğŸ§ª-äºŒã€éªŒè¯ç³»ç»Ÿæ˜¯å¦å·²å®‰è£…-JDK-å’Œ-keytool" class="headerlink" title="ğŸ§ª äºŒã€éªŒè¯ç³»ç»Ÿæ˜¯å¦å·²å®‰è£… JDK å’Œ keytool"></a>ğŸ§ª äºŒã€éªŒè¯ç³»ç»Ÿæ˜¯å¦å·²å®‰è£… JDK å’Œ keytool</h2><p>æ‰“å¼€å‘½ä»¤è¡Œï¼ˆCMD æˆ– PowerShellï¼‰ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -version</span><br><span class="line">keytool -<span class="built_in">help</span></span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">java version &quot;1.8.0_331&quot;</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_331-b09)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.331-b09, mixed mode)</span><br><span class="line"></span><br><span class="line">keytool é€‰é¡¹:</span><br><span class="line">-certreq  ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚ (CSR)</span><br><span class="line">-genkey    ç”Ÿæˆå¯†é’¥å¯¹</span><br><span class="line">-help      æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ <code>keytool</code> æ— æ³•è¯†åˆ«ï¼Œè¯·ç¡®è®¤ JDK å®‰è£…è·¯å¾„æ˜¯å¦å·²åŠ å…¥ç¯å¢ƒå˜é‡çš„ Path ä¸­ã€‚</p>
<hr>
<h2 id="ğŸ§©-ä¸‰ã€Keystore-ç”Ÿæˆå‘½ä»¤"><a href="#ğŸ§©-ä¸‰ã€Keystore-ç”Ÿæˆå‘½ä»¤" class="headerlink" title="ğŸ§© ä¸‰ã€Keystore ç”Ÿæˆå‘½ä»¤"></a>ğŸ§© ä¸‰ã€Keystore ç”Ÿæˆå‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">keytool -genkey -v -keystore my-release-key.keystore -<span class="built_in">alias</span> my-key-alias -keyalg RSA -keysize 2048 -validity 10000</span><br></pre></td></tr></table></figure>

<h3 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>-genkey</code></td>
<td>è¡¨ç¤ºç”Ÿæˆå¯†é’¥å¯¹ï¼ˆkey pairï¼‰</td>
</tr>
<tr>
<td><code>-v</code></td>
<td>è¾“å‡ºè¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td><code>-keystore</code></td>
<td>æŒ‡å®šè¾“å‡ºçš„ keystore æ–‡ä»¶å</td>
</tr>
<tr>
<td><code>-alias</code></td>
<td>ä¸ºå¯†é’¥è®¾ç½®ä¸€ä¸ªåˆ«å</td>
</tr>
<tr>
<td><code>-keyalg RSA</code></td>
<td>ä½¿ç”¨ RSA åŠ å¯†ç®—æ³•ç”Ÿæˆå¯†é’¥</td>
</tr>
<tr>
<td><code>-keysize 2048</code></td>
<td>å¯†é’¥é•¿åº¦ä¸º 2048 ä½</td>
</tr>
<tr>
<td><code>-validity 10000</code></td>
<td>å¯†é’¥æœ‰æ•ˆæœŸä¸º 10000 å¤©ï¼ˆçº¦ 27 å¹´ï¼‰</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ›¡ï¸-å››ã€æ‰§è¡Œåæç¤ºå¡«å†™ä¿¡æ¯"><a href="#ğŸ›¡ï¸-å››ã€æ‰§è¡Œåæç¤ºå¡«å†™ä¿¡æ¯" class="headerlink" title="ğŸ›¡ï¸ å››ã€æ‰§è¡Œåæç¤ºå¡«å†™ä¿¡æ¯"></a>ğŸ›¡ï¸ å››ã€æ‰§è¡Œåæç¤ºå¡«å†™ä¿¡æ¯</h2><p>ä¾æ¬¡è¾“å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ol>
<li>å¯†é’¥åº“å£ä»¤ï¼ˆkeystore passwordï¼‰</li>
<li>å§“åï¼ˆYour first and last nameï¼‰</li>
<li>ç»„ç»‡å•ä½åï¼ˆOrganizational unitï¼‰</li>
<li>ç»„ç»‡åï¼ˆOrganizationï¼‰</li>
<li>åŸå¸‚åï¼ˆCity or Localityï¼‰</li>
<li>çœä»½åï¼ˆState or Provinceï¼‰</li>
<li>å›½å®¶ä»£ç ï¼ˆCountry Codeï¼Œå¦‚ <code>CN</code>ï¼‰</li>
<li>ç¡®è®¤ä¿¡æ¯æ˜¯å¦æ­£ç¡®ï¼ˆè¾“å…¥ <code>æ˜¯</code> æˆ– <code>yes</code>ï¼‰</li>
<li>å¯é€‰è®¾ç½®å¯†é’¥å£ä»¤ï¼ˆä¸ keystore ç›¸åŒå¯ç›´æ¥å›è½¦ï¼‰</li>
</ol>
<hr>
<h2 id="âœ…-äº”ã€æˆåŠŸç»“æœ"><a href="#âœ…-äº”ã€æˆåŠŸç»“æœ" class="headerlink" title="âœ… äº”ã€æˆåŠŸç»“æœ"></a>âœ… äº”ã€æˆåŠŸç»“æœ</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">[æ­£åœ¨ç”Ÿæˆ 2048 ä½ RSA å¯†é’¥å¯¹ï¼Œè¯ä¹¦é‡‡ç”¨ SHA256withRSAï¼ˆæœ‰æ•ˆæœŸä¸º 10000 å¤©ï¼‰]</span><br><span class="line">[å·²å°†å¯†é’¥åº“ä¿å­˜åˆ° my-release-key.keystore]</span><br></pre></td></tr></table></figure>

<p>ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆç­¾åæ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">my-release-key.keystore</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§©-å…­ã€åœ¨-Qt-Creator-ä¸­é…ç½®ç­¾å"><a href="#ğŸ§©-å…­ã€åœ¨-Qt-Creator-ä¸­é…ç½®ç­¾å" class="headerlink" title="ğŸ§© å…­ã€åœ¨ Qt Creator ä¸­é…ç½®ç­¾å"></a>ğŸ§© å…­ã€åœ¨ Qt Creator ä¸­é…ç½®ç­¾å</h2><p>åœ¨ã€Œé¡¹ç›® â†’ æ„å»ºä¸è¿è¡Œ â†’ Androidã€ä¸­è®¾ç½®ï¼š</p>
<ul>
<li>Keystore è·¯å¾„ï¼š<code>my-release-key.keystore</code></li>
<li>Store passwordï¼šåˆšè¾“å…¥çš„å¯†é’¥åº“å£ä»¤</li>
<li>Key aliasï¼š<code>my-key-alias</code></li>
<li>Key passwordï¼šä¸å¯†é’¥åº“å£ä»¤ä¸€è‡´æˆ–å¦è®¾</li>
</ul>
<hr>
<h2 id="âš ï¸-ä¸ƒã€å¯é€‰å»ºè®®ï¼šè½¬ä¸º-PKCS12-æ ¼å¼ï¼ˆå®˜æ–¹å»ºè®®ï¼‰"><a href="#âš ï¸-ä¸ƒã€å¯é€‰å»ºè®®ï¼šè½¬ä¸º-PKCS12-æ ¼å¼ï¼ˆå®˜æ–¹å»ºè®®ï¼‰" class="headerlink" title="âš ï¸ ä¸ƒã€å¯é€‰å»ºè®®ï¼šè½¬ä¸º PKCS12 æ ¼å¼ï¼ˆå®˜æ–¹å»ºè®®ï¼‰"></a>âš ï¸ ä¸ƒã€å¯é€‰å»ºè®®ï¼šè½¬ä¸º PKCS12 æ ¼å¼ï¼ˆå®˜æ–¹å»ºè®®ï¼‰</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">keytool -importkeystore -srckeystore my-release-key.keystore -destkeystore my-release-key.keystore -deststoretype pkcs12</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“-å…«ã€Keystore-æ–‡ä»¶ä¿å­˜å»ºè®®"><a href="#ğŸ“-å…«ã€Keystore-æ–‡ä»¶ä¿å­˜å»ºè®®" class="headerlink" title="ğŸ“ å…«ã€Keystore æ–‡ä»¶ä¿å­˜å»ºè®®"></a>ğŸ“ å…«ã€Keystore æ–‡ä»¶ä¿å­˜å»ºè®®</h2><p>å»ºè®®å°† keystore æ–‡ä»¶ç»Ÿä¸€ä¿å­˜è‡³é¡¹ç›®ç›®å½•å¤–å®‰å…¨ä½ç½®ï¼Œ</p>
<p>å¹¶å¤‡ä»½åˆ°ç§å¯†ç½‘ç›˜æˆ–åŠ å¯†å­˜å‚¨è®¾å¤‡ï¼Œé˜²æ­¢ä¸¢å¤±ã€‚</p>
<hr>
<p>ç”Ÿæˆæ—¥æœŸï¼š2025-07-21</p>
]]></content>
      <categories>
        <category>æ•™ç¨‹</category>
      </categories>
      <tags>
        <tag>QT for Android</tag>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>C++ ä¸ Qt å®æœºåˆ¶è¯¦è§£ä¸å¯¹æ¯”</title>
    <url>/2025/04/30/C++%20%E4%B8%8E%20Qt%20%E5%AE%8F%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%AF%B9%E6%AF%94/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ Qt å®šä¹‰å’Œè¿ç”¨å® ï¼Œ C++çš„ä¸€äº›å¸¸ç”¨å® ï¼Œ QTæ ‡å‡†å®</p>
</blockquote>
<hr>
<h2 id="ä¸€ã€è‡ªå®šä¹‰å®ï¼ˆå‡½æ•°å®ï¼‰"><a href="#ä¸€ã€è‡ªå®šä¹‰å®ï¼ˆå‡½æ•°å®ï¼‰" class="headerlink" title="ä¸€ã€è‡ªå®šä¹‰å®ï¼ˆå‡½æ•°å®ï¼‰"></a>ä¸€ã€è‡ªå®šä¹‰å®ï¼ˆå‡½æ•°å®ï¼‰</h2><h3 id="1-å®çš„å®šä¹‰"><a href="#1-å®çš„å®šä¹‰" class="headerlink" title="1. å®çš„å®šä¹‰"></a>1. å®çš„å®šä¹‰</h3><p>å®æ˜¯é€šè¿‡ <code>#define</code> é¢„å¤„ç†æŒ‡ä»¤å®šä¹‰çš„ï¼Œæ˜¯ <strong>é¢„å¤„ç†å™¨æŒ‡ä»¤</strong>ï¼Œåœ¨ç¼–è¯‘å‰ç”±é¢„å¤„ç†å™¨è¿›è¡Œæ–‡æœ¬æ›¿æ¢ã€‚</p>
<h3 id="2-å®šä¹‰è¯­æ³•"><a href="#2-å®šä¹‰è¯­æ³•" class="headerlink" title="2. å®šä¹‰è¯­æ³•"></a>2. å®šä¹‰è¯­æ³•</h3><p>ä½¿ç”¨ <code>#define</code> é¢„å¤„ç†æŒ‡ä»¤å®šä¹‰å®å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> å®å(å‚æ•°1, å‚æ•°2, ...) æ›¿æ¢ä»£ç </span></span><br></pre></td></tr></table></figure>

<h3 id="3-ç¤ºä¾‹ï¼šæœ€å¤§å€¼æ¯”è¾ƒ"><a href="#3-ç¤ºä¾‹ï¼šæœ€å¤§å€¼æ¯”è¾ƒ" class="headerlink" title="3. ç¤ºä¾‹ï¼šæœ€å¤§å€¼æ¯”è¾ƒ"></a>3. ç¤ºä¾‹ï¼šæœ€å¤§å€¼æ¯”è¾ƒ</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a, b) ((a) &gt; (b) ? (a) : (b))</span></span><br></pre></td></tr></table></figure>

<h3 id="4-å¤šè¡Œå®"><a href="#4-å¤šè¡Œå®" class="headerlink" title="4. å¤šè¡Œå®"></a>4. å¤šè¡Œå®</h3><p>å¦‚æœå®å®šä¹‰éœ€è¦è·¨å¤šè¡Œï¼Œå¯ä»¥ä½¿ç”¨åæ–œæ (<code>\</code>)è¿›è¡Œæ¢è¡Œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> COMPLEX_MACRO(a, b, c)  \</span></span><br><span class="line"><span class="meta">    do &#123;                        \</span></span><br><span class="line"><span class="meta">        <span class="keyword">if</span> ((a) &gt; (b)) &#123;        \</span></span><br><span class="line"><span class="meta">            (c) = (a);          \</span></span><br><span class="line"><span class="meta">        &#125; <span class="keyword">else</span> &#123;                \</span></span><br><span class="line"><span class="meta">            (c) = (b);          \</span></span><br><span class="line"><span class="meta">        &#125;                       \</span></span><br><span class="line"><span class="meta">    &#125; while(0)</span></span><br></pre></td></tr></table></figure>

<h3 id="5-æ‹¬å·æ³¨æ„äº‹é¡¹"><a href="#5-æ‹¬å·æ³¨æ„äº‹é¡¹" class="headerlink" title="5. æ‹¬å·æ³¨æ„äº‹é¡¹"></a>5. æ‹¬å·æ³¨æ„äº‹é¡¹</h3><p>âš ï¸å®çš„æœ¬è´¨æ˜¯ç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œä¸è¿›è¡Œä»»ä½•è®¡ç®—æˆ–è¯­æ³•æ£€æŸ¥ã€‚</p>
<p>âŒé”™è¯¯å†™æ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SQUARE(x) x * x</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="built_in">SQUARE</span>(<span class="number">1</span> + <span class="number">2</span>); <span class="comment">// å®é™…å±•å¼€ä¸º 1 + 2 * 1 + 2 = 5</span></span><br></pre></td></tr></table></figure>

<p>âœ…æ­£ç¡®å†™æ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SQUARE(x) ((x) * (x)) </span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="built_in">SQUARE</span>(<span class="number">1</span> + <span class="number">2</span>); <span class="comment">// å±•å¼€ä¸º ((1 + 2)*(1 + 2)) = 9</span></span><br></pre></td></tr></table></figure>

<h3 id="6-å®å±•å¼€æ—¶å¯èƒ½é€ æˆçš„å‰¯ä½œç”¨-å‚æ•°è‡ªè¿ç®—é—®é¢˜"><a href="#6-å®å±•å¼€æ—¶å¯èƒ½é€ æˆçš„å‰¯ä½œç”¨-å‚æ•°è‡ªè¿ç®—é—®é¢˜" class="headerlink" title="6. å®å±•å¼€æ—¶å¯èƒ½é€ æˆçš„å‰¯ä½œç”¨,å‚æ•°è‡ªè¿ç®—é—®é¢˜"></a>6. å®å±•å¼€æ—¶å¯èƒ½é€ æˆçš„<strong>å‰¯ä½œç”¨</strong>,å‚æ•°è‡ªè¿ç®—é—®é¢˜</h3><p>âš ï¸è‡ªè¿ç®—å‹å‚æ•°è¢«å®å¤šæ¬¡åŠ è½½æ›¿æ¢ï¼Œè¿ç®—æ—¶ç›¸å½“äºè¿›è¡Œé¡ºåºçš„å¤šæ¬¡è‡ªè¿ç®—ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> INCREMENT(x) ((x) + (x) + (x))</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> j = <span class="built_in">INCREMENT</span>(i++); <span class="comment">// å®é™…å±•å¼€ä¸º ï¼ˆ(i++)+(i++)+(i++)ï¼‰ å³ ï¼ˆ1+2+3ï¼‰ = 6</span></span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;i; <span class="comment">// i=4;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-å¤šè¡Œå®"><a href="#7-å¤šè¡Œå®" class="headerlink" title="7. å¤šè¡Œå®"></a>7. å¤šè¡Œå®</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> LOG(msg) \</span></span><br><span class="line"><span class="meta">    std::cout &lt;&lt; <span class="string">&quot;[&quot;</span> &lt;&lt; __FILE__ &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="string">&quot;] &quot;</span> &lt;&lt; msg &lt;&lt; std::endl;</span></span><br></pre></td></tr></table></figure>
<h3 id="8-æ— å€¼å®"><a href="#8-æ— å€¼å®" class="headerlink" title="8. æ— å€¼å®"></a>8. æ— å€¼å®</h3><p>æ— å€¼å® â‰ˆ ä¸€ä¸ªå…¨å±€çš„å¸ƒå°”æ ‡å¿—ï¼ˆå¸ƒå°”å¼€å…³ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> ENABLE_DEBUG  <span class="comment">//å®ŒæˆENABLE_DEBUGå®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ENABLE_DEBUG</span></span><br><span class="line">    <span class="comment">//ä¼šè¢«æ‰§è¡Œ</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> ENABLE_DEBUG  <span class="comment">// â—å–æ¶ˆå®šä¹‰ï¼Œæˆ–é¡¹ç›®ä¸­æ— è¯¥é¡¹å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ENABLE_DEBUG</span></span><br><span class="line">    <span class="comment">//ä¸ä¼šè¢«æ‰§è¡Œ</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h3 id="9-ä¿æŠ¤å®"><a href="#9-ä¿æŠ¤å®" class="headerlink" title="9. ä¿æŠ¤å®"></a>9. ä¿æŠ¤å®</h3><p>ä¿æŠ¤å®æ˜¯å¯¹æ— å€¼å®çš„ä¸€ç§åº”ç”¨</p>
<p>ä»æœ¬è´¨ä½œç”¨ä¸Šè®²ï¼Œä¿æŠ¤å®å°±æ˜¯ä¸ºäº†é˜²æ­¢<strong>å¤´æ–‡ä»¶è¢«é‡å¤åŒ…å«</strong>ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½åªæœ‰ä¸€ç‚¹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MY_HEADER_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MY_HEADER_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤´æ–‡ä»¶å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// MY_HEADER_H</span></span></span><br></pre></td></tr></table></figure>

<p>æ¶‰åŠåˆ°<strong>å¤´æ–‡ä»¶åµŒå¥—å¼•ç”¨æ—¶</strong>ï¼Œå®ƒä¿æŠ¤äº†å¤´æ–‡ä»¶çš„<strong>å®é™…å†…å®¹åªè¢«ç¼–è¯‘å™¨çœ‹åˆ°ä¸€æ¬¡</strong>ï¼Œå³ä¾¿ä½ åœ¨å¤šä¸ªåœ°æ–¹åŒ…å«å®ƒã€‚</p>
<h4 id="â„¹ï¸ä¿æŠ¤å®æ›¿ä»£æ–¹æ¡ˆï¼š"><a href="#â„¹ï¸ä¿æŠ¤å®æ›¿ä»£æ–¹æ¡ˆï¼š" class="headerlink" title="â„¹ï¸ä¿æŠ¤å®æ›¿ä»£æ–¹æ¡ˆï¼š"></a>â„¹ï¸ä¿æŠ¤å®æ›¿ä»£æ–¹æ¡ˆï¼š</h4><p><code>#pragma once</code> æ˜¯ä¸€ä¸ª <strong>ç¼–è¯‘å™¨æŒ‡ä»¤</strong>ï¼Œç”¨äºé˜²æ­¢å¤´æ–‡ä»¶è¢«å¤šæ¬¡åŒ…å«ï¼ˆ<strong>include</strong>ï¼‰é€ æˆçš„é‡å¤å®šä¹‰é—®é¢˜ã€‚</p>
<p><code>#pragma once</code> é€šå¸¸æ”¾åœ¨å¤´æ–‡ä»¶çš„æœ€é¡¶éƒ¨ï¼Œç´§æŒ¨æ–‡ä»¶å¼€å¤´ç¬¬ä¸€è¡Œï¼Œç¡®ä¿åœ¨ä»»ä½•ä»£ç æˆ–å…¶å®ƒ <code>#include</code> ä¹‹å‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// myheader.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;other.h&quot;</span></span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// ä¸‹é¢å†™ä½ çš„å£°æ˜ï¼å®šä¹‰</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MyStruct</span> &#123;</span><br><span class="line">	<span class="type">int</span> a;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span></span>;</span><br><span class="line">	&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="äºŒã€C-ç³»ç»Ÿé¢„å®šä¹‰å®"><a href="#äºŒã€C-ç³»ç»Ÿé¢„å®šä¹‰å®" class="headerlink" title="äºŒã€C++ ç³»ç»Ÿé¢„å®šä¹‰å®"></a>äºŒã€C++ ç³»ç»Ÿé¢„å®šä¹‰å®</h2><table>
<thead>
<tr>
<th>å®å</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>__FILE__</code></td>
<td>å½“å‰æºæ–‡ä»¶å</td>
</tr>
<tr>
<td><code>__LINE__</code></td>
<td>å½“å‰è¡Œå·</td>
</tr>
<tr>
<td><code>__FUNCTION__</code></td>
<td>å½“å‰å‡½æ•°åï¼ˆéæ ‡å‡†ï¼‰</td>
</tr>
<tr>
<td><code>__func__</code></td>
<td>å½“å‰å‡½æ•°åï¼ˆæ ‡å‡†C99&#x2F;C++11ï¼‰</td>
</tr>
<tr>
<td><code>__DATE__</code></td>
<td>ç¼–è¯‘æ—¥æœŸ</td>
</tr>
<tr>
<td><code>__TIME__</code></td>
<td>ç¼–è¯‘æ—¶é—´</td>
</tr>
<tr>
<td><code>__cplusplus</code></td>
<td>æ˜¯å¦ä¸ºC++ç¯å¢ƒ</td>
</tr>
</tbody></table>
<hr>
<h2 id="ä¸‰ã€Qt-ä¸­çš„å®æœºåˆ¶"><a href="#ä¸‰ã€Qt-ä¸­çš„å®æœºåˆ¶" class="headerlink" title="ä¸‰ã€Qt ä¸­çš„å®æœºåˆ¶"></a>ä¸‰ã€Qt ä¸­çš„å®æœºåˆ¶</h2><h3 id="1-èƒŒæ™¯"><a href="#1-èƒŒæ™¯" class="headerlink" title="1. èƒŒæ™¯"></a>1. èƒŒæ™¯</h3><p>Qt ä½¿ç”¨ MOCï¼ˆå…ƒå¯¹è±¡ç¼–è¯‘å™¨ï¼‰æ‰©å±• C++ åŠŸèƒ½ï¼Œå®æ˜¯å…¶æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚</p>
<h3 id="2-å¸¸ç”¨-Qt-å®"><a href="#2-å¸¸ç”¨-Qt-å®" class="headerlink" title="2. å¸¸ç”¨ Qt å®"></a>2. å¸¸ç”¨ Qt å®</h3><table>
<thead>
<tr>
<th>å®å</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td><code>Q_OBJECT</code></td>
<td>å¯ç”¨ä¿¡å·ä¸æ§½ã€å…ƒå¯¹è±¡ç³»ç»Ÿ</td>
</tr>
<tr>
<td><code>signals:</code></td>
<td>ä¿¡å·å£°æ˜åŒºåŸŸ</td>
</tr>
<tr>
<td><code>slots:</code></td>
<td>æ§½å‡½æ•°å£°æ˜åŒºåŸŸ</td>
</tr>
<tr>
<td><code>Q_PROPERTY</code></td>
<td>å£°æ˜å±æ€§ç”¨äºåå°„ã€QML</td>
</tr>
<tr>
<td><code>Q_ENUM</code></td>
<td>æ³¨å†Œæšä¸¾ç±»å‹</td>
</tr>
<tr>
<td><code>Q_DECLARE_METATYPE</code></td>
<td>æ³¨å†Œç±»å‹ç”¨äº QVariant</td>
</tr>
<tr>
<td><code>Q_DISABLE_COPY</code></td>
<td>ç¦æ­¢æ‹·è´æ„é€ ä¸èµ‹å€¼</td>
</tr>
<tr>
<td><code>Q_ASSERT</code></td>
<td>æ–­è¨€è°ƒè¯•å®</td>
</tr>
</tbody></table>
<h3 id="3-ç¤ºä¾‹ï¼šä¿¡å·æ§½ç±»"><a href="#3-ç¤ºä¾‹ï¼šä¿¡å·æ§½ç±»" class="headerlink" title="3. ç¤ºä¾‹ï¼šä¿¡å·æ§½ç±»"></a>3. ç¤ºä¾‹ï¼šä¿¡å·æ§½ç±»</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> : <span class="keyword">public</span> QObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">valueChanged</span><span class="params">(<span class="type">int</span> newVal)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setValue</span><span class="params">(<span class="type">int</span> val)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="4-ç¤ºä¾‹ï¼šå±æ€§å®šä¹‰"><a href="#4-ç¤ºä¾‹ï¼šå±æ€§å®šä¹‰" class="headerlink" title="4. ç¤ºä¾‹ï¼šå±æ€§å®šä¹‰"></a>4. ç¤ºä¾‹ï¼šå±æ€§å®šä¹‰</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Q_PROPERTY(ç±»å‹ åç§° READ è¯»å‡½æ•° WRITE å†™å‡½æ•° NOTIFY é€šçŸ¥ä¿¡å·)</span></span><br><span class="line"><span class="built_in">Q_PROPERTY</span>(<span class="type">int</span> count READ count WRITE setCount NOTIFY countChanged)</span><br><span class="line">    <span class="comment">//ç­‰ä»·äºæ³¨å†Œä¸€ä¸ªåä¸º count çš„ int ç±»å‹å±æ€§</span></span><br><span class="line">    <span class="comment">//ç»‘å®šè¯»å–å‡½æ•° int count() const</span></span><br><span class="line">    <span class="comment">//ç»‘å®šå†™å…¥å‡½æ•° void setCount(int)</span></span><br><span class="line">    <span class="comment">//ç»‘å®šä¿¡å· void countChanged()ï¼Œç”¨äºé€šçŸ¥å±æ€§å€¼å˜åŒ–</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å››ã€å®æ›¿ä»£å»ºè®®"><a href="#å››ã€å®æ›¿ä»£å»ºè®®" class="headerlink" title="å››ã€å®æ›¿ä»£å»ºè®®"></a>å››ã€å®æ›¿ä»£å»ºè®®</h2><table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th>å®å†™æ³•</th>
<th>æ›¿ä»£æ¨è</th>
</tr>
</thead>
<tbody><tr>
<td>å¸¸é‡</td>
<td><code>#define PI 3.14</code></td>
<td><code>constexpr double PI = 3.14;</code></td>
</tr>
<tr>
<td>å‡½æ•°</td>
<td><code>#define MAX(a,b) ...</code></td>
<td><code>inline</code> æˆ–æ¨¡æ¿å‡½æ•°</td>
</tr>
<tr>
<td>æ¡ä»¶ç¼–è¯‘</td>
<td><code>#ifdef _WIN32</code></td>
<td>æ— æ›¿ä»£ï¼Œå¿…é¡»ä½¿ç”¨å®</td>
</tr>
</tbody></table>
<hr>
<h2 id="äº”ã€Qt-å®-vs-C-å®-å¯¹æ¯”è¡¨"><a href="#äº”ã€Qt-å®-vs-C-å®-å¯¹æ¯”è¡¨" class="headerlink" title="äº”ã€Qt å® vs C++ å® å¯¹æ¯”è¡¨"></a>äº”ã€Qt å® vs C++ å® å¯¹æ¯”è¡¨</h2><table>
<thead>
<tr>
<th>å¯¹æ¯”é¡¹</th>
<th>C++ å®</th>
<th>Qt å®ï¼ˆMOCï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>æ‰§è¡Œé˜¶æ®µ</td>
<td>ç¼–è¯‘å‰æ–‡æœ¬æ›¿æ¢</td>
<td>ç¼–è¯‘å‰ moc ç”Ÿæˆ + ç¼–è¯‘å™¨å¤„ç†</td>
</tr>
<tr>
<td>å®‰å…¨æ€§</td>
<td>æ— ç±»å‹å®‰å…¨ï¼Œå®¹æ˜“å‡ºé”™</td>
<td>ç±»å‹å®‰å…¨ï¼Œé€‚é… Qt ç³»ç»Ÿ</td>
</tr>
<tr>
<td>æ›¿æ¢æ–¹å¼</td>
<td>é¢„å¤„ç†å™¨å±•å¼€</td>
<td>ç”Ÿæˆå…ƒä¿¡æ¯æ”¯æŒåŠ¨æ€è¡Œä¸º</td>
</tr>
<tr>
<td>åŠŸèƒ½èŒƒå›´</td>
<td>é€šç”¨æ–‡æœ¬æ›¿æ¢ã€æ¡ä»¶ç¼–è¯‘ç­‰</td>
<td>ä¿¡å·æ§½ã€å±æ€§ã€åå°„ã€QML æ”¯æŒç­‰</td>
</tr>
<tr>
<td>æ¨èæ›¿ä»£</td>
<td>å»ºè®®å°½é‡ç”¨ const&#x2F;inline&#x2F;template æ›¿ä»£</td>
<td>å¿…é¡»ä½¿ç”¨ Qt å®æ—¶å¿…é¡»ä¿ç•™</td>
</tr>
</tbody></table>
<hr>
<h2 id="å…­ã€å®ä½¿ç”¨æ€»ç»“æŠ€å·§"><a href="#å…­ã€å®ä½¿ç”¨æ€»ç»“æŠ€å·§" class="headerlink" title="å…­ã€å®ä½¿ç”¨æ€»ç»“æŠ€å·§"></a>å…­ã€å®ä½¿ç”¨æ€»ç»“æŠ€å·§</h2><ul>
<li>âœ… æ‰€æœ‰å®éƒ½å¿…é¡»ä½¿ç”¨ <code>#define</code></li>
<li>âœ… å®å‡½æ•°è¦åŠ æ‹¬å·ï¼šå‚æ•°ä¸æ•´ä¸ªè¡¨è¾¾å¼</li>
<li>âš ï¸ é¿å…ä½¿ç”¨å¸¦å‰¯ä½œç”¨çš„å‚æ•°å¦‚ <code>i++</code></li>
<li>âœ… ä½¿ç”¨ <code>inline</code> æ›¿ä»£å‡½æ•°å®æ›´å®‰å…¨</li>
<li>âœ… Qt ä¸­å¿…é¡»ä½¿ç”¨ <code>Q_OBJECT</code> å¯ç”¨ä¿¡å·æ§½</li>
<li>âœ… å¤šä¸ªå®å¯é›†ä¸­å†™åˆ° <code>.h</code> æ–‡ä»¶ä¸­ç»Ÿä¸€ç®¡ç†</li>
</ul>
]]></content>
      <categories>
        <category>QT_çŸ¥è¯†æ€»ç»“</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>GitHub é¡¹ç›®åˆ›å»ºä¸æœ¬åœ°åŒæ­¥ç®¡ç†</title>
    <url>/2025/02/18/GitHub%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA%E4%B8%8E%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡è®°å½•å¦‚ä½•å°†åˆ›å»º GitHub ä»“åº“ï¼Œå¹¶è¿›è¡Œæœ¬åœ°åŒæ­¥ä¸ç®¡ç†ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ”§-å‡†å¤‡å·¥å…·"><a href="#ğŸ”§-å‡†å¤‡å·¥å…·" class="headerlink" title="ğŸ”§ å‡†å¤‡å·¥å…·"></a>ğŸ”§ å‡†å¤‡å·¥å…·</h2><p>åœ¨å¼€å§‹å‰ï¼Œè¯·ç¡®è®¤ä½ å·²å…·å¤‡ä»¥ä¸‹å·¥å…·ç¯å¢ƒï¼š</p>
<ul>
<li><p>âœ… å·²æ³¨å†Œ <a href="https://github.com/">GitHub</a> è´¦å·</p>
</li>
<li><p>âœ… å·²å®‰è£… Git å·¥å…·ï¼ˆæ¨èå®‰è£… <a href="https://git-scm.com/download/win">Git for Windows</a>ï¼‰</p>
</li>
<li><p>âœ… å·²å®‰è£… nodejsï¼ˆæ¨èå®‰è£… <a href="https://nodejs.org/en/">nodejs</a>ï¼‰(<a href="https://www.cnblogs.com/liuqiyun/p/8133904.html">Node.jså®‰è£…åŠç¯å¢ƒé…ç½®ä¹‹Windowsç¯‡</a>)</p>
</li>
<li><p>âœ… ç®¡ç†å‘˜è¿è¡Œcmdï¼Œä¾æ¬¡è¾“å…¥,å®Œæˆç¯å¢ƒéªŒè¯</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -vï¼ˆnodeå®‰è£…åé™„å¸¦ï¼‰</span><br><span class="line">git -v</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="ä¸€ã€GitHub-åˆ›å»ºæ–°ä»“åº“"><a href="#ä¸€ã€GitHub-åˆ›å»ºæ–°ä»“åº“" class="headerlink" title="ä¸€ã€GitHub åˆ›å»ºæ–°ä»“åº“"></a>ä¸€ã€GitHub åˆ›å»ºæ–°ä»“åº“</h2><ol>
<li><p>ç™»å½• <a href="https://github.com/">GitHub</a></p>
</li>
<li><p>ç‚¹å‡»å³ä¸Šè§’ â†’ <code>New repository</code></p>
</li>
<li><p>ä»“åº“åç§°å¡«ï¼š<code>myProject</code></p>
</li>
<li><p>ä¸å‹¾é€‰ <code>Initialize with a README</code>ï¼ˆä¿æŒä¸ºç©ºä»“åº“ï¼‰</p>
</li>
<li><p>åˆ›å»ºæˆåŠŸåä¼šçœ‹åˆ°ä»“åº“åœ°å€ï¼š<br><code>https://github.com/GithubUserName/myGithubProject.git</code></p>
</li>
</ol>
<hr>
<h2 id="äºŒã€æœ¬åœ°åˆå§‹åŒ–-Git-é¡¹ç›®å¹¶ä¸Šä¼ "><a href="#äºŒã€æœ¬åœ°åˆå§‹åŒ–-Git-é¡¹ç›®å¹¶ä¸Šä¼ " class="headerlink" title="äºŒã€æœ¬åœ°åˆå§‹åŒ– Git é¡¹ç›®å¹¶ä¸Šä¼ "></a>äºŒã€æœ¬åœ°åˆå§‹åŒ– Git é¡¹ç›®å¹¶ä¸Šä¼ </h2><h3 id="åœ¨-Git-Bash-æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š"><a href="#åœ¨-Git-Bash-æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š" class="headerlink" title="åœ¨ Git Bash æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š"></a>åœ¨ Git Bash æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /é¡¹ç›®æœ¬åœ°å­˜å‚¨çš„åœ°å€</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– Git ä»“åº“</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º README æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰(GitHubåˆ›å»ºæ–°ä»“åº“è‹¥å‹¾é€‰Initialize with a READMEæ— éœ€è¯¥é¡¹)</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;# myGithubProject&quot;</span> &gt;&gt; README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¨éƒ¨æ–‡ä»¶æ·»åŠ åˆ° Git ç¼“å­˜åŒº</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œå¹¶ä¸ºè¯¥æ¬¡æäº¤æ·»åŠ å¤‡æ³¨</span></span><br><span class="line">git commit -m <span class="string">&quot;åˆå§‹åŒ–GitHubé¡¹ç›®&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é»˜è®¤åˆ†æ”¯ä¸º main</span></span><br><span class="line">git branch -M main</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€ï¼ˆSSH æ–¹å¼ï¼‰(éœ€å…ˆä¸ºæœ¬æœºé…ç½®sshå¯†é’¥)</span></span><br><span class="line">git remote add origin git@github.com:GithubUserName/myGithubProject.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€åˆ° GitHubï¼ˆç¬¬ä¸€æ¬¡ï¼‰</span></span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ä¸‰ã€é…ç½®-SSH-å¯†é’¥ï¼ˆæ¨èï¼‰"><a href="#ä¸‰ã€é…ç½®-SSH-å¯†é’¥ï¼ˆæ¨èï¼‰" class="headerlink" title="ä¸‰ã€é…ç½® SSH å¯†é’¥ï¼ˆæ¨èï¼‰"></a>ä¸‰ã€é…ç½® SSH å¯†é’¥ï¼ˆæ¨èï¼‰</h2><p>é¿å…æ¯æ¬¡ push éƒ½è¾“å…¥å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ SSHï¼š</p>
<h3 id="1-æ£€æŸ¥æ˜¯å¦å·²æœ‰å¯†é’¥ï¼š"><a href="#1-æ£€æŸ¥æ˜¯å¦å·²æœ‰å¯†é’¥ï¼š" class="headerlink" title="1. æ£€æŸ¥æ˜¯å¦å·²æœ‰å¯†é’¥ï¼š"></a>1. æ£€æŸ¥æ˜¯å¦å·²æœ‰å¯†é’¥ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> ~/.ssh</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ‰ <code>id_rsa</code> å’Œ <code>id_rsa.pub</code>ï¼Œå¯è·³è¿‡ç”Ÿæˆæ­¥éª¤ã€‚</p>
<h3 id="2-ç”Ÿæˆæ–°å¯†é’¥ï¼ˆå¦‚æ— ï¼‰ï¼š"><a href="#2-ç”Ÿæˆæ–°å¯†é’¥ï¼ˆå¦‚æ— ï¼‰ï¼š" class="headerlink" title="2. ç”Ÿæˆæ–°å¯†é’¥ï¼ˆå¦‚æ— ï¼‰ï¼š"></a>2. ç”Ÿæˆæ–°å¯†é’¥ï¼ˆå¦‚æ— ï¼‰ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;é‚®ç®±åœ°å€&quot;</span></span><br></pre></td></tr></table></figure>

<p>ä¸€è·¯å›è½¦ç”Ÿæˆã€‚</p>
<h3 id="3-æ·»åŠ åˆ°-GitHubï¼š"><a href="#3-æ·»åŠ åˆ°-GitHubï¼š" class="headerlink" title="3. æ·»åŠ åˆ° GitHubï¼š"></a>3. æ·»åŠ åˆ° GitHubï¼š</h3><ul>
<li>æ‰“å¼€ GitHub â†’ Settings â†’ SSH and GPG Keys â†’ New SSH Key</li>
<li>å°† <code>C:\Users\ç”¨æˆ·å\ .ssh/id_rsa.pub</code> å†…å®¹å¤åˆ¶ç²˜è´´è¿›å»</li>
</ul>
<h3 id="4-æµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸï¼š"><a href="#4-æµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸï¼š" class="headerlink" title="4. æµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸï¼š"></a>4. æµ‹è¯•è¿æ¥æ˜¯å¦æˆåŠŸï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºæˆåŠŸå³é…ç½®å®Œæˆã€‚</p>
<hr>
<h2 id="å››ã€åç»­ä¸Šä¼ èµ„æºæµç¨‹"><a href="#å››ã€åç»­ä¸Šä¼ èµ„æºæµç¨‹" class="headerlink" title="å››ã€åç»­ä¸Šä¼ èµ„æºæµç¨‹"></a>å››ã€åç»­ä¸Šä¼ èµ„æºæµç¨‹</h2><p>æ¯æ¬¡æ›´æ–°æœ¬åœ°èµ„æºï¼Œåªéœ€æ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;æ›´æ–°è¯´æ˜&quot;</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="äº”ã€å¯é€‰ï¼šæ·»åŠ -gitignore-æ–‡ä»¶"><a href="#äº”ã€å¯é€‰ï¼šæ·»åŠ -gitignore-æ–‡ä»¶" class="headerlink" title="äº”ã€å¯é€‰ï¼šæ·»åŠ  .gitignore æ–‡ä»¶"></a>äº”ã€å¯é€‰ï¼šæ·»åŠ  .gitignore æ–‡ä»¶</h2><p>ä¸ºé¿å…ä¸Šä¼ æ— ç”¨æ–‡ä»¶ï¼Œå¯æ·»åŠ  <code>.gitignore</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">*.<span class="built_in">log</span>           <span class="comment"># å¿½ç•¥æ‰€æœ‰ .log ç»“å°¾çš„æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">node_modules/   <span class="comment"># å¿½ç•¥ node_modules ç›®å½•ï¼ˆå‰ç«¯é¡¹ç›®å¸¸ç”¨ï¼‰</span></span><br><span class="line">.DS_Store       <span class="comment"># å¿½ç•¥ macOS ç³»ç»Ÿçš„ä¸´æ—¶æ–‡ä»¶</span></span><br><span class="line">Thumbs.db       <span class="comment"># å¿½ç•¥ Windows ç³»ç»Ÿç¼©ç•¥å›¾ç¼“å­˜</span></span><br><span class="line">*.tmp           <span class="comment"># å¿½ç•¥æ‰€æœ‰ .tmp ä¸´æ—¶æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-å°è´´å£«"><a href="#âœ…-å°è´´å£«" class="headerlink" title="âœ… å°è´´å£«"></a>âœ… å°è´´å£«</h2><ul>
<li><p>GitHub ä¸Šæ–‡ä»¶æ¯”æœ¬åœ°å¤šæ—¶ï¼Œå…ˆæ‰§è¡Œï¼š  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git pull --rebase origin main</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹è¿œç¨‹ä»“åº“åœ°å€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹æäº¤å†å²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p>ä»¥ä¸Šå°±æ˜¯å®Œæ•´çš„GitHubé¡¹ç›®åˆ›å»ºä¸ç®¡ç†æµç¨‹</p>
]]></content>
      <categories>
        <category>æ•™ç¨‹</category>
      </categories>
      <tags>
        <tag>Git</tag>
        <tag>GitHub</tag>
      </tags>
  </entry>
  <entry>
    <title>Qté¡¹ç›®åœ¨Androidç³»ç»Ÿç¯å¢ƒä¸‹å®ç°å¼€æœºè‡ªå¯</title>
    <url>/2025/03/04/Qt%20for%20Android%20%E5%AE%9E%E7%8E%B0%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡è®°å½•å¦‚ä½•åœ¨ Qt for Android é¡¹ç›®ä¸­ï¼Œå®ç°åº”ç”¨ <strong>éšç³»ç»Ÿå¼€æœºè‡ªåŠ¨å¯åŠ¨</strong> çš„åŠŸèƒ½ï¼Œé€‚ç”¨äºè®¾å¤‡æ§åˆ¶ã€å·¥æ§ç³»ç»Ÿç­‰å¸¸é©»åº”ç”¨åœºæ™¯ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ§©-å®ç°æ€è·¯æ¦‚è¿°"><a href="#ğŸ§©-å®ç°æ€è·¯æ¦‚è¿°" class="headerlink" title="ğŸ§© å®ç°æ€è·¯æ¦‚è¿°"></a>ğŸ§© å®ç°æ€è·¯æ¦‚è¿°</h2><ol>
<li><strong>æ–°å»ºä¸€ä¸ª <code>BroadcastReceiver</code> ç±»</strong>ï¼Œç”¨äºç›‘å¬ç³»ç»Ÿå¼€æœºå¹¿æ’­ï¼ˆ<code>BOOT_COMPLETED</code>ï¼‰ã€‚</li>
<li><strong>æ¥æ”¶åˆ°å¹¿æ’­åï¼Œå¯åŠ¨ä¸»ç•Œé¢ <code>JBmsActivity</code></strong>ï¼Œå®ƒç»§æ‰¿è‡ª <code>QtActivity</code>ï¼Œè‡ªåŠ¨è°ƒç”¨ Qt C++ å±‚çš„ <code>main()</code> å‡½æ•°ã€‚</li>
<li><strong>åœ¨ <code>AndroidManifest.xml</code> ä¸­å£°æ˜æƒé™å’Œæ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨</strong>ã€‚</li>
</ol>
<hr>
<h2 id="âœ…-æ­¥éª¤ä¸€ï¼šæ–°å»º-BootReceiver-javaï¼ˆç›‘å¬å¼€æœºå¹¿æ’­ï¼‰"><a href="#âœ…-æ­¥éª¤ä¸€ï¼šæ–°å»º-BootReceiver-javaï¼ˆç›‘å¬å¼€æœºå¹¿æ’­ï¼‰" class="headerlink" title="âœ… æ­¥éª¤ä¸€ï¼šæ–°å»º BootReceiver.javaï¼ˆç›‘å¬å¼€æœºå¹¿æ’­ï¼‰"></a>âœ… æ­¥éª¤ä¸€ï¼šæ–°å»º BootReceiver.javaï¼ˆç›‘å¬å¼€æœºå¹¿æ’­ï¼‰</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.qtproject.example.activityhandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¿æ’­æ¥æ”¶å™¨ç±»ï¼Œç”¨äºç›‘å¬ BOOT_COMPLETED å¹¿æ’­ï¼ˆå¼€æœºå®Œæˆï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootReceiver</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯åŠ¨ Qt ä¸»ç•Œé¢ï¼ˆJBmsActivityï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">startApp</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        Log.d(<span class="string">&quot;BootReceiver&quot;</span>, <span class="string">&quot;å¯åŠ¨QTåº”ç”¨&quot;</span>);</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">splashIntent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(context, JBmsActivity.class);</span><br><span class="line">        splashIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); <span class="comment">// å¿…é¡»è®¾ç½®æ­¤æ ‡å¿—ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸</span></span><br><span class="line">        context.startActivity(splashIntent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¥æ”¶å¹¿æ’­äº‹ä»¶</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (Intent.ACTION_BOOT_COMPLETED.equals(intent.getAction())) &#123;</span><br><span class="line">            startApp(context, intent); <span class="comment">// æ”¶åˆ°ç³»ç»Ÿå¹¿æ’­åå¯åŠ¨åº”ç”¨</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-æ­¥éª¤äºŒï¼šåˆ›å»º-Qt-å¯åŠ¨-Activityï¼ˆJBmsActivityï¼‰"><a href="#âœ…-æ­¥éª¤äºŒï¼šåˆ›å»º-Qt-å¯åŠ¨-Activityï¼ˆJBmsActivityï¼‰" class="headerlink" title="âœ… æ­¥éª¤äºŒï¼šåˆ›å»º Qt å¯åŠ¨ Activityï¼ˆJBmsActivityï¼‰"></a>âœ… æ­¥éª¤äºŒï¼šåˆ›å»º Qt å¯åŠ¨ Activityï¼ˆJBmsActivityï¼‰</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.qtproject.example.activityhandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Build;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.net.Uri;</span><br><span class="line"><span class="keyword">import</span> android.provider.Settings;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> org.qtproject.qt5.android.bindings.QtActivity;</span><br><span class="line"></span><br><span class="line"><span class="comment">// JBmsActivity æ˜¯ Qt çš„å¯åŠ¨ Activityï¼Œç»§æ‰¿ QtActivity åä¼šè§¦å‘ Qt çš„ main()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JBmsActivity</span> <span class="keyword">extends</span> <span class="title class_">QtActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;JBmsActivity&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ£€æŸ¥æ˜¯å¦æ‹¥æœ‰æ‚¬æµ®çª—æƒé™ï¼ˆéƒ¨åˆ†å›½äº§ç³»ç»Ÿéœ€è¦ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (!Settings.canDrawOverlays(<span class="built_in">this</span>)) &#123;</span><br><span class="line">            <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(Settings.ACTION_MANAGE_OVERLAY_PERMISSION);</span><br><span class="line">            intent.setData(Uri.parse(<span class="string">&quot;package:&quot;</span> + getPackageName()));</span><br><span class="line">            startActivityForResult(intent, <span class="number">0</span>); <span class="comment">// è¯·æ±‚æƒé™</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        hideBottomUIMenu(); <span class="comment">// è®¾ç½®å…¨å±æ²‰æµ¸å¼æ¨¡å¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é¡µé¢æ¢å¤æ—¶é‡æ–°éšè—è™šæ‹ŸæŒ‰é”®</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onResume</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onResume();</span><br><span class="line">        hideBottomUIMenu();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®æ²‰æµ¸å¼å…¨å±ï¼Œéšè—åº•éƒ¨å¯¼èˆªæ </span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">hideBottomUIMenu</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> flags;</span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</span><br><span class="line">            flags = View.SYSTEM_UI_FLAG_FULLSCREEN</span><br><span class="line">                    | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION</span><br><span class="line">                    | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN</span><br><span class="line">                    | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION</span><br><span class="line">                    | View.SYSTEM_UI_FLAG_LAYOUT_STABLE</span><br><span class="line">                    | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            flags = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION</span><br><span class="line">                    | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION;</span><br><span class="line">        &#125;</span><br><span class="line">        getWindow().getDecorView().setSystemUiVisibility(flags);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¥æ”¶æƒé™ç”³è¯·ç»“æœ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onActivityResult</span><span class="params">(<span class="type">int</span> requestCode, <span class="type">int</span> resultCode, Intent data)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (requestCode == <span class="number">0</span> &amp;&amp; Settings.canDrawOverlays(<span class="built_in">this</span>)) &#123;</span><br><span class="line">            Log.i(TAG, <span class="string">&quot;æ‚¬æµ®çª—æƒé™å·²æˆæƒ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">super</span>.onActivityResult(requestCode, resultCode, data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-æ­¥éª¤ä¸‰ï¼šAndroidManifest-xml-é…ç½®"><a href="#âœ…-æ­¥éª¤ä¸‰ï¼šAndroidManifest-xml-é…ç½®" class="headerlink" title="âœ… æ­¥éª¤ä¸‰ï¼šAndroidManifest.xml é…ç½®"></a>âœ… æ­¥éª¤ä¸‰ï¼šAndroidManifest.xml é…ç½®</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">&quot;org.qtproject.example.activityhandler&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼€æœºå¹¿æ’­æƒé™ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ‚¬æµ®çª—æƒé™ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Qt å¯åŠ¨ Activity --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.JBmsActivity&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:label</span>=<span class="string">&quot;My Qt App&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:configChanges</span>=<span class="string">&quot;orientation|screenSize|keyboardHidden&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:launchMode</span>=<span class="string">&quot;singleTop&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:theme</span>=<span class="string">&quot;@android:style/Theme.NoTitleBar.Fullscreen&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:screenOrientation</span>=<span class="string">&quot;portrait&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯åŠ¨å¹¿æ’­ç›‘å¬å™¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">receiver</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">&quot;.BootReceiver&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:enabled</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:permission</span>=<span class="string">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.BOOT_COMPLETED&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§ -å¯åŠ¨æµç¨‹å›¾ï¼ˆç®€è¿°ï¼‰"><a href="#ğŸ§ -å¯åŠ¨æµç¨‹å›¾ï¼ˆç®€è¿°ï¼‰" class="headerlink" title="ğŸ§  å¯åŠ¨æµç¨‹å›¾ï¼ˆç®€è¿°ï¼‰"></a>ğŸ§  å¯åŠ¨æµç¨‹å›¾ï¼ˆç®€è¿°ï¼‰</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è®¾å¤‡å¼€æœº</span><br><span class="line">  â†“</span><br><span class="line">å‘é€ BOOT_COMPLETED å¹¿æ’­</span><br><span class="line">  â†“</span><br><span class="line">BootReceiver æ¥æ”¶ â†’ å¯åŠ¨ JBmsActivity</span><br><span class="line">  â†“</span><br><span class="line">JBmsActivity ç»§æ‰¿ QtActivity â†’ è‡ªåŠ¨å¯åŠ¨ Qt çš„ main()</span><br><span class="line">  â†“</span><br><span class="line">Qt åº”ç”¨å¼€å§‹è¿è¡Œ</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-æ³¨æ„äº‹é¡¹"><a href="#âœ…-æ³¨æ„äº‹é¡¹" class="headerlink" title="âœ… æ³¨æ„äº‹é¡¹"></a>âœ… æ³¨æ„äº‹é¡¹</h2><ul>
<li>Android 8.0+ è¦æ±‚ï¼šåº”ç”¨å¿…é¡» <strong>æ‰‹åŠ¨å¯åŠ¨è¿‡ä¸€æ¬¡</strong> æ‰èƒ½æ¥æ”¶ BOOT_COMPLETED</li>
<li>æ‚¬æµ®çª—æƒé™å±äºç‰¹æ®Šæƒé™ï¼Œç”¨æˆ·å¿…é¡»æ‰‹åŠ¨æˆæƒ</li>
<li>åœ¨å›½äº§ ROM ä¸­å¯èƒ½è¿˜éœ€æ‰‹åŠ¨åŠ å…¥â€œè‡ªå¯ç™½åå•â€</li>
</ul>
<hr>
<p>æœ¬æ–‡é€‚ç”¨äºåŸºäº Qt 5&#x2F;6 çš„ Android é¡¹ç›®ï¼Œå¦‚éœ€æ­é… JNI ä¸åŸç”ŸæœåŠ¡è¿˜å¯æ‰©å±• Service ä¿æ´»ç­–ç•¥ã€‚</p>
<hr>
<h2 id="ğŸ§ -JBmsActivity-å°±æ˜¯-Android-ä¸‹çš„-Qt-å¯åŠ¨â€œmain-å‡½æ•°å…¥å£â€"><a href="#ğŸ§ -JBmsActivity-å°±æ˜¯-Android-ä¸‹çš„-Qt-å¯åŠ¨â€œmain-å‡½æ•°å…¥å£â€" class="headerlink" title="ğŸ§  JBmsActivity å°±æ˜¯ Android ä¸‹çš„ Qt å¯åŠ¨â€œmain å‡½æ•°å…¥å£â€"></a>ğŸ§  JBmsActivity å°±æ˜¯ Android ä¸‹çš„ Qt å¯åŠ¨â€œmain å‡½æ•°å…¥å£â€</h2><p>åœ¨æ¡Œé¢ Qt åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸é€šè¿‡ <code>main()</code> å‡½æ•°ä½œä¸ºç¨‹åºå…¥å£ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">app</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    MainWindow w;</span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line">    <span class="keyword">return</span> app.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†åœ¨ Android å¹³å°ï¼ŒQt åº”ç”¨æ— æ³•ç›´æ¥ä» <code>main()</code> å¯åŠ¨ï¼Œè€Œæ˜¯ä¾èµ– Android çš„å¯åŠ¨æœºåˆ¶ï¼š</p>
<table>
<thead>
<tr>
<th>æ¡Œé¢ Qt</th>
<th>Android Qt</th>
</tr>
</thead>
<tbody><tr>
<td>ç›´æ¥è¿è¡Œ <code>main()</code></td>
<td>ç³»ç»Ÿå¯åŠ¨ <code>JBmsActivity</code></td>
</tr>
<tr>
<td><code>main()</code> ç”±å¼€å‘è€…æ§åˆ¶</td>
<td><code>main()</code> è¢« QtActivity é€šè¿‡ JNI é—´æ¥è°ƒç”¨</td>
</tr>
<tr>
<td>ç”Ÿå‘½å‘¨æœŸåœ¨ C++ æ§åˆ¶</td>
<td>ç”Ÿå‘½å‘¨æœŸç”± Java å±‚æ§åˆ¶ï¼Œå¯ hook å„é˜¶æ®µé€»è¾‘</td>
</tr>
</tbody></table>
<p>å› æ­¤ï¼Œ<code>JBmsActivity</code>ï¼š</p>
<ul>
<li>æ˜¯ç³»ç»Ÿå¯åŠ¨ Qt çš„ç¬¬ä¸€ç«™ï¼›</li>
<li>å¯ä»¥ç”¨æ¥æ£€æŸ¥æƒé™ã€åŠ è½½é…ç½®ï¼›</li>
<li>å¯ä»¥æ§åˆ¶æ˜¯å¦è¿›å…¥ Qt ä¸»ç¨‹åºï¼›</li>
<li>æ˜¯æ§åˆ¶æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸçš„é‡è¦ä½ç½®ï¼›</li>
<li>ç±»ä¼¼â€œAndroid ç¯å¢ƒä¸‹çš„ main å‡½æ•°å®ˆé—¨äººâ€ã€‚</li>
</ul>
<p>ä½ ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨ <code>JBmsActivity</code> é‡Œæ ¹æ®ä¸šåŠ¡é€»è¾‘å†³å®šï¼š</p>
<ul>
<li>æ˜¯å¦ç›´æ¥å¯åŠ¨ Qtï¼›</li>
<li>å»¶è¿Ÿè¿›å…¥ Qtï¼›</li>
<li>æˆ–è€…æ ¹æœ¬ä¸è¿›å…¥ Qtï¼Œä»…è¿è¡Œ Java å±‚é€»è¾‘ã€‚</li>
</ul>
<p>è¿™ä½¿å¾— <code>JBmsActivity</code> æˆä¸º Android Qt é¡¹ç›®çš„å…³é”®å…¥å£ç‚¹ã€‚</p>
]]></content>
      <categories>
        <category>QTå®ä¾‹</category>
      </categories>
      <tags>
        <tag>QT for Android</tag>
        <tag>QT</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2025/02/16/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Hexo åšå®¢éƒ¨ç½² GitHub å¤±è´¥è§£å†³æ–¹æ¡ˆ</title>
    <url>/2025/03/25/hexo_github_%E9%83%A8%E7%BD%B2%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
    <content><![CDATA[<blockquote>
<p>Hexo åšå®¢éƒ¨ç½² GitHub Pages å‡ºç° æ— æ³•æ›´æ–° ç”šè‡³404é”™è¯¯ çš„å®Œæ•´æ’æŸ¥ä¸ä¿®å¤è®°å½•ï¼ˆå« .nojekyll + Actions å†²çªï¼‰</p>
</blockquote>
<hr>
<h2 id="ğŸ“Œ-èƒŒæ™¯"><a href="#ğŸ“Œ-èƒŒæ™¯" class="headerlink" title="ğŸ“Œ èƒŒæ™¯"></a>ğŸ“Œ èƒŒæ™¯</h2><p>åœ¨ä½¿ç”¨ Hexo éƒ¨ç½²é™æ€åšå®¢åˆ° GitHub Pages çš„è¿‡ç¨‹ä¸­ï¼Œè™½ç„¶æœ¬åœ° <code>hexo g &amp;&amp; hexo d</code> æ‰§è¡ŒæˆåŠŸï¼Œä½†è®¿é—® <code>https://ç”¨æˆ·å.github.io/</code> å´å‘ç°æ²¡æœ‰æ›´æ–°ï¼Œç”šè‡³å‡ºç° 404 é”™è¯¯ã€‚</p>
<hr>
<h2 id="ğŸ’¥-é‡åˆ°çš„é—®é¢˜"><a href="#ğŸ’¥-é‡åˆ°çš„é—®é¢˜" class="headerlink" title="ğŸ’¥ é‡åˆ°çš„é—®é¢˜"></a>ğŸ’¥ é‡åˆ°çš„é—®é¢˜</h2><h3 id="âŒ-GitHub-Actions-è‡ªåŠ¨éƒ¨ç½²å¤±è´¥"><a href="#âŒ-GitHub-Actions-è‡ªåŠ¨éƒ¨ç½²å¤±è´¥" class="headerlink" title="âŒ GitHub Actions è‡ªåŠ¨éƒ¨ç½²å¤±è´¥"></a>âŒ GitHub Actions è‡ªåŠ¨éƒ¨ç½²å¤±è´¥</h3><p>é”™è¯¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Error: Getting Pages deployment status failed</span><br><span class="line">Error: HttpError: Server Error</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§¨-é—®é¢˜ç—‡çŠ¶"><a href="#ğŸ§¨-é—®é¢˜ç—‡çŠ¶" class="headerlink" title="ğŸ§¨ é—®é¢˜ç—‡çŠ¶"></a>ğŸ§¨ é—®é¢˜ç—‡çŠ¶</h2><ul>
<li>é¡µé¢æç¤ºï¼š<code>404 - There isn&#39;t a GitHub Pages site here.</code></li>
<li>GitHub Actions ä¸­çš„ <code>pages-build-deployment</code> å¤šæ¬¡å¤±è´¥</li>
<li>GitHub Pages è®¾ç½®æ­£ç¡®ï¼Œä½¿ç”¨çš„æ˜¯ <code>main</code> åˆ†æ”¯ + <code>/ (root)</code></li>
<li>æœ¬åœ° Hexo éƒ¨ç½²æˆåŠŸï¼Œ<code>public/</code> ç›®å½•æ–‡ä»¶ä¹Ÿæ­£å¸¸ç”Ÿæˆ</li>
</ul>
<hr>
<h2 id="ğŸ§ -é—®é¢˜åŸå› æ€»ç»“"><a href="#ğŸ§ -é—®é¢˜åŸå› æ€»ç»“" class="headerlink" title="ğŸ§  é—®é¢˜åŸå› æ€»ç»“"></a>ğŸ§  é—®é¢˜åŸå› æ€»ç»“</h2><h3 id="âœ…-é—®é¢˜-1ï¼šGitHub-é»˜è®¤ä½¿ç”¨-Jekyll-æ„å»º"><a href="#âœ…-é—®é¢˜-1ï¼šGitHub-é»˜è®¤ä½¿ç”¨-Jekyll-æ„å»º" class="headerlink" title="âœ… é—®é¢˜ 1ï¼šGitHub é»˜è®¤ä½¿ç”¨ Jekyll æ„å»º"></a>âœ… é—®é¢˜ 1ï¼šGitHub é»˜è®¤ä½¿ç”¨ Jekyll æ„å»º</h3><p>Hexo æ˜¯é™æ€æ–‡ä»¶ï¼Œä¸éœ€è¦ Jekyllã€‚ä½† GitHub é»˜è®¤è®¤ä¸ºä½ çš„ç«™ç‚¹æ˜¯ç”¨ Jekyll æ„å»ºçš„ï¼Œå¯¼è‡´ï¼š</p>
<ul>
<li>éƒ¨åˆ†é¡µé¢ä¸åœçš„æ„å»ºå¤±è´¥</li>
<li>åŸå› æœªçŸ¥ï¼Œéƒ¨åˆ†é¡µé¢å¯ä»¥å®Œæˆæ„å»ºï¼Œéƒ¨åˆ†å°†å¤±è´¥ï¼Œè¿™éƒ¨åˆ†æ˜¯å¤±è´¥çš„æ„å»ºå°†ä½¿å½“æ­¤éƒ¨ç½²å¤±è´¥</li>
</ul>
<hr>
<h2 id="âœ…-è§£å†³æ–¹æ¡ˆæ­¥éª¤"><a href="#âœ…-è§£å†³æ–¹æ¡ˆæ­¥éª¤" class="headerlink" title="âœ… è§£å†³æ–¹æ¡ˆæ­¥éª¤"></a>âœ… è§£å†³æ–¹æ¡ˆæ­¥éª¤</h2><h3 id="ğŸ”§-æ­¥éª¤-1ï¼šåˆ›å»º-nojekyll-æ–‡ä»¶"><a href="#ğŸ”§-æ­¥éª¤-1ï¼šåˆ›å»º-nojekyll-æ–‡ä»¶" class="headerlink" title="ğŸ”§ æ­¥éª¤ 1ï¼šåˆ›å»º .nojekyll æ–‡ä»¶"></a>ğŸ”§ æ­¥éª¤ 1ï¼šåˆ›å»º <code>.nojekyll</code> æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> &gt; <span class="built_in">source</span>/.nojekyll</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…åœ¨ <code>source/</code> ç›®å½•ä¸‹æ‰‹åŠ¨æ–°å»ºä¸€ä¸ª <code>.nojekyll</code> ç©ºæ–‡ä»¶ã€‚</p>
<p>è¯¥æ–‡ä»¶ä¸ºç©ºç™½æ–‡ä»¶ï¼Œæ„æ€ä¸ºå£°æ˜è¯¥ç›®å½•ä¸éœ€è¦githubè¿›è¡ŒJekyll æ„å»ºã€‚</p>
<hr>
<h3 id="ğŸ”§-æ­¥éª¤-2ï¼šé…ç½®-Hexo-è‡ªåŠ¨åŒ…å«-nojekyll"><a href="#ğŸ”§-æ­¥éª¤-2ï¼šé…ç½®-Hexo-è‡ªåŠ¨åŒ…å«-nojekyll" class="headerlink" title="ğŸ”§ æ­¥éª¤ 2ï¼šé…ç½® Hexo è‡ªåŠ¨åŒ…å« .nojekyll"></a>ğŸ”§ æ­¥éª¤ 2ï¼šé…ç½® Hexo è‡ªåŠ¨åŒ…å« <code>.nojekyll</code></h3><p>æ‰“å¼€ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code>ï¼Œæ·»åŠ ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">include:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">.nojekyll</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€æ­¥éå¸¸å…³é”®ï¼å®ƒèƒ½è®© Hexo æ„å»ºæ—¶è‡ªåŠ¨å°† <code>.nojekyll</code> æ‹·è´è¿› <code>public/</code> ç›®å½•ã€‚</p>
<hr>
<h3 id="ğŸ”§-æ­¥éª¤-3ï¼šé‡æ–°æ„å»ºå¹¶éƒ¨ç½²"><a href="#ğŸ”§-æ­¥éª¤-3ï¼šé‡æ–°æ„å»ºå¹¶éƒ¨ç½²" class="headerlink" title="ğŸ”§ æ­¥éª¤ 3ï¼šé‡æ–°æ„å»ºå¹¶éƒ¨ç½²"></a>ğŸ”§ æ­¥éª¤ 3ï¼šé‡æ–°æ„å»ºå¹¶éƒ¨ç½²</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<hr>
<p>- </p>
<hr>
<h2 id="âœ…-æœ€ç»ˆæ•ˆæœ"><a href="#âœ…-æœ€ç»ˆæ•ˆæœ" class="headerlink" title="âœ… æœ€ç»ˆæ•ˆæœ"></a>âœ… æœ€ç»ˆæ•ˆæœ</h2><ul>
<li><code>https://ç”¨æˆ·å.github.io/</code> æ­£å¸¸åŠ è½½é¡µé¢</li>
<li>GitHub Pages ä¸å†æŠ¥é”™</li>
<li>æ‰€æœ‰ Hexo é™æ€èµ„æºéƒ½è¢«æ­£ç¡®éƒ¨ç½²å¹¶å¯è®¿é—®</li>
</ul>
<hr>
<h2 id="âœ¨-æ€»ç»“"><a href="#âœ¨-æ€»ç»“" class="headerlink" title="âœ¨ æ€»ç»“"></a>âœ¨ æ€»ç»“</h2><table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>æ˜¯å¦å®Œæˆ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>.nojekyll</code> æ–‡ä»¶</td>
<td>âœ…</td>
<td>ç¦ç”¨ Jekyll</td>
</tr>
<tr>
<td><code>include:</code> é…ç½®</td>
<td>âœ…</td>
<td>ç¡®ä¿ <code>.nojekyll</code> è¢«æ‰“åŒ…åˆ° public</td>
</tr>
<tr>
<td>Pages æºè®¾ç½®</td>
<td>âœ…</td>
<td>main åˆ†æ”¯ + &#x2F; æ ¹ç›®å½•</td>
</tr>
</tbody></table>
<hr>
<p>ğŸš€ <strong>éƒ¨ç½²æˆåŠŸçš„å…³é”®åœ¨äº <code>.nojekyll + include é…ç½®</code>ï¼Œä¸€æ—¦è®¾ç½®å®Œæ¯•ï¼Œå³å¯è·³è¿‡æ‰€æœ‰ Jekyll å’Œ Actions çš„æ„å»ºå¹²æ‰°ã€‚</strong></p>
]]></content>
      <categories>
        <category>æ•™ç¨‹</category>
      </categories>
      <tags>
        <tag>GitHub</tag>
      </tags>
  </entry>
  <entry>
    <title>qmake vs CMake å¯¹æ¯”åˆ†æ</title>
    <url>/2025/03/17/qmake_vs_cmake%20%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<blockquote>
<p>QTä¸¤ç§é…ç½®æ–‡ä»¶qmakeå’ŒCMakeçš„å¯¹æ¯”åˆ†æä¸æ€»ç»“</p>
</blockquote>
<hr>
<h2 id="1-å®šä½ä¸è®¾è®¡èƒŒæ™¯"><a href="#1-å®šä½ä¸è®¾è®¡èƒŒæ™¯" class="headerlink" title="1. å®šä½ä¸è®¾è®¡èƒŒæ™¯"></a>1. å®šä½ä¸è®¾è®¡èƒŒæ™¯</h2><ul>
<li><p><strong>qmake</strong>  </p>
<ul>
<li>ä¸“ä¸º Qt é‡èº«æ‰“é€ çš„æ„å»ºå·¥å…·ï¼Œç®€åŒ– Qt é¡¹ç›®çš„æ„å»ºæµç¨‹ã€‚</li>
<li>è‡ªåŠ¨å¤„ç† <code>.pro</code> æ–‡ä»¶ï¼Œç”Ÿæˆ Makefile æˆ– IDE å·¥ç¨‹ï¼Œæ·±åº¦é›†æˆ mocã€uicã€rcc ç­‰ Qt å·¥å…·ã€‚</li>
</ul>
</li>
<li><p><strong>CMake</strong>  </p>
<ul>
<li>é€šç”¨çš„è·¨å¹³å°æ„å»ºç³»ç»Ÿï¼Œç‹¬ç«‹äº Qt ç”Ÿæ€ï¼Œç”± Kitware å¼€å‘ã€‚</li>
<li>æ”¯æŒç”Ÿæˆå¤šä¸ªå¹³å°ä¸‹çš„å·¥ç¨‹æ–‡ä»¶ï¼ˆMakefileã€Ninjaã€Visual Studioã€Xcode ç­‰ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h2 id="2-è¯­æ³•ä¸é…ç½®æ–¹å¼"><a href="#2-è¯­æ³•ä¸é…ç½®æ–¹å¼" class="headerlink" title="2. è¯­æ³•ä¸é…ç½®æ–¹å¼"></a>2. è¯­æ³•ä¸é…ç½®æ–¹å¼</h2><table>
<thead>
<tr>
<th>æ¯”è¾ƒç»´åº¦</th>
<th>qmake</th>
<th>CMake</th>
</tr>
</thead>
<tbody><tr>
<td>é…ç½®æ–‡ä»¶</td>
<td><code>.pro</code></td>
<td><code>CMakeLists.txt</code></td>
</tr>
<tr>
<td>è¯­æ³•é£æ ¼</td>
<td>é”®å€¼å¯¹å¼ï¼Œå£°æ˜å¼ï¼ˆç®€æ´ï¼‰</td>
<td>å‘½ä»¤å¼ï¼ŒåŠŸèƒ½ä¸°å¯Œä½†è¾ƒå¤æ‚</td>
</tr>
<tr>
<td>ç‰¹æ€§æ”¯æŒ</td>
<td>é»˜è®¤å¤„ç† Qt ç‰¹æ€§ï¼ˆmoc&#x2F;uic&#x2F;rccï¼‰</td>
<td>éœ€æ˜¾å¼è°ƒç”¨ç›¸å…³å®å¦‚ <code>QT_WRAP_CPP</code> ç­‰</td>
</tr>
</tbody></table>
<h2 id="3-æ„å»ºç›®å½•ç®¡ç†"><a href="#3-æ„å»ºç›®å½•ç®¡ç†" class="headerlink" title="3. æ„å»ºç›®å½•ç®¡ç†"></a>3. æ„å»ºç›®å½•ç®¡ç†</h2><ul>
<li><p><strong>qmake</strong>  </p>
<ul>
<li>é»˜è®¤åœ¨æºç æ ‘ä¸­ç”Ÿæˆ Makefileï¼Œä¹Ÿæ”¯æŒ shadow buildï¼ˆQt Creator æ”¯æŒï¼‰ã€‚</li>
</ul>
</li>
<li><p><strong>CMake</strong>  </p>
<ul>
<li>å¤©ç„¶æ”¯æŒæºç æ ‘å¤–æ„å»ºï¼ˆout-of-sourceï¼‰ï¼Œä¾¿äºç®¡ç†å¤šä¸ªæ„å»ºç‰ˆæœ¬ã€‚</li>
</ul>
</li>
</ul>
<h2 id="4-Qt-é¡¹ç›®æ”¯æŒï¼šç®€å•-vs-å¤æ‚"><a href="#4-Qt-é¡¹ç›®æ”¯æŒï¼šç®€å•-vs-å¤æ‚" class="headerlink" title="4. Qt é¡¹ç›®æ”¯æŒï¼šç®€å• vs å¤æ‚"></a>4. Qt é¡¹ç›®æ”¯æŒï¼šç®€å• vs å¤æ‚</h2><ul>
<li><p>å¯¹äºç®€å• Qt æ§åˆ¶å°ç¨‹åºï¼š</p>
<ul>
<li><code>qmake</code> é…ç½®æç®€ï¼Œå‡ è¡Œ <code>.pro</code> æ–‡ä»¶å³å¯ã€‚</li>
<li><code>CMake</code> éœ€è¦ FIND_PACKAGEã€INCLUDEã€æ·»åŠ ç›®æ ‡ä¸é“¾æ¥åº“ç­‰æ­¥éª¤ã€‚</li>
</ul>
</li>
<li><p>å¯¹äºå¸¦ UIã€ç±»çš„é¡¹ç›®ï¼š</p>
<ul>
<li><code>qmake</code> è‡ªåŠ¨å¤„ç† <code>Q_OBJECT</code> å’Œ <code>.ui</code> æ–‡ä»¶ã€‚</li>
<li><code>CMake</code> éœ€æ˜¾å¼ä½¿ç”¨ <code>QT_WRAP_CPP</code>ã€<code>QT_WRAP_UI</code> å®å¤„ç†ã€‚</li>
</ul>
</li>
</ul>
<h2 id="5-å¹³å°å·®å¼‚åŒ–å¤„ç†"><a href="#5-å¹³å°å·®å¼‚åŒ–å¤„ç†" class="headerlink" title="5. å¹³å°å·®å¼‚åŒ–å¤„ç†"></a>5. å¹³å°å·®å¼‚åŒ–å¤„ç†</h2><ul>
<li><p>Windows å­ç³»ç»ŸåŒºåˆ†ï¼š</p>
<ul>
<li>qmakeï¼šé€šè¿‡ <code>CONFIG += console</code> æ§åˆ¶ç¨‹åºç±»å‹ã€‚</li>
<li>CMakeï¼šé€šè¿‡ <code>WIN32</code> å…³é”®å­—ã€å®šä¹‰ <code>QT_USE_QTMAIN</code> å®ç°ã€‚</li>
</ul>
</li>
<li><p>RC æ–‡ä»¶æ”¯æŒï¼š</p>
<ul>
<li>qmakeï¼šä½¿ç”¨ <code>RC_FILE = xxx.rc</code></li>
<li>CMakeï¼šéœ€æ‰‹åŠ¨è®¾å®š <code>ENABLE_LANGUAGE(RC)</code> ç­‰é…ç½®ã€‚</li>
</ul>
</li>
</ul>
<h2 id="6-æ„å»ºç±»å‹ç®¡ç†"><a href="#6-æ„å»ºç±»å‹ç®¡ç†" class="headerlink" title="6. æ„å»ºç±»å‹ç®¡ç†"></a>6. æ„å»ºç±»å‹ç®¡ç†</h2><ul>
<li>qmakeï¼šä½¿ç”¨ <code>make debug</code> &#x2F; <code>make release</code></li>
<li>CMakeï¼šæ¨èä½¿ç”¨æ„å»ºç›®å½• + <code>-DCMAKE_BUILD_TYPE=Debug/Release</code></li>
</ul>
<h2 id="7ã€å¸¸ç”¨æ„å»ºé¡¹å¯¹ç…§è¡¨"><a href="#7ã€å¸¸ç”¨æ„å»ºé¡¹å¯¹ç…§è¡¨" class="headerlink" title="7ã€å¸¸ç”¨æ„å»ºé¡¹å¯¹ç…§è¡¨"></a>7ã€å¸¸ç”¨æ„å»ºé¡¹å¯¹ç…§è¡¨</h2><table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th>qmake è¯­æ³•ï¼ˆ.proï¼‰</th>
<th>CMake è¯­æ³•ï¼ˆCMakeLists.txtï¼‰</th>
<th>ä¸­æ–‡è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>é¡¹ç›®å</td>
<td><code>TARGET = MyApp</code></td>
<td><code>project(MyApp)</code></td>
<td>è®¾ç½®å·¥ç¨‹åç§°</td>
</tr>
<tr>
<td>åº”ç”¨ç±»å‹</td>
<td><code>TEMPLATE = app</code></td>
<td><code>add_executable(...)</code></td>
<td>å£°æ˜ç”Ÿæˆç›®æ ‡ä¸ºåº”ç”¨ç¨‹åº</td>
</tr>
<tr>
<td>Qt æ¨¡å—</td>
<td><code>QT += core gui widgets</code></td>
<td><code>find_package(Qt5 REQUIRED COMPONENTS Core Gui Widgets)</code></td>
<td>æ·»åŠ  Qt æ¨¡å—</td>
</tr>
<tr>
<td>æºæ–‡ä»¶</td>
<td><code>SOURCES += main.cpp</code></td>
<td><code>add_executable(MyApp main.cpp)</code></td>
<td>æ·»åŠ æºæ–‡ä»¶</td>
</tr>
<tr>
<td>å¤´æ–‡ä»¶</td>
<td><code>HEADERS += main.h</code></td>
<td>ä¸æºæ–‡ä»¶ä¸€åŒåŠ å…¥å³å¯</td>
<td>æ·»åŠ å¤´æ–‡ä»¶</td>
</tr>
<tr>
<td>UI æ–‡ä»¶</td>
<td><code>FORMS += ui.ui</code></td>
<td><code>set(CMAKE_AUTOUIC ON)</code> å¹¶åŠ å…¥åˆ—è¡¨</td>
<td>Qt Designer UI æ–‡ä»¶</td>
</tr>
<tr>
<td>èµ„æºæ–‡ä»¶</td>
<td><code>RESOURCES += res.qrc</code></td>
<td><code>set(CMAKE_AUTORCC ON)</code> å¹¶åŠ å…¥åˆ—è¡¨</td>
<td>Qt èµ„æºæ–‡ä»¶</td>
</tr>
<tr>
<td>åŒ…å«è·¯å¾„</td>
<td><code>INCLUDEPATH += ./include</code></td>
<td><code>target_include_directories(MyApp PRIVATE ./include)</code></td>
<td>æ·»åŠ å¤´æ–‡ä»¶æœç´¢è·¯å¾„</td>
</tr>
<tr>
<td>å®å®šä¹‰</td>
<td><code>DEFINES += MY_DEFINE=1</code></td>
<td><code>add_definitions(-DMY_DEFINE=1)</code></td>
<td>ç¼–è¯‘æ—¶å®å®šä¹‰</td>
</tr>
<tr>
<td>ç¼–è¯‘å™¨å‚æ•°</td>
<td><code>QMAKE_CXXFLAGS += -Wall</code></td>
<td><code>target_compile_options(...)</code></td>
<td>æ·»åŠ ç¼–è¯‘å™¨é€‰é¡¹</td>
</tr>
<tr>
<td>é“¾æ¥åº“</td>
<td><code>LIBS += -lmylib</code></td>
<td><code>target_link_libraries(MyApp mylib)</code></td>
<td>é“¾æ¥å¤–éƒ¨åº“</td>
</tr>
<tr>
<td>åº“è·¯å¾„</td>
<td><code>LIBS += -L./libs</code></td>
<td><code>link_directories(./libs)</code>ï¼ˆä¸æ¨èï¼‰</td>
<td>æ·»åŠ åº“æœç´¢è·¯å¾„</td>
</tr>
<tr>
<td>ç¼–è¯‘æ¨¡å¼</td>
<td><code>CONFIG += debug</code></td>
<td><code>if(CMAKE_BUILD_TYPE STREQUAL &quot;Debug&quot;)</code></td>
<td>æŒ‡å®šè°ƒè¯•æ¨¡å¼</td>
</tr>
<tr>
<td>å­é¡¹ç›®</td>
<td><code>SUBDIRS += submodule</code></td>
<td><code>add_subdirectory(submodule)</code></td>
<td>æ·»åŠ å­ç›®å½•æ¨¡å—</td>
</tr>
<tr>
<td>ä½¿ç”¨ C++11</td>
<td><code>CONFIG += c++11</code></td>
<td><code>set(CMAKE_CXX_STANDARD 11)</code></td>
<td>è®¾ç½® C++ æ ‡å‡†</td>
</tr>
<tr>
<td>åŒ…å« .pri æ–‡ä»¶</td>
<td><code>include(service/service.pri)</code></td>
<td><code>include(...)</code> æˆ– <code>add_subdirectory()</code></td>
<td>å¼•å…¥æ¨¡å—é…ç½®</td>
</tr>
</tbody></table>
<hr>
<h2 id="8ã€ç¤ºä¾‹è½¬æ¢ï¼šqmake-â†’-CMake"><a href="#8ã€ç¤ºä¾‹è½¬æ¢ï¼šqmake-â†’-CMake" class="headerlink" title="8ã€ç¤ºä¾‹è½¬æ¢ï¼šqmake â†’ CMake"></a>8ã€ç¤ºä¾‹è½¬æ¢ï¼šqmake â†’ CMake</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è®¾ç½®æ„å»ºç›®æ ‡åç§°</span><br><span class="line">TARGET = MyApp                          # CMake: project(MyApp)</span><br><span class="line"></span><br><span class="line"># è®¾ç½®æ„å»ºç±»å‹ä¸ºåº”ç”¨ç¨‹åº</span><br><span class="line">TEMPLATE = app                          # CMake: add_executable(...)</span><br><span class="line"></span><br><span class="line"># å¼•å…¥ Qt æ¨¡å—</span><br><span class="line">QT += core gui widgets    # CMake: find_package(Qt5 REQUIRED COMPONENTS Core Gui Widgets)</span><br><span class="line"></span><br><span class="line"># æ·»åŠ æºç æ–‡ä»¶</span><br><span class="line">SOURCES += main.cpp \                   # CMake: åˆ—å…¥ add_executable(...)</span><br><span class="line">           mainwindow.cpp</span><br><span class="line"></span><br><span class="line"># æ·»åŠ å¤´æ–‡ä»¶</span><br><span class="line">HEADERS += mainwindow.h                # CMake: å¯ç›´æ¥åˆ—å…¥ add_executable()</span><br><span class="line"></span><br><span class="line"># æ·»åŠ  UI è®¾è®¡æ–‡ä»¶</span><br><span class="line">FORMS += mainwindow.ui                 # CMake: set(CMAKE_AUTOUIC ON) å¹¶åˆ—å…¥ add_executable()</span><br><span class="line"></span><br><span class="line"># æ·»åŠ  Qt èµ„æºæ–‡ä»¶</span><br><span class="line">RESOURCES += res.qrc                   # CMake: set(CMAKE_AUTORCC ON) å¹¶åˆ—å…¥ add_executable()</span><br><span class="line"></span><br><span class="line"># æ·»åŠ å¤´æ–‡ä»¶æœç´¢è·¯å¾„</span><br><span class="line">INCLUDEPATH += ./include     # CMake: target_include_directories(MyApp PRIVATE ./include)</span><br><span class="line"></span><br><span class="line"># æ·»åŠ é¢„ç¼–è¯‘å®</span><br><span class="line">DEFINES += MY_DEFINE=1                 # CMake: add_definitions(-DMY_DEFINE=1)</span><br><span class="line"></span><br><span class="line"># æ·»åŠ ç¼–è¯‘å™¨å‚æ•°</span><br><span class="line">QMAKE_CXXFLAGS += -Wall              # CMake: target_compile_options(MyApp PRIVATE -Wall)</span><br><span class="line"></span><br><span class="line"># æ·»åŠ åº“è·¯å¾„</span><br><span class="line">LIBS += -L./libs                       # CMake: link_directories($&#123;CMAKE_SOURCE_DIR&#125;/libs)</span><br><span class="line"></span><br><span class="line"># é“¾æ¥åº“</span><br><span class="line">LIBS += -lmylib                       # CMake: target_link_libraries(MyApp PRIVATE mylib)</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ C++11 æ ‡å‡†</span><br><span class="line">CONFIG += c++11                        # CMake: set(CMAKE_CXX_STANDARD 11)</span><br><span class="line"></span><br><span class="line"># å¼•å…¥å­æ¨¡å—é…ç½®</span><br><span class="line">include(./service/service.pri)# CMake: include($&#123;CMAKE_SOURCE_DIR&#125;/service/service.cmake)</span><br><span class="line"></span><br><span class="line"># Windows Linux macOS iOS Android</span><br><span class="line">android</span><br><span class="line">&#123;</span><br><span class="line">    QT += androidextras</span><br><span class="line">    ANDROID_PACKAGE_SOURCE_DIR = $$PWD/android</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8ã€ç¤ºä¾‹è½¬æ¢ï¼šCMake-â†’-qmake"><a href="#8ã€ç¤ºä¾‹è½¬æ¢ï¼šCMake-â†’-qmake" class="headerlink" title="8ã€ç¤ºä¾‹è½¬æ¢ï¼šCMake â†’ qmake"></a>8ã€ç¤ºä¾‹è½¬æ¢ï¼šCMake â†’ qmake</h2><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®š CMake æœ€ä½ç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.14</span>)       <span class="comment"># qmake: æ— ç­‰æ•ˆé¡¹ï¼Œå›ºå®šç‰ˆæœ¬ç”±å·¥å…·é“¾å†³å®š</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é¡¹ç›®åç§°</span></span><br><span class="line"><span class="keyword">project</span>(MyApp)                             <span class="comment"># qmake: TARGET = MyApp</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ç”¨ Qt çš„ MOCã€UICã€RCC è‡ªåŠ¨å¤„ç†</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_AUTOMOC <span class="keyword">ON</span>)                      <span class="comment"># qmake: é»˜è®¤å¯ç”¨</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_AUTOUIC <span class="keyword">ON</span>)                      <span class="comment"># qmake: FORMS += xxx.ui</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_AUTORCC <span class="keyword">ON</span>)                      <span class="comment"># qmake: RESOURCES += xxx.qrc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® C++ æ ‡å‡†</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">11</span>)                 <span class="comment"># qmake: CONFIG += c++11</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD_REQUIRED <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾ Qt æ¨¡å—</span></span><br><span class="line"><span class="keyword">find_package</span>(Qt5 REQUIRED COMPONENTS Core Gui Widgets)   <span class="comment"># qmake: QT += core gui widgets</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å¯æ‰§è¡Œç›®æ ‡</span></span><br><span class="line"><span class="keyword">add_executable</span>(MyApp                       <span class="comment"># qmake: TEMPLATE = appï¼›SOURCES += ...</span></span><br><span class="line">    main.cpp</span><br><span class="line">    mainwindow.cpp</span><br><span class="line">    mainwindow.h                           <span class="comment"># qmake: HEADERS += ...</span></span><br><span class="line">    mainwindow.ui                          <span class="comment"># qmake: FORMS += ...</span></span><br><span class="line">    res.qrc                                <span class="comment"># qmake: RESOURCES += ...</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å¤´æ–‡ä»¶åŒ…å«è·¯å¾„</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(MyApp PRIVATE ./<span class="keyword">include</span>)   <span class="comment"># qmake: INCLUDEPATH += ./include</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å®å®šä¹‰</span></span><br><span class="line"><span class="keyword">add_definitions</span>(-DMY_DEFINE=<span class="number">1</span>)                         <span class="comment"># qmake: DEFINES += MY_DEFINE=1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ç¼–è¯‘å™¨å‚æ•°</span></span><br><span class="line"><span class="keyword">target_compile_options</span>(MyApp PRIVATE -Wall)           <span class="comment"># qmake: QMAKE_CXXFLAGS += -Wall</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ åº“è·¯å¾„ï¼ˆä¸æ¨èæ–¹å¼ï¼‰</span></span><br><span class="line"><span class="keyword">link_directories</span>(<span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/libs)            <span class="comment"># qmake: LIBS += -L./libs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é“¾æ¥å¤–éƒ¨åº“</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(MyApp PRIVATE mylib)            <span class="comment"># qmake: LIBS += -lmylib</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼•å…¥å¤–éƒ¨æ¨¡å—æˆ–å­é…ç½®</span></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/service/service.cmake)    <span class="comment"># qmake: include(service/service.pri)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#if(WIN32) if(UNIX) if(APPLE) if(IOS) if(ANDROID) if(ANDROID)</span></span><br><span class="line"><span class="comment"># ä»…åœ¨ Android å¹³å°ä¸‹æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">if</span>(ANDROID)</span><br><span class="line">    <span class="keyword">set_property</span>(<span class="keyword">TARGET</span> your_target PROPERTY ANDROID_PACKAGE_SOURCE_DIR <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>/android)</span><br><span class="line">    <span class="keyword">target_link_libraries</span>(your_target PRIVATE Qt5::AndroidExtras)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>QT_é…ç½®</category>
      </categories>
      <tags>
        <tag>QT</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt UI æ˜¾ç¤ºå™¨åˆ†è¾¨ç‡å·®å¼‚é€ æˆæ§ä»¶ä¸å­—ä½“ç¼©æ”¾å·®å¼‚è§£å†³æ–¹æ¡ˆ</title>
    <url>/2025/04/02/qt_UI_%E6%98%BE%E7%A4%BA%E5%99%A8%E5%88%86%E8%BE%A8%E7%8E%87%E5%B7%AE%E5%BC%82%E9%80%A0%E6%88%90%E6%8E%A7%E4%BB%B6%E4%B8%8E%E5%AD%97%E4%BD%93%E7%BC%A9%E6%94%BE%E5%B7%AE%E5%BC%82%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
    <content><![CDATA[<blockquote>
<p>å¦‚ä½•æ‰‹åŠ¨é…ç½® Qt çš„é«˜ DPI ç¼©æ”¾ç­–ç•¥ã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸€ã€ç›®çš„è¯´æ˜"><a href="#ä¸€ã€ç›®çš„è¯´æ˜" class="headerlink" title="ä¸€ã€ç›®çš„è¯´æ˜"></a>ä¸€ã€ç›®çš„è¯´æ˜</h2><p>åœ¨å¤šåˆ†è¾¨ç‡æˆ–é«˜ DPI æ˜¾ç¤ºå™¨ç¯å¢ƒä¸‹ï¼ˆä¾‹å¦‚ 1080p ä¸ 4K æ˜¾ç¤ºå™¨æ··ç”¨ï¼‰ï¼Œé»˜è®¤ Qt çš„ç¼©æ”¾è¡Œä¸ºå¯èƒ½å¯¼è‡´ï¼š</p>
<ul>
<li>æ§ä»¶å°ºå¯¸æ˜¾ç¤ºä¸ä¸€è‡´</li>
<li>å­—ä½“å’Œæ§ä»¶æ¯”ä¾‹ä¸æ­£ç¡®</li>
</ul>
<p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½® Qt çš„é«˜ DPI ç¼©æ”¾ç­–ç•¥ã€‚</p>
<hr>
<h2 id="äºŒã€æ§ä»¶ä¸å­—ä½“ç¼©æ”¾ä¸ä¸€è‡´é—®é¢˜è¯¦è§£"><a href="#äºŒã€æ§ä»¶ä¸å­—ä½“ç¼©æ”¾ä¸ä¸€è‡´é—®é¢˜è¯¦è§£" class="headerlink" title="äºŒã€æ§ä»¶ä¸å­—ä½“ç¼©æ”¾ä¸ä¸€è‡´é—®é¢˜è¯¦è§£"></a>äºŒã€æ§ä»¶ä¸å­—ä½“ç¼©æ”¾ä¸ä¸€è‡´é—®é¢˜è¯¦è§£</h2><p>åœ¨å¤šåˆ†è¾¨ç‡æ˜¾ç¤ºå™¨ç¯å¢ƒä¸­ï¼Œæ§ä»¶å°ºå¯¸ä¸å­—ä½“å¤§å°å¸¸å¸¸è¡¨ç°ä¸ä¸€è‡´ï¼ŒåŸå› åœ¨äºå®ƒä»¬çš„å•ä½å’Œç¼©æ”¾æœºåˆ¶ä¸åŒã€‚</p>
<h3 id="1-æ§ä»¶å¤§å°è®¾ç½®ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰"><a href="#1-æ§ä»¶å¤§å°è®¾ç½®ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰" class="headerlink" title="1. æ§ä»¶å¤§å°è®¾ç½®ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰"></a>1. æ§ä»¶å¤§å°è®¾ç½®ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">button-&gt;setFixedSize(<span class="number">100</span>, <span class="number">40</span>); <span class="comment">// è®¾ç½®ä¸º 100x40 åƒç´ </span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ§ä»¶å°ºå¯¸ä½¿ç”¨**åƒç´ ï¼ˆpxï¼‰**ä¸ºå•ä½ï¼Œ<strong>ä¸ä¼šè‡ªåŠ¨å‚ä¸ DPI ç¼©æ”¾</strong>ã€‚</li>
<li>åœ¨é«˜ DPI å±å¹•ä¸­ï¼ŒåŒæ ·åƒç´ ä¼šæ˜¾å¾—æ›´å°ã€‚</li>
<li>å¦‚æœæœªå¯ç”¨ Qt çš„é«˜ DPI ç¼©æ”¾æœºåˆ¶ï¼Œæ§ä»¶å°ºå¯¸åœ¨é«˜åˆ†å±ä¸Šä¼šâ€œç¼©æ°´â€ã€‚</li>
</ul>
<h3 id="2-å­—ä½“å¤§å°è®¾ç½®ï¼ˆä»¥ç‚¹ä¸ºå•ä½ï¼‰"><a href="#2-å­—ä½“å¤§å°è®¾ç½®ï¼ˆä»¥ç‚¹ä¸ºå•ä½ï¼‰" class="headerlink" title="2. å­—ä½“å¤§å°è®¾ç½®ï¼ˆä»¥ç‚¹ä¸ºå•ä½ï¼‰"></a>2. å­—ä½“å¤§å°è®¾ç½®ï¼ˆä»¥ç‚¹ä¸ºå•ä½ï¼‰</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QFont <span class="built_in">font</span>;</span><br><span class="line"><span class="built_in">font</span>.setPointSize(<span class="number">12</span>);</span><br><span class="line">widget-&gt;setFont(<span class="built_in">font</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>å­—ä½“å¤§å°ä½¿ç”¨**ç‚¹ï¼ˆptï¼‰**ä¸ºå•ä½ï¼Œ<strong>ä¼šè‡ªåŠ¨éš DPI ç¼©æ”¾</strong>ï¼ˆå¯ç”¨äº†é«˜ DPI æ”¯æŒæ—¶ï¼‰ã€‚</li>
<li>å­—ä½“åœ¨ä¸åŒ DPI å±å¹•ä¸‹æ˜¾ç¤ºæ›´ä¸€è‡´ã€‚</li>
</ul>
<hr>
<h3 id="ğŸ“Š-å¸¸è§é—®é¢˜è¡¨ç°å¯¹æ¯”"><a href="#ğŸ“Š-å¸¸è§é—®é¢˜è¡¨ç°å¯¹æ¯”" class="headerlink" title="ğŸ“Š å¸¸è§é—®é¢˜è¡¨ç°å¯¹æ¯”"></a>ğŸ“Š å¸¸è§é—®é¢˜è¡¨ç°å¯¹æ¯”</h3><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>æ™®é€šå±æ•ˆæœ</th>
<th>é«˜åˆ†å±æ•ˆæœï¼ˆæœªå¤„ç†ï¼‰</th>
<th>é—®é¢˜è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>æ§ä»¶å¤§å°</td>
<td>æ­£å¸¸</td>
<td>æ˜¾å¾—å¾ˆå°</td>
<td>æ§ä»¶æŒ‰åƒç´ æ¸²æŸ“ï¼Œæœªå‚ä¸ DPI ç¼©æ”¾</td>
</tr>
<tr>
<td>å­—ä½“å¤§å°</td>
<td>æ­£å¸¸</td>
<td>çœ‹èµ·æ¥åˆç†</td>
<td>å­—ä½“æŒ‰ç‚¹å•ä½è‡ªåŠ¨ç¼©æ”¾äº†</td>
</tr>
</tbody></table>
<hr>
<h2 id="ä¸‰ã€æ¨èé…ç½®æ–¹æ¡ˆ"><a href="#ä¸‰ã€æ¨èé…ç½®æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€æ¨èé…ç½®æ–¹æ¡ˆ"></a>ä¸‰ã€æ¨èé…ç½®æ–¹æ¡ˆ</h2><p>mainå‡½æ•°å†…<br><code>QApplication a(argc, argv);</code>å‰,è®¾ç½®å¦‚ä¸‹</p>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¯ç”¨é«˜ DPI ç¼©æ”¾æ”¯æŒï¼ˆQt 5.6+ï¼‰</span></span><br><span class="line"><span class="attribute">QCoreApplication</span>::setAttribute(<span class="attribute">Qt</span>::AA_EnableHighDpiScaling);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨é«˜åˆ†è¾¨ç‡å›¾åƒèµ„æºï¼ˆé¿å…å›¾æ ‡æ¨¡ç³Šï¼‰</span></span><br><span class="line"><span class="attribute">QCoreApplication</span>::setAttribute(<span class="attribute">Qt</span>::AA_UseHighDpiPixmaps);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ç¼©æ”¾å› å­èˆå…¥ç­–ç•¥ä¸º PassThroughï¼Œé¿å…è¢« Qt è‡ªåŠ¨å››èˆäº”å…¥</span></span><br><span class="line"><span class="attribute">QGuiApplication</span>::setHighDpiScaleFactorRoundingPolicy(</span><br><span class="line">    <span class="attribute">Qt</span>::<span class="attribute">HighDpiScaleFactorRoundingPolicy</span>::PassThrough);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ç”¨è‡ªåŠ¨æ ¹æ®å±å¹•åˆ†è¾¨ç‡ç¼©æ”¾</span></span><br><span class="line">qputenv(<span class="string">&quot;QT_AUTO_SCREEN_SCALE_FACTOR&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ï¼ˆå¯é€‰ï¼‰å›ºå®šæ•´ä¸ªåº”ç”¨ç¼©æ”¾æ¯”ä¾‹ä¸º 1.25 å€ï¼ˆæµ‹è¯•ç”¨ï¼‰</span></span><br><span class="line"><span class="comment">// qputenv(&quot;QT_SCALE_FACTOR&quot;, &quot;1.25&quot;);</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å››ã€å…³é”®è®¾ç½®è§£é‡Š"><a href="#å››ã€å…³é”®è®¾ç½®è§£é‡Š" class="headerlink" title="å››ã€å…³é”®è®¾ç½®è§£é‡Š"></a>å››ã€å…³é”®è®¾ç½®è§£é‡Š</h2><h3 id="1-Qt-HighDpiScaleFactorRoundingPolicy-PassThrough"><a href="#1-Qt-HighDpiScaleFactorRoundingPolicy-PassThrough" class="headerlink" title="1. Qt::HighDpiScaleFactorRoundingPolicy::PassThrough"></a>1. <code>Qt::HighDpiScaleFactorRoundingPolicy::PassThrough</code></h3><ul>
<li>ä¸èˆå…¥ç¼©æ”¾å› å­ï¼Œä¾‹å¦‚ 1.25 å°±ä¿æŒä¸º 1.25ï¼Œè€Œä¸æ˜¯å››èˆäº”å…¥ä¸º 1 æˆ– 2ã€‚</li>
<li>é¿å…å› ç¼©æ”¾è¢«æ”¹å†™å¯¼è‡´æ§ä»¶æˆ–å­—ä½“æ˜¾ç¤ºå¼‚å¸¸ã€‚</li>
<li>é€‚ç”¨äºéœ€è¦ç²¾ç¡®ç¼©æ”¾æ§åˆ¶çš„åº”ç”¨ã€‚</li>
</ul>
<h3 id="2-QT-AUTO-SCREEN-SCALE-FACTOR-1"><a href="#2-QT-AUTO-SCREEN-SCALE-FACTOR-1" class="headerlink" title="2. QT_AUTO_SCREEN_SCALE_FACTOR=1"></a>2. <code>QT_AUTO_SCREEN_SCALE_FACTOR=1</code></h3><ul>
<li>æ ¹æ®å½“å‰æ˜¾ç¤ºå™¨çš„ DPI è‡ªåŠ¨è®¡ç®—ç¼©æ”¾å› å­ã€‚</li>
<li>å¤šå±å¹•ï¼ˆä¸åŒ DPIï¼‰ä¸‹è‡ªåŠ¨é€‚é…ã€‚</li>
</ul>
<h3 id="3-AA-EnableHighDpiScaling"><a href="#3-AA-EnableHighDpiScaling" class="headerlink" title="3. AA_EnableHighDpiScaling"></a>3. <code>AA_EnableHighDpiScaling</code></h3><ul>
<li>å¯ç”¨ Qt é«˜ DPI ç¼©æ”¾æ”¯æŒã€‚</li>
<li>è¿™æ˜¯å¯ç”¨ç¼©æ”¾æœºåˆ¶çš„åŸºç¡€é…ç½®ã€‚</li>
</ul>
<h3 id="4-AA-UseHighDpiPixmaps"><a href="#4-AA-UseHighDpiPixmaps" class="headerlink" title="4. AA_UseHighDpiPixmaps"></a>4. <code>AA_UseHighDpiPixmaps</code></h3><ul>
<li>å›¾åƒèµ„æºä¹Ÿå°†ä½¿ç”¨é«˜åˆ†è¾¨ç‡ç‰ˆæœ¬ï¼ˆå¦‚ 2x PNG å›¾æ ‡ï¼‰ï¼Œä¿è¯æ¸…æ™°åº¦ã€‚</li>
</ul>
<h3 id="5-QT-SCALE-FACTOR-1-25ï¼ˆå¯é€‰ï¼‰"><a href="#5-QT-SCALE-FACTOR-1-25ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="5. QT_SCALE_FACTOR=1.25ï¼ˆå¯é€‰ï¼‰"></a>5. <code>QT_SCALE_FACTOR=1.25</code>ï¼ˆå¯é€‰ï¼‰</h3><ul>
<li>æ‰‹åŠ¨è®¾ç½®åº”ç”¨ç¼©æ”¾å€æ•°ï¼Œç”¨äºè°ƒè¯•æˆ–ä¸´æ—¶é€‚é…ä¸æ”¯æŒè‡ªåŠ¨ç¼©æ”¾çš„å¹³å°ã€‚</li>
</ul>
<hr>
<h2 id="äº”ã€æ•ˆæœæ€»ç»“"><a href="#äº”ã€æ•ˆæœæ€»ç»“" class="headerlink" title="äº”ã€æ•ˆæœæ€»ç»“"></a>äº”ã€æ•ˆæœæ€»ç»“</h2><ul>
<li>å¤šæ˜¾ç¤ºå™¨ç¼©æ”¾ä¸€è‡´æ€§å¢å¼º</li>
<li>æ§ä»¶ä¸å­—ä½“æŒ‰æ¯”ä¾‹ç²¾å‡†ç¼©æ”¾</li>
<li>ç•Œé¢æ¸…æ™°ä¸æ¨¡ç³Šï¼Œç‰¹åˆ«é€‚ç”¨äº 2K&#x2F;4K æ˜¾ç¤ºå™¨</li>
</ul>
<hr>
]]></content>
      <categories>
        <category>QT_UIé…ç½®</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>QT_UI</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt UI ç•Œé¢æ— æ“ä½œè¶…æ—¶è‡ªåŠ¨è¿”å›é¦–é¡µ</title>
    <url>/2025/04/05/qt_UI_%E7%95%8C%E9%9D%A2%E6%97%A0%E6%93%8D%E4%BD%9C%E8%B6%85%E6%97%B6%E8%87%AA%E5%8A%A8%E8%BF%94%E5%9B%9E%E9%A6%96%E9%A1%B5/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ Qt åº”ç”¨ç¨‹åºä¸­å®ç°â€œæ— æ“ä½œä¸€æ®µæ—¶é—´åè‡ªåŠ¨è¿”å›é¦–é¡µâ€çš„åŠŸèƒ½ï¼Œé€‚ç”¨äºå·¥ä¸šç»ˆç«¯ã€ä¿¡æ¯å±•ç¤ºå±ç­‰åœºæ™¯ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ§ -å®ç°åŸç†"><a href="#ğŸ§ -å®ç°åŸç†" class="headerlink" title="ğŸ§  å®ç°åŸç†"></a>ğŸ§  å®ç°åŸç†</h2><p>é€šè¿‡è‡ªå®šä¹‰ <code>QApplication</code> ç±»ï¼Œé‡è½½ <code>notify()</code> æ–¹æ³•æ¥ç›‘å¬å…¨å±€ç”¨æˆ·æ“ä½œï¼ˆå¦‚é¼ æ ‡ç‚¹å‡»ã€é”®ç›˜æŒ‰é”®ç­‰ï¼‰ï¼Œæ¯æ¬¡æ“ä½œåé‡ç½®ä¸€ä¸ªè®¡æ—¶å™¨ã€‚å½“è®¡æ—¶å™¨è¶…æ—¶åï¼Œè§¦å‘æ§½å‡½æ•°è‡ªåŠ¨è¿”å›ä¸»ç•Œé¢æˆ–é¦–é¡µã€‚</p>
<hr>
<h2 id="ğŸ”§-æ­¥éª¤ä¸€ï¼šè‡ªå®šä¹‰-MyApplication-ç±»"><a href="#ğŸ”§-æ­¥éª¤ä¸€ï¼šè‡ªå®šä¹‰-MyApplication-ç±»" class="headerlink" title="ğŸ”§ æ­¥éª¤ä¸€ï¼šè‡ªå®šä¹‰ MyApplication ç±»"></a>ğŸ”§ æ­¥éª¤ä¸€ï¼šè‡ªå®šä¹‰ MyApplication ç±»</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰ QApplication ç±»ï¼Œæ·»åŠ å…¨å±€é¼ æ ‡ç‚¹å‡»è§¦å‘å™¨</span></span><br><span class="line">class <span class="attribute">MyApplication</span> : public <span class="title">QApplication</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attribute">public</span>:</span><br><span class="line">    MyApplication(<span class="built_in">int</span>&amp; argc, char** argv) : QApplication(argc, argv) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">bool</span> notify(QObject* receiver, QEvent* event) <span class="title">override</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (event-&gt;type() == <span class="attribute">QEvent</span>::MouseButtonPress) &#123; <span class="comment">// æ£€æµ‹é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span></span><br><span class="line">            QMouseEvent* mouseEvent = static_cast&lt;QMouseEvent*&gt;(event);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœæ˜¯å·¦é”®ç‚¹å‡»äº‹ä»¶ï¼Œé‡ç½®è®¡æ—¶å™¨</span></span><br><span class="line">            <span class="keyword">if</span> (mouseEvent-&gt;buttons() &amp; <span class="attribute">Qt</span>::LeftButton) &#123;</span><br><span class="line">                <span class="keyword">if</span>(overallTimer != nullptr)</span><br><span class="line">                    overallTimer-&gt;start(); <span class="comment">// é‡ç½®è®¡æ—¶å™¨</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»§ç»­ä¼ é€’äº‹ä»¶ç»™çˆ¶ç±»çš„ notify() å‡½æ•°è¿›è¡Œå¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="attribute">QApplication</span>::notify(receiver, event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§·-æ­¥éª¤äºŒï¼šmain-å‡½æ•°ä¸­åˆå§‹åŒ–è®¡æ—¶å™¨"><a href="#ğŸ§·-æ­¥éª¤äºŒï¼šmain-å‡½æ•°ä¸­åˆå§‹åŒ–è®¡æ—¶å™¨" class="headerlink" title="ğŸ§· æ­¥éª¤äºŒï¼šmain å‡½æ•°ä¸­åˆå§‹åŒ–è®¡æ—¶å™¨"></a>ğŸ§· æ­¥éª¤äºŒï¼šmain å‡½æ•°ä¸­åˆå§‹åŒ–è®¡æ—¶å™¨</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="comment">//#include &quot;main.h&quot;</span></span><br><span class="line"><span class="comment">//extern QTimer* overallTimer;</span></span><br><span class="line"></span><br><span class="line">QTimer* overallTimer = nullptr; <span class="comment">// å›ºå®šæ—¶é—´è·³è½¬è‡³é¦–é¡µçš„è®¡æ—¶å™¨</span></span><br><span class="line"><span class="built_in">int</span> main(<span class="built_in">int</span> argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">    MyApplication app(argc, argv);</span><br><span class="line">    MainWindow w;</span><br><span class="line">    w.show();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è®¡æ—¶å™¨å¹¶æŒ‚åˆ° app å¯¹è±¡ä¸Š</span></span><br><span class="line">    overallTimer = <span class="keyword">new</span> QTimer(&amp;app);</span><br><span class="line">    overallTimer-&gt;start(<span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span>);  <span class="comment">// å¯åŠ¨å®šæ—¶å™¨ï¼š5åˆ†é’Ÿ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿æ¥è¶…æ—¶ä¿¡å·åˆ°ä¸»çª—å£çš„è¿”å›é¦–é¡µæ§½å‡½æ•°</span></span><br><span class="line">    <span class="attribute">QObject</span>::connect(overallTimer, &amp;<span class="attribute">QTimer</span>::timeout, &amp;w, &amp;<span class="attribute">MainWindow</span>::backHomePage);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> app.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“Œ-backHomePage-ç¤ºä¾‹ï¼ˆMainWindow-å†…ï¼‰"><a href="#ğŸ“Œ-backHomePage-ç¤ºä¾‹ï¼ˆMainWindow-å†…ï¼‰" class="headerlink" title="ğŸ“Œ backHomePage ç¤ºä¾‹ï¼ˆMainWindow å†…ï¼‰"></a>ğŸ“Œ backHomePage ç¤ºä¾‹ï¼ˆMainWindow å†…ï¼‰</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="attribute">MainWindow</span>::backHomePage() &#123;</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰é¡¶å±‚çª—å£</span></span><br><span class="line">    <span class="keyword">const</span> auto widgets = <span class="attribute">QApplication</span>::topLevelWidgets();</span><br><span class="line">    <span class="keyword">for</span> (QWidget *<span class="attribute">widget</span> : widgets) &#123;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸º QDialog ç±»å‹</span></span><br><span class="line">        <span class="keyword">if</span> (QDialog *dialog = qobject_cast&lt;QDialog *&gt;(widget)) &#123;</span><br><span class="line">            qDebug() &lt;&lt; <span class="string">&quot;Closing dialog:&quot;</span> &lt;&lt; dialog-&gt;objectName();</span><br><span class="line">            dialog-&gt;close(); <span class="comment">// å…³é—­å¯¹è¯æ¡†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å®ç°è¿”å›ä¸»ç•Œé¢çš„é€»è¾‘</span></span><br><span class="line">    ui-&gt;stackedWidget-&gt;setCurrentIndex(<span class="number">0</span>);</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">&quot;é•¿æ—¶é—´æ— æ“ä½œï¼Œå·²è¿”å›é¦–é¡µ&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-æ•ˆæœæ€»ç»“"><a href="#âœ…-æ•ˆæœæ€»ç»“" class="headerlink" title="âœ… æ•ˆæœæ€»ç»“"></a>âœ… æ•ˆæœæ€»ç»“</h2><table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>è‡ªåŠ¨æ£€æµ‹</td>
<td>é¼ æ ‡ã€é”®ç›˜ã€è§¦æ‘¸ç­‰è¾“å…¥</td>
</tr>
<tr>
<td>è‡ªåŠ¨é‡ç½®</td>
<td>æ¯æ¬¡äº¤äº’åè‡ªåŠ¨é‡ç½®å®šæ—¶å™¨</td>
</tr>
<tr>
<td>è¶…æ—¶è§¦å‘</td>
<td>ä¸€æ®µæ—¶é—´æ— æ“ä½œåè°ƒç”¨è¿”å›é¦–é¡µæ§½å‡½æ•°</td>
</tr>
<tr>
<td>åº”ç”¨åœºæ™¯</td>
<td>å·¥æ§ç•Œé¢ã€è‡ªåŠ¨å”®å–æœºã€å±•è§ˆç»ˆç«¯ç­‰</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ“Œ-å¯æ‹“å±•ç‚¹"><a href="#ğŸ“Œ-å¯æ‹“å±•ç‚¹" class="headerlink" title="ğŸ“Œ å¯æ‹“å±•ç‚¹"></a>ğŸ“Œ å¯æ‹“å±•ç‚¹</h2><ul>
<li>æ”¯æŒè‡ªå®šä¹‰è¶…æ—¶æ—¶é—´ã€é…ç½®é¡¹æŒä¹…åŒ–</li>
<li>æ”¯æŒåŠ¨æ€é˜»æ­¢è‡ªåŠ¨è·³è½¬ï¼ˆå¦‚æ’­æ”¾è§†é¢‘æ—¶æš‚åœå€’è®¡æ—¶ï¼‰</li>
<li>é›†æˆçŠ¶æ€æ æç¤ºâ€œxç§’åè¿”å›é¦–é¡µâ€ç­‰</li>
</ul>
<hr>
<blockquote>
<p>æœ¬åŠŸèƒ½é€‚ç”¨äº Qt 5&#x2F;6 å…¨å¹³å°ï¼Œæ¨èç”¨äºå·¥ä¸šæ§åˆ¶å’Œäººæœºäº¤äº’ç³»ç»Ÿä¸­æå‡ç”¨æˆ·ä½“éªŒã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>QT_UIé…ç½®</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>QT_UI</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt Designer ä¸­è®¾ç½®MainWindowé¡µé¦–èœå•æ ï¼ˆQMenu ä¸ QActionï¼‰</title>
    <url>/2025/07/25/qt_UI_%E8%AE%BE%E7%BD%AEMainWindow%E9%A1%B5%E9%A6%96%E8%8F%9C%E5%8D%95%E6%A0%8F/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬è¯´æ˜æ•´ç†äº†å¦‚ä½•åœ¨ Qt Designer ç•Œé¢ä¸­è®¾ç½®é¦–é¡µé¡¶éƒ¨å¯¼èˆª QMenu ä¸ QActionï¼Œä»¥åŠå®ƒä»¬çš„å…³ç³»å’Œå±æ€§è®¾ç½®ã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸€ã€åŸºæœ¬ç»“æ„"><a href="#ä¸€ã€åŸºæœ¬ç»“æ„" class="headerlink" title="ä¸€ã€åŸºæœ¬ç»“æ„"></a>ä¸€ã€åŸºæœ¬ç»“æ„</h2><p>Qt ä¸­èœå•æ ç»“æ„ä¸ºï¼š</p>
<ul>
<li><strong>QMainWindow</strong><ul>
<li>QMenuBarï¼ˆèœå•æ ï¼‰<ul>
<li>QMenuï¼ˆèœå•ï¼‰<ul>
<li>QActionï¼ˆèœå•é¡¹ï¼‰</li>
<li>åˆ†éš”ç¬¦</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ä¾‹å¦‚ï¼šæ–‡ä»¶(File) èœå•ä¸‹åŒ…å«â€œæ‰“å¼€â€ã€â€œä¿å­˜â€ã€â€œé€€å‡ºâ€ç­‰ QActionã€‚<img src="https://cdn.jsdelivr.net/gh/zhishuyouling7766/myHexoBlog-Assets@main/image/2025-07-26%20131710.png"></p>
<hr>
<h2 id="äºŒã€è®¾ç½®æ­¥éª¤"><a href="#äºŒã€è®¾ç½®æ­¥éª¤" class="headerlink" title="äºŒã€è®¾ç½®æ­¥éª¤"></a>äºŒã€è®¾ç½®æ­¥éª¤</h2><h3 id="1-æ·»åŠ èœå•æ "><a href="#1-æ·»åŠ èœå•æ " class="headerlink" title="1. æ·»åŠ èœå•æ "></a>1. æ·»åŠ èœå•æ </h3><p>åœ¨ Qt Designer ä¸­ï¼š</p>
<ol>
<li>æ–°å»ºçš„QTé¡¹ç›®ä¼šè‡ªåŠ¨å­˜åœ¨ä¸€ä¸ª <strong>QMainWindow</strong>ï¼Œä½œä¸ºç•Œé¢ä¸»çª—å£ï¼Œå…¶ä¼šè‡ªå¸¦QMenuBarèœå•æ </li>
<li>ç‚¹å‡»èœå•æ ï¼Œã€åœ¨è¿™é‡Œè¾“å…¥ã€‘åŒºåŸŸï¼Œå¯ä»¥å‘å…¶ä¸­æ·»åŠ èœå•ï¼ˆå¦‚â€œæ–‡ä»¶â€ã€â€œç¼–è¾‘â€ã€â€œå¸®åŠ©â€ã€â€œå…³äºâ€ï¼‰ã€‚</li>
</ol>
<h3 id="2-æ·»åŠ èœå•é¡¹ï¼ˆQActionï¼‰"><a href="#2-æ·»åŠ èœå•é¡¹ï¼ˆQActionï¼‰" class="headerlink" title="2. æ·»åŠ èœå•é¡¹ï¼ˆQActionï¼‰"></a>2. æ·»åŠ èœå•é¡¹ï¼ˆQActionï¼‰</h3><ol>
<li><p>åœ¨é¡¶éƒ¨èœå•æ ä¸‹çš„èœå•ä¸­å¯ä»¥ç›´æ¥æ·»åŠ èœå•é¡¹ï¼ˆå¯¹åº” <code>QAction</code>ï¼‰ä»¥åŠåˆ†éš”ç¬¦ã€‚</p>
</li>
<li><p>æˆ–è€…ï¼šæ‰“å¼€â€œåŠ¨ä½œç¼–è¾‘å™¨ï¼ˆAction ç¼–è¾‘å™¨ï¼‰â€ï¼Œç‚¹å‡»â€œæ–°å»ºâ€æŒ‰é’®åˆ›å»º QActionï¼Œç„¶åå°†å…¶æ‹–åŠ¨åˆ°è§†å›¾çš„èœå•ä¸­ã€‚</p>
<p>å¦‚ä½•æ‰“å¼€Action ç¼–è¾‘å™¨ï¼š<img src="https://cdn.jsdelivr.net/gh/zhishuyouling7766/myHexoBlog-Assets@main/image/2025-07-26%20133012.png" alt="å±å¹•æˆªå›¾ 2025-07-26 133012"></p>
</li>
<li><p>åœ¨Action ç¼–è¾‘å™¨ä¸­ï¼Œå³é”®Actioné€‰é¡¹ï¼Œå¯é€‰æ‹©<strong>è½¬åˆ°æ§½</strong>ï¼Œè®¾ç½®äº‹ä»¶</p>
</li>
</ol>
<hr>
<h2 id="ä¸‰ã€Action-ç¼–è¾‘å™¨å­—æ®µè¯´æ˜"><a href="#ä¸‰ã€Action-ç¼–è¾‘å™¨å­—æ®µè¯´æ˜" class="headerlink" title="ä¸‰ã€Action ç¼–è¾‘å™¨å­—æ®µè¯´æ˜"></a>ä¸‰ã€Action ç¼–è¾‘å™¨å­—æ®µè¯´æ˜</h2><table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>å¯¹åº”å±æ€§</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>æ–‡æœ¬ (T)</td>
<td><code>QAction::setText()</code></td>
<td>èœå•ä¸­æ˜¾ç¤ºçš„æ–‡å­—</td>
</tr>
<tr>
<td>å¯¹è±¡åç§° (N)</td>
<td><code>QObject::setObjectName()</code></td>
<td>åœ¨ä»£ç ä¸­è®¿é—® QAction çš„åç§°</td>
</tr>
<tr>
<td>æç¤º (Q)</td>
<td><code>QAction::setToolTip()</code></td>
<td>é¼ æ ‡æ‚¬åœæ—¶çš„æç¤ºæ–‡å­—</td>
</tr>
<tr>
<td>Icon Theme<br />Icon XDG Theme</td>
<td><code>QIcon::fromTheme()</code></td>
<td>ä»ç³»ç»Ÿå›¾æ ‡ä¸»é¢˜åŠ è½½å›¾æ ‡ï¼ˆå¸¸ç”¨äº Linuxï¼‰<br />ï¼ˆä¸æ¨èä½¿ç”¨ï¼Œéœ€è¦å®‰è£…å›¾æ ‡åº“ï¼‰</td>
</tr>
<tr>
<td>å›¾æ ‡ (I)</td>
<td><code>QAction::setIcon()</code></td>
<td>è®¾ç½®æœ¬åœ°å›¾æ ‡æ–‡ä»¶ï¼ˆå¯æ¥è‡ª èµ„æº<code>.qrc</code>ï¼‰</td>
</tr>
<tr>
<td>å¯å¤é€‰ (C)</td>
<td><code>QAction::setCheckable()</code></td>
<td>æ˜¯å¦ä¸ºå¯åˆ‡æ¢çŠ¶æ€ï¼ˆå‹¾é€‰ç±»èœå•ï¼‰</td>
</tr>
<tr>
<td>å¿«æ·æ–¹å¼ (S)</td>
<td><code>QAction::setShortcut()</code></td>
<td>è®¾ç½®å¿«æ·é”®ï¼Œå¦‚ Ctrl+S</td>
</tr>
<tr>
<td>Menu Role</td>
<td><code>QAction::setMenuRole()</code></td>
<td>èœå•è§’è‰²ï¼ˆç”¨äº macOS èœå•æ˜ å°„ï¼‰<br />ï¼ˆè¯•äº†ä¸€ä¸‹ï¼ŒBç”¨æ²¡æœ‰ï¼‰</td>
</tr>
</tbody></table>
<p>Menu Role é€‰é¡¹è¯´æ˜ï¼ˆæœŸå¾…åç»­å‘ç°è¿™ç©æ„æœ‰ä»€ä¹ˆç”¨å§ï¼‰ï¼š</p>
<ul>
<li><p><strong>NoRole</strong>ï¼šæ²¡æœ‰ç‰¹å®šè§’è‰²ï¼Œé»˜è®¤è®¾ç½®ã€‚</p>
</li>
<li><p><strong>TextHeuristicRole</strong>ï¼šåŸºäºæ–‡æœ¬å¯ç”¨åŠ¨ä½œã€‚</p>
</li>
<li><p><strong>ApplicationSpecificRole</strong>ï¼šç”¨äºåº”ç”¨ç¨‹åºç‰¹å®šçš„èœå•é¡¹è§’è‰²ã€‚</p>
</li>
<li><p><strong>AboutQtRole</strong>ï¼šå…³äº Qt çš„èœå•é¡¹ã€‚</p>
</li>
<li><p><strong>AboutRole</strong>ï¼šå…³äºåº”ç”¨ç¨‹åºçš„èœå•é¡¹ã€‚</p>
</li>
<li><p><strong>PreferencesRole</strong>ï¼šç”¨äºè®¾ç½®æˆ–åå¥½è®¾ç½®çš„èœå•é¡¹ã€‚</p>
</li>
<li><p><strong>QuitRole</strong>ï¼šé€€å‡ºåº”ç”¨ç¨‹åºçš„èœå•é¡¹ã€‚</p>
</li>
</ul>
<hr>
<h2 id="å››ã€å›¾æ ‡çŠ¶æ€è¯´æ˜ï¼ˆå›¾æ ‡-I-ä¸‹æ‹‰èœå•ï¼‰"><a href="#å››ã€å›¾æ ‡çŠ¶æ€è¯´æ˜ï¼ˆå›¾æ ‡-I-ä¸‹æ‹‰èœå•ï¼‰" class="headerlink" title="å››ã€å›¾æ ‡çŠ¶æ€è¯´æ˜ï¼ˆå›¾æ ‡ I ä¸‹æ‹‰èœå•ï¼‰"></a>å››ã€å›¾æ ‡çŠ¶æ€è¯´æ˜ï¼ˆå›¾æ ‡ I ä¸‹æ‹‰èœå•ï¼‰</h2><p>Qt æ”¯æŒä¸ºä¸åŒçŠ¶æ€è®¾ç½®ä¸åŒå›¾æ ‡ï¼š</p>
<table>
<thead>
<tr>
<th>æ˜¾ç¤ºé¡¹</th>
<th>Qt æšä¸¾å€¼</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>Normal Off</td>
<td><code>QIcon::Normal</code>, <code>QIcon::Off</code></td>
<td>é»˜è®¤çŠ¶æ€</td>
</tr>
<tr>
<td>Normal On</td>
<td><code>QIcon::Normal</code>, <code>QIcon::On</code></td>
<td>æ¿€æ´»çŠ¶æ€</td>
</tr>
<tr>
<td>Disabled Off</td>
<td><code>QIcon::Disabled</code>, <code>QIcon::Off</code></td>
<td>ç¦ç”¨çŠ¶æ€</td>
</tr>
<tr>
<td>Disabled On</td>
<td><code>QIcon::Disabled</code>, <code>QIcon::On</code></td>
<td>ç¦ç”¨çŠ¶æ€ä¸”é€‰ä¸­</td>
</tr>
<tr>
<td>Active Off</td>
<td><code>QIcon::Active</code>, <code>QIcon::Off</code></td>
<td>æ´»è·ƒçŠ¶æ€ï¼ˆä¸å¯ç‚¹å‡»ï¼‰</td>
</tr>
<tr>
<td>Active On</td>
<td><code>QIcon::Active</code>, <code>QIcon::On</code></td>
<td>æ´»è·ƒçŠ¶æ€ï¼ˆå¯ç‚¹å‡»ï¼‰</td>
</tr>
<tr>
<td>Selected Off</td>
<td><code>QIcon::Selected</code>, <code>QIcon::Off</code></td>
<td>é€‰ä¸­çŠ¶æ€ï¼ˆä¸å¯ç‚¹å‡»ï¼‰</td>
</tr>
<tr>
<td>Selected On</td>
<td><code>QIcon::Selected</code>, <code>QIcon::On</code></td>
<td>é€‰ä¸­çŠ¶æ€ï¼ˆå¯ç‚¹å‡»ï¼‰</td>
</tr>
</tbody></table>
<p>ä½¿ç”¨ <code>icon.addFile()</code> å¯ä»¥ä¸ºè¿™äº›çŠ¶æ€é…ç½®ä¸åŒå›¾æ ‡ã€‚</p>
<hr>
<h2 id="äº”ã€ä»£ç ç¤ºä¾‹"><a href="#äº”ã€ä»£ç ç¤ºä¾‹" class="headerlink" title="äº”ã€ä»£ç ç¤ºä¾‹"></a>äº”ã€ä»£ç ç¤ºä¾‹</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è·å–åŠ¨ä½œå¯¹è±¡</span></span><br><span class="line">QAction *actionOpen = ui-&gt;actionOpen;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ–‡æœ¬å’Œå›¾æ ‡</span></span><br><span class="line">actionOpen-&gt;<span class="built_in">setText</span>(<span class="string">&quot;Open File&quot;</span>);</span><br><span class="line">actionOpen-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;:/icons/open.png&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å¿«æ·é”®</span></span><br><span class="line">actionOpen-&gt;<span class="built_in">setShortcut</span>(<span class="built_in">QKeySequence</span>(<span class="string">&quot;Ctrl+O&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºå¯é€‰ä¸­çŠ¶æ€</span></span><br><span class="line">actionOpen-&gt;<span class="built_in">setCheckable</span>(<span class="literal">true</span>);</span><br><span class="line">actionOpen-&gt;<span class="built_in">setChecked</span>(<span class="literal">false</span>);  <span class="comment">// åˆå§‹çŠ¶æ€ä¸ºæœªé€‰ä¸­</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿æ¥æ§½å‡½æ•°</span></span><br><span class="line"><span class="built_in">connect</span>(actionOpen, &amp;QAction::triggered, <span class="keyword">this</span>, &amp;MainWindow::openFile);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å¯ç”¨æ€§å’Œå¯è§æ€§</span></span><br><span class="line">actionOpen-&gt;<span class="built_in">setEnabled</span>(<span class="literal">true</span>);    <span class="comment">// å¯ç”¨</span></span><br><span class="line">actionOpen-&gt;<span class="built_in">setVisible</span>(<span class="literal">true</span>);    <span class="comment">// æ˜¾ç¤º</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰‹åŠ¨è§¦å‘æ“ä½œï¼ˆæ¯”å¦‚åœ¨æŸäº›æ¡ä»¶ä¸‹è‡ªåŠ¨æ‰§è¡Œï¼‰</span></span><br><span class="line">actionOpen-&gt;<span class="built_in">trigger</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°† QAction æ·»åŠ åˆ°èœå•å’Œå·¥å…·æ </span></span><br><span class="line">ui-&gt;menuFile-&gt;<span class="built_in">addAction</span>(actionOpen);   <span class="comment">// æ·»åŠ åˆ°èœå•</span></span><br><span class="line">ui-&gt;toolBar-&gt;<span class="built_in">addAction</span>(actionOpen);    <span class="comment">// æ·»åŠ åˆ°å·¥å…·æ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®çˆ¶å¯¹è±¡ï¼ˆå¦‚æœéœ€è¦ï¼Œé€šå¸¸ç”± Qt Designer è‡ªåŠ¨å¤„ç†ï¼‰</span></span><br><span class="line">actionOpen-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å…­ã€èœå•ä¸å·¥å…·æ å…±ç”¨-QAction"><a href="#å…­ã€èœå•ä¸å·¥å…·æ å…±ç”¨-QAction" class="headerlink" title="å…­ã€èœå•ä¸å·¥å…·æ å…±ç”¨ QAction"></a>å…­ã€èœå•ä¸å·¥å…·æ å…±ç”¨ QAction</h2><p>ã€åˆ›å»ºçš„ QAction å¯ä»¥åŒæ—¶æ·»åŠ åˆ°èœå•ä¸å·¥å…·æ ä¸­ã€‘<br>å¯ä»¥ä»Actionç¼–è¾‘å™¨ä¸­å°†ç°æœ‰çš„Actionæ‹–æ‹½è‡³å¤šä¸ªèœå•æ ï¼Œä¹Ÿå¯ä½¿ç”¨ä»£ç æ“ä½œï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">toolBar-&gt;<span class="built_in">addAction</span>(ui-&gt;actionOpen);</span><br><span class="line">menuFile-&gt;<span class="built_in">addAction</span>(ui-&gt;actionOpen);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ä¸ƒã€æ¨èèµ„æºç®¡ç†æ–¹å¼"><a href="#ä¸ƒã€æ¨èèµ„æºç®¡ç†æ–¹å¼" class="headerlink" title="ä¸ƒã€æ¨èèµ„æºç®¡ç†æ–¹å¼"></a>ä¸ƒã€æ¨èèµ„æºç®¡ç†æ–¹å¼</h2><ul>
<li>å›¾æ ‡èµ„æºæ”¾å…¥ Qt Resource File (<code>.qrc</code>)</li>
<li>QAction å‘½åç»Ÿä¸€æ ¼å¼ï¼š<code>action+åŠŸèƒ½å</code>ï¼ˆå¦‚ <code>actionSave</code>ï¼‰</li>
<li>ä½¿ç”¨ QAction å®ç°ç»Ÿä¸€å¿«æ·æ–¹å¼ã€å›¾æ ‡ã€çŠ¶æ€åˆ‡æ¢</li>
</ul>
<hr>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul>
<li><a href="https://doc.qt.io/qt-5/qaction.html">QAction å®˜æ–¹æ–‡æ¡£ (è‹±æ–‡)</a></li>
<li><a href="https://doc.qt.io/qt-5/qmenu.html">QMenu å®˜æ–¹æ–‡æ¡£</a></li>
</ul>
]]></content>
      <categories>
        <category>QT_UIé…ç½®</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>QT_UI</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt for Android ä½¿ç”¨ JNI çš„å®Œæ•´æŒ‡å—</title>
    <url>/2025/03/09/qt_android_jni/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æŒ‡å—è®°å½•äº†å¦‚ä½•åœ¨ Qt é¡¹ç›®ä¸­é€šè¿‡ JNIï¼ˆJava Native Interfaceï¼‰è°ƒç”¨ Android åŸç”Ÿ Java æ–¹æ³•ï¼Œé€‚ç”¨äºéœ€è¦è®¿é—®ç³»ç»ŸåŠŸèƒ½ï¼ˆå¦‚ U ç›˜è¯»å†™ã€å¹¿æ’­ã€Activity å¯åŠ¨ç­‰ï¼‰çš„åœºæ™¯ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ“-é¡¹ç›®ç»“æ„å»ºè®®"><a href="#ğŸ“-é¡¹ç›®ç»“æ„å»ºè®®" class="headerlink" title="ğŸ“ é¡¹ç›®ç»“æ„å»ºè®®"></a>ğŸ“ é¡¹ç›®ç»“æ„å»ºè®®</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">your_qt_project/</span><br><span class="line">â”œâ”€â”€ main.cpp</span><br><span class="line">â”œâ”€â”€ your_qt_project.pro</span><br><span class="line">â”œâ”€â”€ android/</span><br><span class="line">â”‚   â”œâ”€â”€ AndroidManifest.xml</span><br><span class="line">â”‚   â””â”€â”€ src/org/qtproject/example/activityhandler/</span><br><span class="line">â”‚       â”œâ”€â”€ CustomActivity1.java</span><br><span class="line">â”‚       â”œâ”€â”€ CustomActivity2.java</span><br><span class="line">â”‚       â””â”€â”€ CustomActivity3.java</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âš™ï¸-pro-æ–‡ä»¶é…ç½®"><a href="#âš™ï¸-pro-æ–‡ä»¶é…ç½®" class="headerlink" title="âš™ï¸ .pro æ–‡ä»¶é…ç½®"></a>âš™ï¸ <code>.pro</code> æ–‡ä»¶é…ç½®</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    QT += androidextras  # å¯ç”¨ Qt å°è£…çš„ JNI æ”¯æŒæ¨¡å—</span><br><span class="line"></span><br><span class="line">    ANDROID_PACKAGE_SOURCE_DIR = $$PWD/android  # ä½¿ç”¨è‡ªå®šä¹‰ Android å·¥ç¨‹ç›®å½•</span><br><span class="line"></span><br><span class="line">    # å¯é€‰ï¼šé™„åŠ æ‰“åŒ… Java ä¸ Manifest æ–‡ä»¶ï¼Œæ–¹ä¾¿ IDE æ˜¾ç¤º</span><br><span class="line">    DISTFILES +=         android/AndroidManifest.xml         android/src/org/qtproject/example/activityhandler/CustomActivity1.java         android/src/org/qtproject/example/activityhandler/CustomActivity2.java         android/src/org/qtproject/example/activityhandler/CustomActivity3.java</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“¦-Java-ç±»ç¤ºä¾‹"><a href="#ğŸ“¦-Java-ç±»ç¤ºä¾‹" class="headerlink" title="ğŸ“¦ Java ç±»ç¤ºä¾‹"></a>ğŸ“¦ Java ç±»ç¤ºä¾‹</h2><p><strong>CustomActivity1.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.qtproject.example.activityhandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomActivity1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">helloFromJava</span><span class="params">()</span> &#123;</span><br><span class="line">        Log.d(<span class="string">&quot;JNI&quot;</span>, <span class="string">&quot;Hello from Java!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getNtpServer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;pool.ntp.org&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">notifyCpp</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="ğŸ§©-Qt-ä¸­è°ƒç”¨-Java-çš„å¤šç§æ–¹å¼æ€»ç»“"><a href="#ğŸ§©-Qt-ä¸­è°ƒç”¨-Java-çš„å¤šç§æ–¹å¼æ€»ç»“" class="headerlink" title="ğŸ§© Qt ä¸­è°ƒç”¨ Java çš„å¤šç§æ–¹å¼æ€»ç»“"></a>ğŸ§© Qt ä¸­è°ƒç”¨ Java çš„å¤šç§æ–¹å¼æ€»ç»“</h1><h2 id="âœ…-1-è°ƒç”¨-Java-é™æ€æ–¹æ³•ï¼ˆæ¨èï¼‰"><a href="#âœ…-1-è°ƒç”¨-Java-é™æ€æ–¹æ³•ï¼ˆæ¨èï¼‰" class="headerlink" title="âœ… 1. è°ƒç”¨ Java é™æ€æ–¹æ³•ï¼ˆæ¨èï¼‰"></a>âœ… 1. è°ƒç”¨ Java é™æ€æ–¹æ³•ï¼ˆæ¨èï¼‰</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="attribute">QAndroidJniObject</span>::callStaticMethod&lt;<span class="keyword">void</span>&gt;(</span><br><span class="line">    <span class="string">&quot;org/qtproject/example/activityhandler/CustomActivity1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;helloFromJava&quot;</span>,</span><br><span class="line">    <span class="string">&quot;()V&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>é€‚åˆè°ƒç”¨ Java çš„ <code>public static</code> æ–¹æ³•ã€‚</li>
<li>æ–¹æ³•ç­¾åï¼š<code>()V</code> è¡¨ç¤ºæ— å‚æ— è¿”å›ã€‚</li>
</ul>
<hr>
<h2 id="âœ…-2-åˆ›å»º-Java-å¯¹è±¡å¹¶è°ƒç”¨å®ä¾‹æ–¹æ³•"><a href="#âœ…-2-åˆ›å»º-Java-å¯¹è±¡å¹¶è°ƒç”¨å®ä¾‹æ–¹æ³•" class="headerlink" title="âœ… 2. åˆ›å»º Java å¯¹è±¡å¹¶è°ƒç”¨å®ä¾‹æ–¹æ³•"></a>âœ… 2. åˆ›å»º Java å¯¹è±¡å¹¶è°ƒç”¨å®ä¾‹æ–¹æ³•</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QAndroidJniObject javaObj(<span class="string">&quot;org/qtproject/example/activityhandler/CustomActivity2&quot;</span>);</span><br><span class="line">javaObj.callMethod&lt;<span class="keyword">void</span>&gt;(<span class="string">&quot;nonStaticMethodName&quot;</span>, <span class="string">&quot;()V&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>é€‚åˆ Java çš„éé™æ€æ–¹æ³•ã€‚</li>
<li>æ”¯æŒå¤šæ¬¡äº¤äº’ä½¿ç”¨ã€‚</li>
</ul>
<hr>
<h2 id="âœ…-3-è°ƒç”¨å¸¦å‚æ•°çš„æ–¹æ³•"><a href="#âœ…-3-è°ƒç”¨å¸¦å‚æ•°çš„æ–¹æ³•" class="headerlink" title="âœ… 3. è°ƒç”¨å¸¦å‚æ•°çš„æ–¹æ³•"></a>âœ… 3. è°ƒç”¨å¸¦å‚æ•°çš„æ–¹æ³•</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QAndroidJniObject param = <span class="attribute">QAndroidJniObject</span>::fromString(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="attribute">QAndroidJniObject</span>::callStaticMethod&lt;<span class="keyword">void</span>&gt;(</span><br><span class="line">    <span class="string">&quot;org/qtproject/example/activityhandler/CustomActivity1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;printMessage&quot;</span>,</span><br><span class="line">    <span class="string">&quot;(Ljava/lang/String;)V&quot;</span>,</span><br><span class="line">    param.object&lt;jstring&gt;()</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>(Ljava/lang/String;)V</code> è¡¨ç¤ºæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œæ— è¿”å›å€¼ã€‚</li>
<li>å‚æ•°å’Œè¿”å›å€¼çš„ JNI ç­¾åå¯å‚è€ƒ JNI æ–‡æ¡£ã€‚</li>
</ul>
<hr>
<h2 id="âœ…-4-è·å–-Java-å¯¹è±¡è¿”å›å€¼ï¼ˆå¦‚-Stringï¼‰"><a href="#âœ…-4-è·å–-Java-å¯¹è±¡è¿”å›å€¼ï¼ˆå¦‚-Stringï¼‰" class="headerlink" title="âœ… 4. è·å– Java å¯¹è±¡è¿”å›å€¼ï¼ˆå¦‚ Stringï¼‰"></a>âœ… 4. è·å– Java å¯¹è±¡è¿”å›å€¼ï¼ˆå¦‚ Stringï¼‰</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QAndroidJniObject result = <span class="attribute">QAndroidJniObject</span>::callStaticObjectMethod(</span><br><span class="line">    <span class="string">&quot;org/qtproject/example/activityhandler/CustomActivity&quot;</span>,</span><br><span class="line">    <span class="string">&quot;getNtpServer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;()Ljava/lang/String;&quot;</span></span><br><span class="line">);</span><br><span class="line">QString str = result.toString();</span><br></pre></td></tr></table></figure>

<ul>
<li>é€‚ç”¨äºè¿”å› Java å¯¹è±¡çš„æƒ…å†µï¼Œå¦‚ <code>String</code>ã€‚</li>
<li>è¿”å›å€¼ä½¿ç”¨ <code>QAndroidJniObject</code> æ¥æ”¶å¹¶è½¬ä¸º QStringã€‚</li>
</ul>
<hr>
<h2 id="âœ…-5-ä½¿ç”¨-QAndroidJniEnvironment-è¿›è¡Œåº•å±‚-JNI-è°ƒç”¨"><a href="#âœ…-5-ä½¿ç”¨-QAndroidJniEnvironment-è¿›è¡Œåº•å±‚-JNI-è°ƒç”¨" class="headerlink" title="âœ… 5. ä½¿ç”¨ QAndroidJniEnvironment è¿›è¡Œåº•å±‚ JNI è°ƒç”¨"></a>âœ… 5. ä½¿ç”¨ QAndroidJniEnvironment è¿›è¡Œåº•å±‚ JNI è°ƒç”¨</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QAndroidJniEnvironment env;</span><br><span class="line">jclass clazz = env-&gt;</span><br><span class="line">    FindClass(<span class="string">&quot;org/qtproject/example/activityhandler/CustomActivity1&quot;</span>);</span><br><span class="line">jmethodID methodId = env-&gt;GetStaticMethodID(clazz, <span class="string">&quot;helloFromJava&quot;</span>, <span class="string">&quot;()V&quot;</span>);</span><br><span class="line">env-&gt;CallStaticVoidMethod(clazz, methodId);</span><br></pre></td></tr></table></figure>

<ul>
<li>é€‚åˆé«˜çº§åœºæ™¯ï¼šå¤æ‚å‚æ•°æ§åˆ¶ã€å¼‚å¸¸å¤„ç†ã€‚</li>
<li>å¯ç»“åˆåŸç”Ÿ JNI èƒ½åŠ›ä½¿ç”¨ã€‚</li>
</ul>
<hr>
<h2 id="âœ…-6-Java-è°ƒç”¨-C-ï¼ˆNative-å›è°ƒï¼‰"><a href="#âœ…-6-Java-è°ƒç”¨-C-ï¼ˆNative-å›è°ƒï¼‰" class="headerlink" title="âœ… 6. Java è°ƒç”¨ C++ï¼ˆNative å›è°ƒï¼‰"></a>âœ… 6. Java è°ƒç”¨ C++ï¼ˆNative å›è°ƒï¼‰</h2><p>Java ä¾§ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomActivity1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">notifyCpp</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>C++ ä¾§ï¼š</p>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">extern <span class="string">&quot;C&quot;</span> JNIEXPORT <span class="keyword">void</span> JNICALL</span><br><span class="line">Java_org_qtproject_example_activityhandler_CustomActivity1_notifyCpp(JNIEnv *env, jobject obj) &#123;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">&quot;Java è°ƒç”¨äº† C++&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Java ä½¿ç”¨ <code>native</code> å…³é”®å­—æ³¨å†Œæœ¬åœ°å‡½æ•°ã€‚</li>
<li>Qt ä½¿ç”¨ JNIEXPORT æä¾› C++ å›è°ƒå®ç°ã€‚</li>
</ul>
<hr>
<h2 id="ğŸ”„-callStaticMethod-ä¸-callStaticObjectMethod-åŒºåˆ«è¯¦è§£"><a href="#ğŸ”„-callStaticMethod-ä¸-callStaticObjectMethod-åŒºåˆ«è¯¦è§£" class="headerlink" title="ğŸ”„ callStaticMethod&lt;T&gt;() ä¸ callStaticObjectMethod() åŒºåˆ«è¯¦è§£"></a>ğŸ”„ <code>callStaticMethod&lt;T&gt;()</code> ä¸ <code>callStaticObjectMethod()</code> åŒºåˆ«è¯¦è§£</h2><h3 id="callStaticMethod-ï¼šç”¨äºè¿”å›åŸºæœ¬ç±»å‹"><a href="#callStaticMethod-ï¼šç”¨äºè¿”å›åŸºæœ¬ç±»å‹" class="headerlink" title="callStaticMethod&lt;T&gt;()ï¼šç”¨äºè¿”å›åŸºæœ¬ç±»å‹"></a><code>callStaticMethod&lt;T&gt;()</code>ï¼šç”¨äºè¿”å›åŸºæœ¬ç±»å‹</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> result = <span class="attribute">QAndroidJniObject</span>::callStaticMethod&lt;jint&gt;(</span><br><span class="line">    <span class="string">&quot;org/example/MyJavaClass&quot;</span>,</span><br><span class="line">    <span class="string">&quot;getCount&quot;</span>,</span><br><span class="line">    <span class="string">&quot;()I&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="callStaticObjectMethod-ï¼šç”¨äºè¿”å›-Java-å¯¹è±¡ç±»å‹"><a href="#callStaticObjectMethod-ï¼šç”¨äºè¿”å›-Java-å¯¹è±¡ç±»å‹" class="headerlink" title="callStaticObjectMethod()ï¼šç”¨äºè¿”å› Java å¯¹è±¡ç±»å‹"></a><code>callStaticObjectMethod()</code>ï¼šç”¨äºè¿”å› Java å¯¹è±¡ç±»å‹</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QAndroidJniObject result = <span class="attribute">QAndroidJniObject</span>::callStaticObjectMethod(</span><br><span class="line">    <span class="string">&quot;org/qtproject/example/activityhandler/CustomActivity&quot;</span>,</span><br><span class="line">    <span class="string">&quot;getNtpServer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;()Ljava/lang/String;&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="ğŸ§ -å¯¹æ¯”æ€»ç»“ï¼š"><a href="#ğŸ§ -å¯¹æ¯”æ€»ç»“ï¼š" class="headerlink" title="ğŸ§  å¯¹æ¯”æ€»ç»“ï¼š"></a>ğŸ§  å¯¹æ¯”æ€»ç»“ï¼š</h3><table>
<thead>
<tr>
<th>æ¯”è¾ƒé¡¹</th>
<th><code>callStaticMethod&lt;T&gt;()</code></th>
<th><code>callStaticObjectMethod()</code></th>
</tr>
</thead>
<tbody><tr>
<td>ä½¿ç”¨åœºæ™¯</td>
<td>Java é™æ€æ–¹æ³•è¿”å› <strong>åŸºæœ¬ç±»å‹</strong></td>
<td>Java é™æ€æ–¹æ³•è¿”å› <strong>å¯¹è±¡ç±»å‹</strong></td>
</tr>
<tr>
<td>è¿”å›ç±»å‹</td>
<td>C++ åŸºç¡€ç±»å‹ï¼Œå¦‚ <code>int</code>, <code>bool</code>, <code>void</code></td>
<td><code>QAndroidJniObject</code></td>
</tr>
<tr>
<td>JNI æ–¹æ³•ç­¾å</td>
<td>å¦‚ï¼š<code>()I</code>ã€<code>(I)V</code> ç­‰</td>
<td>å¦‚ï¼š<code>()Ljava/lang/String;</code></td>
</tr>
<tr>
<td>è·å–è¿”å›å€¼</td>
<td>ç›´æ¥ä½¿ç”¨å˜é‡</td>
<td>éœ€ <code>.toString()</code> æˆ– <code>.object&lt;&gt;()</code> æå–</td>
</tr>
<tr>
<td>å¸¸è§å¯¹è±¡ç±»å‹</td>
<td>ä¸é€‚ç”¨</td>
<td><code>String</code>, <code>List</code>, <code>è‡ªå®šä¹‰ç±»</code> ç­‰</td>
</tr>
</tbody></table>
<hr>
<h2 id="âœ…-AndroidManifest-xml-é…ç½®"><a href="#âœ…-AndroidManifest-xml-é…ç½®" class="headerlink" title="âœ… AndroidManifest.xml é…ç½®"></a>âœ… AndroidManifest.xml é…ç½®</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">&quot;org.qtproject.example.activityhandler&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:label</span>=<span class="string">&quot;JNIExampleApp&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.CustomActivity1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.CustomActivity2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.CustomActivity3&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“Œ-æ³¨æ„äº‹é¡¹"><a href="#ğŸ“Œ-æ³¨æ„äº‹é¡¹" class="headerlink" title="ğŸ“Œ æ³¨æ„äº‹é¡¹"></a>ğŸ“Œ æ³¨æ„äº‹é¡¹</h2><ul>
<li>Java ç±»å¿…é¡»æ”¾åœ¨ <code>android/src/...</code> è·¯å¾„ä¸‹ï¼ŒåŒ…åéœ€ä¸è·¯å¾„ä¸€è‡´ã€‚</li>
<li>Java æ–¹æ³•å¿…é¡»ä¸º <code>public static</code> æ‰èƒ½è¢« <code>QAndroidJniObject::callStaticMethod</code> è°ƒç”¨ã€‚</li>
<li>æ–¹æ³•ç­¾å <code>&quot;()V&quot;</code> è¡¨ç¤ºæ— å‚æ•°ã€æ— è¿”å›å€¼ï¼›ç­¾åå¿…é¡»ä¸ Java æ–¹æ³•åŒ¹é…ã€‚</li>
<li>ä½¿ç”¨ <code>QAndroidJniObject::fromString</code> åˆ›å»º Java å­—ç¬¦ä¸²ã€‚</li>
<li>ä½¿ç”¨ <code>object&lt;jstring&gt;()</code>ã€<code>toString()</code> ç­‰æ–¹å¼è¿›è¡Œç±»å‹è½¬æ¢ã€‚</li>
</ul>
<hr>
<h2 id="ğŸ› -æ„å»ºä¸è¿è¡Œ"><a href="#ğŸ› -æ„å»ºä¸è¿è¡Œ" class="headerlink" title="ğŸ›  æ„å»ºä¸è¿è¡Œ"></a>ğŸ›  æ„å»ºä¸è¿è¡Œ</h2><ol>
<li>æ„å»ºé¡¹ç›®ï¼ˆå»ºè®®å…ˆæ¸…é™¤å†æ„å»ºï¼‰</li>
<li>è¿æ¥ Android è®¾å¤‡</li>
<li>è¿è¡Œé¡¹ç›®ï¼ŒæŸ¥çœ‹ logcat è¾“å‡ºæ˜¯å¦è°ƒç”¨æˆåŠŸ</li>
</ol>
<hr>
<h2 id="ğŸ“š-å»¶ä¼¸é˜…è¯»"><a href="#ğŸ“š-å»¶ä¼¸é˜…è¯»" class="headerlink" title="ğŸ“š å»¶ä¼¸é˜…è¯»"></a>ğŸ“š å»¶ä¼¸é˜…è¯»</h2><ul>
<li><a href="https://doc.qt.io/qt-5/qtandroidextras-index.html">Qt Android Extras å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://developer.android.com/training/articles/perf-jni#native-calls">JNI æ–¹æ³•ç­¾åè¡¨</a></li>
</ul>
]]></content>
      <categories>
        <category>QTå®ä¾‹</category>
      </categories>
      <tags>
        <tag>QT for Android</tag>
        <tag>QT</tag>
      </tags>
  </entry>
  <entry>
    <title>AndroidManifest.xml é…ç½®è¯¦è§£</title>
    <url>/2025/03/03/qt_android_manifest_AndroidManifest%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<blockquote>
<p>ä»¥ä¸‹æ˜¯ Qt for Android åº”ç”¨ä¸­ <code>AndroidManifest.xml</code> æ–‡ä»¶çš„å®Œæ•´é…ç½®åŠè¯¦ç»†æ³¨é‡Šï¼Œé€‚ç”¨äºè‡ªå®šä¹‰æƒé™ã€æ³¨å†Œ Java æ´»åŠ¨ï¼ˆActivityï¼‰ã€å¹¿æ’­æ¥æ”¶å™¨ä»¥åŠåŠ è½½ Qt æ¨¡å—èµ„æºç­‰åœºæ™¯ã€‚</p>
</blockquote>
<hr>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">&quot;org.qtproject.example.activityhandler&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:versionName</span>=<span class="string">&quot;-- %%INSERT_VERSION_NAME%% --&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:versionCode</span>=<span class="string">&quot;-- %%INSERT_VERSION_CODE%% --&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:installLocation</span>=<span class="string">&quot;auto&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>package</code>ï¼šä½ çš„åº”ç”¨ Java åŒ…å</li>
<li><code>versionName</code>&#x2F;<code>versionCode</code>ï¼šæ„å»ºå·¥å…·è‡ªåŠ¨æ›¿æ¢ç‰ˆæœ¬</li>
<li><code>installLocation</code>ï¼šAPK é»˜è®¤å®‰è£…ä½ç½®ï¼ˆè‡ªåŠ¨åˆ¤æ–­ï¼‰</li>
</ul>
<hr>
<h2 id="ğŸ”-æƒé™å£°æ˜"><a href="#ğŸ”-æƒé™å£°æ˜" class="headerlink" title="ğŸ” æƒé™å£°æ˜"></a>ğŸ” æƒé™å£°æ˜</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.FOREGROUND_SERVICE&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.CONNECTIVITY_INTERNAL&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_CHECKIN_PROPERTIES&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å£°æ˜äº†ç½‘ç»œè®¿é—®ã€å­˜å‚¨è®¿é—®ã€ç³»ç»Ÿæ‚¬æµ®çª—ã€åå°æœåŠ¡ç­‰å¤šä¸ªæƒé™</li>
<li><code>MANAGE_EXTERNAL_STORAGE</code> å±äºé«˜æƒé™ï¼ŒAndroid 11+ éœ€ç‰¹æ®Šæˆæƒ</li>
<li><code>CONNECTIVITY_INTERNAL</code> ä¸ºç³»ç»Ÿæƒé™ï¼Œæ™®é€šåº”ç”¨è¯·è°¨æ…ä½¿ç”¨</li>
</ul>
<hr>
<h2 id="ğŸ‘®-è‡ªå®šä¹‰æƒé™"><a href="#ğŸ‘®-è‡ªå®šä¹‰æƒé™" class="headerlink" title="ğŸ‘® è‡ªå®šä¹‰æƒé™"></a>ğŸ‘® è‡ªå®šä¹‰æƒé™</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.myapp.PERMISSION&quot;</span> <span class="attr">android:protectionLevel</span>=<span class="string">&quot;signature&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ç”¨äºä¿æŠ¤æŸäº›ç»„ä»¶ï¼ˆå¦‚å¹¿æ’­ã€æœåŠ¡ï¼‰åªèƒ½è¢«ç­¾ååº”ç”¨è®¿é—®</li>
</ul>
<hr>
<h2 id="ğŸ“±-å±å¹•é€‚é…"><a href="#ğŸ“±-å±å¹•é€‚é…" class="headerlink" title="ğŸ“± å±å¹•é€‚é…"></a>ğŸ“± å±å¹•é€‚é…</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">supports-screens</span> <span class="attr">android:largeScreens</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:normalScreens</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:anyDensity</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:smallScreens</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ§©-åº”ç”¨é…ç½®åŠ-Qt-Activity"><a href="#ğŸ§©-åº”ç”¨é…ç½®åŠ-Qt-Activity" class="headerlink" title="ğŸ§© åº”ç”¨é…ç½®åŠ Qt Activity"></a>ğŸ§© åº”ç”¨é…ç½®åŠ Qt Activity</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;org.qtproject.qt5.android.bindings.QtApplication&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:hardwareAccelerated</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:label</span>=<span class="string">&quot;-- %%INSERT_APP_NAME%% --&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:extractNativeLibs</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨ Qt å®˜æ–¹çš„ <code>QtApplication</code> ç±»</li>
<li>å¯ç”¨ç¡¬ä»¶åŠ é€Ÿï¼Œè§£å‹ native åº“åˆ°å†…éƒ¨ç›®å½•</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;org.qtproject.example.activityhandler.JBmsActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:launchMode</span>=<span class="string">&quot;singleTop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:screenOrientation</span>=<span class="string">&quot;unspecified&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:windowSoftInputMode</span>=<span class="string">&quot;adjustResize&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:configChanges</span>=<span class="string">&quot;...&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸» Activityï¼Œä¸º Qt åº”ç”¨å…¥å£</li>
<li>é…ç½®äº† UIã€å­—ä½“ã€è¾“å…¥æ³•ç­‰é‡è½½é€‰é¡¹</li>
<li>å«å¤šæ¡ <code>meta-data</code>ï¼Œå‘ŠçŸ¥ Qt åŠ è½½å“ªäº›åº“å’Œèµ„æº</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å°†è¯¥ Activity ä½œä¸º Launcher ä¸»å…¥å£</li>
</ul>
<hr>
<h2 id="ğŸ“‚-Qt-æ‰€éœ€èµ„æºå’Œå‚æ•°"><a href="#ğŸ“‚-Qt-æ‰€éœ€èµ„æºå’Œå‚æ•°" class="headerlink" title="ğŸ“‚ Qt æ‰€éœ€èµ„æºå’Œå‚æ•°"></a>ğŸ“‚ Qt æ‰€éœ€èµ„æºå’Œå‚æ•°</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.lib_name&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;-- %%INSERT_APP_LIB_NAME%% --&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.qt_sources_resource_id&quot;</span> <span class="attr">android:resource</span>=<span class="string">&quot;@array/qt_sources&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.bundled_libs_resource_id&quot;</span> <span class="attr">android:resource</span>=<span class="string">&quot;@array/bundled_libs&quot;</span>/&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<ul>
<li>æ‰€æœ‰ Qt åº”ç”¨è¿è¡Œæ—¶å¿…é¡»åŒ…å«çš„èµ„æºå¼•ç”¨</li>
<li>ä½¿ç”¨æ„å»ºå·¥å…·åŠ¨æ€æ›¿æ¢</li>
</ul>
<hr>
<h2 id="ğŸŒ—-Splashã€æ ·å¼ã€åå°è¿è¡Œé…ç½®"><a href="#ğŸŒ—-Splashã€æ ·å¼ã€åå°è¿è¡Œé…ç½®" class="headerlink" title="ğŸŒ— Splashã€æ ·å¼ã€åå°è¿è¡Œé…ç½®"></a>ğŸŒ— Splashã€æ ·å¼ã€åå°è¿è¡Œé…ç½®</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.extract_android_style&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;minimal&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.background_running&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>minimal</code> æ ·å¼æå–é€‚ç”¨äº QMLï¼ˆControls 2ï¼‰æ›´å¿«æ›´è½»é‡</li>
<li>ç¦æ­¢åº”ç”¨åå°è¿è¡Œé¿å…å´©æºƒ</li>
</ul>
<hr>
<h2 id="ğŸ‘¥-å…¶ä»–è‡ªå®šä¹‰-Activity"><a href="#ğŸ‘¥-å…¶ä»–è‡ªå®šä¹‰-Activity" class="headerlink" title="ğŸ‘¥ å…¶ä»–è‡ªå®šä¹‰ Activity"></a>ğŸ‘¥ å…¶ä»–è‡ªå®šä¹‰ Activity</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.CustomActivity&quot;</span> <span class="attr">android:process</span>=<span class="string">&quot;:custom_activity&quot;</span> <span class="attr">...</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.WriteToUsbActivity&quot;</span> <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span> <span class="attr">...</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>CustomActivity</code> å¯ç”¨äºç‹¬ç«‹è¿›ç¨‹æ‰©å±•åŠŸèƒ½</li>
<li><code>WriteToUsbActivity</code> ç”¨äº USB ç›¸å…³äº¤äº’ï¼Œä¸å¯¼å‡º</li>
</ul>
<hr>
<h2 id="ğŸ“¡-å¯åŠ¨å¹¿æ’­æ¥æ”¶å™¨"><a href="#ğŸ“¡-å¯åŠ¨å¹¿æ’­æ¥æ”¶å™¨" class="headerlink" title="ğŸ“¡ å¯åŠ¨å¹¿æ’­æ¥æ”¶å™¨"></a>ğŸ“¡ å¯åŠ¨å¹¿æ’­æ¥æ”¶å™¨</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">receiver</span> <span class="attr">android:name</span>=<span class="string">&quot;.BootReceiver&quot;</span> <span class="attr">android:enabled</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:permission</span>=<span class="string">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span> <span class="attr">android:priority</span>=<span class="string">&quot;1000&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.BOOT_COMPLETED&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ³¨å†Œå¼€æœºå¯åŠ¨å¹¿æ’­ç›‘å¬å™¨</li>
</ul>
<hr>
<h2 id="âœ…-æ³¨æ„äº‹é¡¹"><a href="#âœ…-æ³¨æ„äº‹é¡¹" class="headerlink" title="âœ… æ³¨æ„äº‹é¡¹"></a>âœ… æ³¨æ„äº‹é¡¹</h2><ul>
<li>æ‰€æœ‰è·¯å¾„éœ€ä¸ Java åŒ…ç»“æ„ä¸€è‡´</li>
<li><code>%%INSERT_...%%</code> å­—æ®µç”± Qt æ„å»ºæ—¶è‡ªåŠ¨æ›¿æ¢ï¼Œä¸è¦æ‰‹åŠ¨ä¿®æ”¹</li>
<li>å¦‚æœç›®æ ‡ Android ç‰ˆæœ¬ â‰¥ 11ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ä½œç”¨åŸŸå­˜å‚¨ + SAF æ›¿ä»£è€çš„å­˜å‚¨æƒé™</li>
</ul>
<hr>
<h1 id="æœ€ç»ˆå®Œæ•´å®ä¾‹ï¼š"><a href="#æœ€ç»ˆå®Œæ•´å®ä¾‹ï¼š" class="headerlink" title="æœ€ç»ˆå®Œæ•´å®ä¾‹ï¼š"></a>æœ€ç»ˆå®Œæ•´å®ä¾‹ï¼š</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">package</span>=<span class="string">&quot;org.qtproject.example.activityhandler&quot;</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="attr">android:versionName</span>=<span class="string">&quot;-- %%INSERT_VERSION_NAME%% --&quot;</span> <span class="attr">android:versionCode</span>=<span class="string">&quot;-- %%INSERT_VERSION_CODE%% --&quot;</span> <span class="attr">android:installLocation</span>=<span class="string">&quot;auto&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--android:sharedUserId=&quot;android.uid.system&quot;--&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- The following comment will be replaced upon deployment with default permissions based on the dependencies of the application.</span></span><br><span class="line"><span class="comment">         Remove the comment if you do not require these default permissions. --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- %%INSERT_PERMISSIONS --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- The following comment will be replaced upon deployment with default features based on the dependencies of the application.</span></span><br><span class="line"><span class="comment">         Remove the comment if you do not require these default features. --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- %%INSERT_FEATURES --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.FOREGROUND_SERVICE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.CONNECTIVITY_INTERNAL&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.myapp.PERMISSION&quot;</span> <span class="attr">android:protectionLevel</span>=<span class="string">&quot;signature&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">supports-screens</span> <span class="attr">android:largeScreens</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:normalScreens</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:anyDensity</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:smallScreens</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:hardwareAccelerated</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;org.qtproject.qt5.android.bindings.QtApplication&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;-- %%INSERT_APP_NAME%% --&quot;</span> <span class="attr">android:extractNativeLibs</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:configChanges</span>=<span class="string">&quot;orientation|uiMode|screenLayout|screenSize|smallestScreenSize|layoutDirection|locale|fontScale|keyboard|keyboardHidden|navigation|mcc|mnc|density&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;org.qtproject.example.activityhandler.JBmsActivity&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;-- %%INSERT_APP_NAME%% --&quot;</span> <span class="attr">android:screenOrientation</span>=<span class="string">&quot;unspecified&quot;</span> <span class="attr">android:launchMode</span>=<span class="string">&quot;singleTop&quot;</span> <span class="attr">android:windowSoftInputMode</span>=<span class="string">&quot;adjustResize&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Application arguments --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- meta-data android:name=&quot;android.app.arguments&quot; android:value=&quot;arg1 arg2 arg3&quot;/ --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Application arguments --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.lib_name&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;-- %%INSERT_APP_LIB_NAME%% --&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.qt_sources_resource_id&quot;</span> <span class="attr">android:resource</span>=<span class="string">&quot;@array/qt_sources&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.repository&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;default&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.qt_libs_resource_id&quot;</span> <span class="attr">android:resource</span>=<span class="string">&quot;@array/qt_libs&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.bundled_libs_resource_id&quot;</span> <span class="attr">android:resource</span>=<span class="string">&quot;@array/bundled_libs&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Deploy Qt libs as part of package --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.bundle_local_qt_libs&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;-- %%BUNDLE_LOCAL_QT_LIBS%% --&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Run with local libs --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.use_local_qt_libs&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;-- %%USE_LOCAL_QT_LIBS%% --&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.libs_prefix&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;/data/local/tmp/qt/&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.load_local_libs_resource_id&quot;</span> <span class="attr">android:resource</span>=<span class="string">&quot;@array/load_local_libs&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.load_local_jars&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;-- %%INSERT_LOCAL_JARS%% --&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.static_init_classes&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;-- %%INSERT_INIT_CLASSES%% --&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Used to specify custom system library path to run with local system libs --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;meta-data android:name=&quot;android.app.system_libs_prefix&quot; android:value=&quot;/system/lib/&quot;/&gt; --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--  Messages maps --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:value</span>=<span class="string">&quot;@string/ministro_not_found_msg&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.ministro_not_found_msg&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:value</span>=<span class="string">&quot;@string/ministro_needed_msg&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.ministro_needed_msg&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:value</span>=<span class="string">&quot;@string/fatal_error_msg&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.fatal_error_msg&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:value</span>=<span class="string">&quot;@string/unsupported_android_version&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.unsupported_android_version&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--  Messages maps --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Splash screen --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Orientation-specific (portrait/landscape) data is checked first. If not available for current orientation,</span></span><br><span class="line"><span class="comment">                 then android.app.splash_screen_drawable. For best results, use together with splash_screen_sticky and</span></span><br><span class="line"><span class="comment">                 use hideSplashScreen() with a fade-out animation from Qt Android Extras to hide the splash screen when you</span></span><br><span class="line"><span class="comment">                 are done populating your window with content. --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- meta-data android:name=&quot;android.app.splash_screen_drawable_portrait&quot; android:resource=&quot;@drawable/logo_portrait&quot; / --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- meta-data android:name=&quot;android.app.splash_screen_drawable_landscape&quot; android:resource=&quot;@drawable/logo_landscape&quot; / --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- meta-data android:name=&quot;android.app.splash_screen_drawable&quot; android:resource=&quot;@drawable/logo&quot;/ --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- meta-data android:name=&quot;android.app.splash_screen_sticky&quot; android:value=&quot;true&quot;/ --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Splash screen --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Background running --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Warning: changing this value to true may cause unexpected crashes if the</span></span><br><span class="line"><span class="comment">                          application still try to draw after</span></span><br><span class="line"><span class="comment">                          &quot;applicationStateChanged(Qt::ApplicationSuspended)&quot;</span></span><br><span class="line"><span class="comment">                          signal is sent! --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.background_running&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Background running --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- auto screen scale factor --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.auto_screen_scale_factor&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- auto screen scale factor --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- extract android style --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- available android:values :</span></span><br><span class="line"><span class="comment">                * default - In most cases this will be the same as &quot;full&quot;, but it can also be something else if needed, e.g., for compatibility reasons</span></span><br><span class="line"><span class="comment">                * full - useful QWidget &amp; Quick Controls 1 apps</span></span><br><span class="line"><span class="comment">                * minimal - useful for Quick Controls 2 apps, it is much faster than &quot;full&quot;</span></span><br><span class="line"><span class="comment">                * none - useful for apps that don&#x27;t use any of the above Qt modules</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.extract_android_style&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;minimal&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- extract android style --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:process</span>=<span class="string">&quot;:custom_activity&quot;</span> <span class="attr">android:name</span>=<span class="string">&quot;.CustomActivity&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;-- %%INSERT_APP_NAME%% --&quot;</span> <span class="attr">android:screenOrientation</span>=<span class="string">&quot;unspecified&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- android:process=&quot;:qt&quot; is needed to force the service to run on a separate process than the Activity --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;android.app.lib_name&quot;</span> <span class="attr">android:value</span>=<span class="string">&quot;-- %%INSERT_APP_LIB_NAME%% --&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.WriteToUsbActivity&quot;</span> <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;-- %%INSERT_APP_NAME%% --&quot;</span> <span class="attr">android:screenOrientation</span>=<span class="string">&quot;unspecified&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- For adding service(s) please check: https://wiki.qt.io/AndroidServices --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">receiver</span> <span class="attr">android:name</span>=<span class="string">&quot;.BootReceiver&quot;</span> <span class="attr">android:enabled</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:permission</span>=<span class="string">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span> <span class="attr">android:priority</span>=<span class="string">&quot;1000&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.BOOT_COMPLETED&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_CHECKIN_PROPERTIES&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>QTå®ä¾‹</category>
      </categories>
      <tags>
        <tag>QT for Android</tag>
        <tag>QT</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt/C++ é¡¹ç›®é›†æˆ yaml-cpp å¹¶å®ç°é…ç½®æŒä¹…åŒ–è¯»å–æ€»ç»“</title>
    <url>/2025/07/03/qt_cmake_yaml-cpp%E9%85%8D%E7%BD%AE%E5%AE%9E%E4%BE%8B/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡æ¡£æ€»ç»“å¦‚ä½•åœ¨ Qt é¡¹ç›®ä¸­é›†æˆ <code>yaml-cpp</code> å¹¶å®ç°é…ç½®æ–‡ä»¶è¯»å–è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼Œé€‚ç”¨äº Windows æ„å»ºç¯å¢ƒï¼Œä¹Ÿé€‚ç”¨äºéƒ¨ç½²åˆ° Linux&#x2F;Android ç­‰åµŒå…¥å¼å¹³å°ã€‚</p>
</blockquote>
<hr>
<p>âš ï¸é¡¹ç›®éœ€ä»¥CMakeé…ç½®ã€‚</p>
<p>ï¼ˆqmakeé…ç½®çš„æƒ…å†µä¸‹ï¼Œwin\linux\androidå„å¹³å°éœ€è¦ä¸åŒé…ç½®ï¼Œæ— æ³•åšåˆ°åŒè´¨åŒ–é€‚é…ï¼‰</p>
<hr>
<h2 id="âœ…-é¡¹ç›®ç›®æ ‡"><a href="#âœ…-é¡¹ç›®ç›®æ ‡" class="headerlink" title="âœ… é¡¹ç›®ç›®æ ‡"></a>âœ… é¡¹ç›®ç›®æ ‡</h2><ul>
<li>å°† <code>yaml-cpp</code> æºç é›†æˆè¿› Qt é¡¹ç›®ï¼Œæ— éœ€é¢å¤–å®‰è£…åº“</li>
<li>ä» <code>config.yaml</code> æ–‡ä»¶ä¸­è¯»å–é…ç½®é¡¹ï¼ˆå¦‚ usernameï¼‰</li>
<li>å°†æ„å»ºè¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶æ”¾å…¥ <code>bin/</code> ç›®å½•</li>
<li>ä¿è¯ Qt é¡¹ç›®åœ¨ MinGWã€MSVCä¸¤ç§ç¼–è¯‘å™¨ä¸‹æ„å»ºæˆåŠŸ</li>
<li>å®ç°è·¯å¾„è·¨å¹³å°å…¼å®¹ã€å¼‚å¸¸å®‰å…¨</li>
</ul>
<hr>
<h2 id="ğŸ“-å·¥ç¨‹ç»“æ„æ¨è"><a href="#ğŸ“-å·¥ç¨‹ç»“æ„æ¨è" class="headerlink" title="ğŸ“ å·¥ç¨‹ç»“æ„æ¨è"></a>ğŸ“ å·¥ç¨‹ç»“æ„æ¨è</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">untitled_project/</span><br><span class="line">â”œâ”€â”€ CMakeLists.txt</span><br><span class="line">â”œâ”€â”€ main.cpp</span><br><span class="line">â”œâ”€â”€ mainwindow.cpp/h/ui</span><br><span class="line">â”œâ”€â”€ yaml-cpp/               # ç¬¬ä¸‰æ–¹åº“æºç ï¼ˆæ–‡ä»¶å¤¹ï¼‰</span><br><span class="line">â””â”€â”€ bin/                    # å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºç›®å½•</span><br><span class="line">	â””â”€â”€ config.yaml             # YAML é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ”§-1-CMake-é…ç½®é‡ç‚¹"><a href="#ğŸ”§-1-CMake-é…ç½®é‡ç‚¹" class="headerlink" title="ğŸ”§ 1. CMake é…ç½®é‡ç‚¹"></a>ğŸ”§ 1. CMake é…ç½®é‡ç‚¹</h2><h3 id="âœ…-è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºåˆ°-bin"><a href="#âœ…-è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºåˆ°-bin" class="headerlink" title="âœ… è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºåˆ° bin&#x2F;"></a>âœ… è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶è¾“å‡ºåˆ° bin&#x2F;</h3><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/bin)</span><br></pre></td></tr></table></figure>

<h3 id="âœ…-å°†ä»githubä¸Šä¸‹è½½åˆ°çš„é¡¹ç›®æ–‡ä»¶å¤¹å»æ‰å¤šäºåç¼€ï¼Œæ›´åä¸ºyaml-cpp"><a href="#âœ…-å°†ä»githubä¸Šä¸‹è½½åˆ°çš„é¡¹ç›®æ–‡ä»¶å¤¹å»æ‰å¤šäºåç¼€ï¼Œæ›´åä¸ºyaml-cpp" class="headerlink" title="âœ… å°†ä»githubä¸Šä¸‹è½½åˆ°çš„é¡¹ç›®æ–‡ä»¶å¤¹å»æ‰å¤šäºåç¼€ï¼Œæ›´åä¸ºyaml-cpp"></a>âœ… å°†ä»githubä¸Šä¸‹è½½åˆ°çš„é¡¹ç›®æ–‡ä»¶å¤¹å»æ‰å¤šäºåç¼€ï¼Œæ›´åä¸º<code>yaml-cpp</code></h3><h3 id="âœ…-æ·»åŠ -yaml-cpp-å­ç›®å½•å¹¶é“¾æ¥"><a href="#âœ…-æ·»åŠ -yaml-cpp-å­ç›®å½•å¹¶é“¾æ¥" class="headerlink" title="âœ… æ·»åŠ  yaml-cpp å­ç›®å½•å¹¶é“¾æ¥"></a>âœ… æ·»åŠ  yaml-cpp å­ç›®å½•å¹¶é“¾æ¥</h3><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ  yaml-cpp å­ç›®å½•</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(yaml-cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ·»åŠ yaml-cpp</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">    Qt<span class="variable">$&#123;QT_VERSION_MAJOR&#125;</span>::Widgets</span><br><span class="line">    yaml-cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒ…å« yaml-cpp å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span></span><br><span class="line">    PRIVATE yaml-cpp/<span class="keyword">include</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“¦-2-æ¨èä½¿ç”¨çš„ç¨³å®šç‰ˆæœ¬"><a href="#ğŸ“¦-2-æ¨èä½¿ç”¨çš„ç¨³å®šç‰ˆæœ¬" class="headerlink" title="ğŸ“¦ 2. æ¨èä½¿ç”¨çš„ç¨³å®šç‰ˆæœ¬"></a>ğŸ“¦ 2. æ¨èä½¿ç”¨çš„ç¨³å®šç‰ˆæœ¬</h2><p>ä¸ºé¿å…ä¸æŸäº› MSVC ç¼–è¯‘å™¨ä¸å…¼å®¹ï¼Œæ¨èä½¿ç”¨ yaml-cpp çš„ç¨³å®šç‰ˆæœ¬ï¼š</p>
<ul>
<li>ğŸ”— <strong>yaml-cpp v0.7.0</strong> ä¸‹è½½åœ°å€ï¼š<br><a href="https://github.com/jbeder/yaml-cpp/releases/tag/yaml-cpp-0.7.0">https://github.com/jbeder/yaml-cpp/releases/tag/yaml-cpp-0.7.0</a></li>
</ul>
<hr>
<h2 id="ğŸ§ -3-è·¯å¾„å¤„ç†æ¨èå†™æ³•"><a href="#ğŸ§ -3-è·¯å¾„å¤„ç†æ¨èå†™æ³•" class="headerlink" title="ğŸ§  3. è·¯å¾„å¤„ç†æ¨èå†™æ³•"></a>ğŸ§  3. è·¯å¾„å¤„ç†æ¨èå†™æ³•</h2><h3 id="âœ…-ä½¿ç”¨-applicationDirPath-è·å–-exe-æ‰€åœ¨ç›®å½•"><a href="#âœ…-ä½¿ç”¨-applicationDirPath-è·å–-exe-æ‰€åœ¨ç›®å½•" class="headerlink" title="âœ… ä½¿ç”¨ applicationDirPath è·å– .exe æ‰€åœ¨ç›®å½•"></a>âœ… ä½¿ç”¨ applicationDirPath è·å– .exe æ‰€åœ¨ç›®å½•</h3><p>å°†<code>config.yaml</code>æ”¾ç½®å…¥binç›®å½•ï¼Œä»¥ç¨‹åºè¿è¡Œç›¸å¯¹è·¯å¾„è·å–<code>.yaml</code>è·¯å¾„</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">QString path = QCoreApplication::<span class="built_in">applicationDirPath</span>() + <span class="string">&quot;/config.yaml&quot;</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“„-4-å®Œæˆä¸Šè¿°æ‰€æœ‰é…ç½®åï¼ŒQT-C-ç¤ºä¾‹ä»£ç "><a href="#ğŸ“„-4-å®Œæˆä¸Šè¿°æ‰€æœ‰é…ç½®åï¼ŒQT-C-ç¤ºä¾‹ä»£ç " class="headerlink" title="ğŸ“„ 4. å®Œæˆä¸Šè¿°æ‰€æœ‰é…ç½®åï¼ŒQT C++ç¤ºä¾‹ä»£ç "></a>ğŸ“„ 4. å®Œæˆä¸Šè¿°æ‰€æœ‰é…ç½®åï¼ŒQT C++ç¤ºä¾‹ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¦‚æœå‡ºç° YAMLæ–‡ä»¶ä¸å­˜åœ¨ YAMLæ–‡ä»¶æ ¼å¼é”™è¯¯ è®¿é—®äº†ä¸å­˜åœ¨çš„å­—æ®µ</span></span><br><span class="line"><span class="comment">//å¯èƒ½ä¼šå‡ºç°æŠ¥é”™å¼¹çª—ï¼š Microsoft Visual C++ Runtime Library æŠ›å‡ºçš„ è¿è¡Œæ—¶å´©æºƒé”™è¯¯ abort()æŠ¥é”™</span></span><br><span class="line"><span class="comment">//éœ€è¦ä»¥try catchåŒ…è£¹ä»£ç </span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> <span class="comment">//ç¨‹åºæ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ç›®å½•,æŠŠ / è½¬æ¢æˆå½“å‰ç³»ç»Ÿçš„åˆ†éš”ç¬¦</span></span><br><span class="line"> QString appDir = QDir::<span class="built_in">toNativeSeparators</span>(QCoreApplication::<span class="built_in">applicationDirPath</span>() + <span class="string">&quot;/&quot;</span>);</span><br><span class="line"> <span class="comment">//é…ç½®.yamlæ–‡ä»¶åœ°å€</span></span><br><span class="line"> QString filePath = appDir + <span class="string">&quot;config.yaml&quot;</span>;</span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;é…ç½®æ–‡ä»¶è·¯å¾„:&quot;</span> &lt;&lt; filePath;</span><br><span class="line"> <span class="comment">//ä½¿ç”¨ YAML-CPP åº“æ¥åŠ è½½ä¸€ä¸ª YAML é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å…¶è§£æä¸ºä¸€ä¸ª YAML::Node èŠ‚ç‚¹å¯¹è±¡</span></span><br><span class="line"> YAML::Node config = YAML::<span class="built_in">LoadFile</span>(filePath.<span class="built_in">toStdString</span>());</span><br><span class="line">    </span><br><span class="line"> <span class="comment">//é€šè¿‡YAML::Node èŠ‚ç‚¹å¯¹è±¡è·å–æ•°æ®       </span></span><br><span class="line"> QString username = QString::<span class="built_in">fromStdString</span>(config[<span class="string">&quot;username&quot;</span>].<span class="built_in">as</span>&lt;std::string&gt;());</span><br><span class="line"> QString password = QString::<span class="built_in">fromStdString</span>(config[<span class="string">&quot;password&quot;</span>].<span class="built_in">as</span>&lt;std::string&gt;());</span><br><span class="line"> QString host = QString::<span class="built_in">fromStdString</span>(config[<span class="string">&quot;server&quot;</span>][<span class="string">&quot;host&quot;</span>].<span class="built_in">as</span>&lt;std::string&gt;());</span><br><span class="line"> <span class="type">int</span> port = config[<span class="string">&quot;server&quot;</span>][<span class="string">&quot;port&quot;</span>].<span class="built_in">as</span>&lt;<span class="type">int</span>&gt;();</span><br><span class="line"></span><br><span class="line"> <span class="type">bool</span> logging = config[<span class="string">&quot;features&quot;</span>][<span class="string">&quot;enable_logging&quot;</span>].<span class="built_in">as</span>&lt;<span class="type">bool</span>&gt;();</span><br><span class="line"> <span class="type">bool</span> cache = config[<span class="string">&quot;features&quot;</span>][<span class="string">&quot;enable_cache&quot;</span>].<span class="built_in">as</span>&lt;<span class="type">bool</span>&gt;();</span><br><span class="line"></span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;ç”¨æˆ·å:&quot;</span> &lt;&lt; username;</span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;å¯†ç :&quot;</span> &lt;&lt; password;</span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;æœåŠ¡å™¨åœ°å€:&quot;</span> &lt;&lt; host &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; port;</span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;æ˜¯å¦å¯ç”¨æ—¥å¿—:&quot;</span> &lt;&lt; logging;</span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;æ˜¯å¦å¯ç”¨ç¼“å­˜:&quot;</span> &lt;&lt; cache;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; roleNode : config[<span class="string">&quot;roles&quot;</span>]) &#123;</span><br><span class="line">  QString role = QString::<span class="built_in">fromStdString</span>(roleNode.<span class="built_in">as</span>&lt;std::string&gt;());</span><br><span class="line">  <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;è§’è‰²:&quot;</span> &lt;&lt; role;</span><br><span class="line"> &#125;</span><br><span class="line">        </span><br><span class="line">&#125; <span class="built_in">catch</span> (<span class="type">const</span> std::exception&amp; e) &#123;</span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;è¯»å–é…ç½®å¤±è´¥:&quot;</span> &lt;&lt; e.<span class="built_in">what</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âš ï¸-å¸¸è§é—®é¢˜æ±‡æ€»"><a href="#âš ï¸-å¸¸è§é—®é¢˜æ±‡æ€»" class="headerlink" title="âš ï¸ å¸¸è§é—®é¢˜æ±‡æ€»"></a>âš ï¸ å¸¸è§é—®é¢˜æ±‡æ€»</h2><table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody><tr>
<td><code>no viable conversion from QString to std::string</code></td>
<td>ä½¿ç”¨ <code>toStdString()</code></td>
</tr>
<tr>
<td><code>is_in_range</code> æ¨¡æ¿æŠ¥é”™ï¼ˆMSVCï¼‰</td>
<td>ä½¿ç”¨ä½ç‰ˆæœ¬ç¨³å®šç‰ˆ <code>yaml-cpp</code> æˆ–æ”¹ç”¨ MinGW</td>
</tr>
<tr>
<td>YAML::Load å´©æºƒæˆ–å¼‚å¸¸</td>
<td>åŠ ä¸Š <code>try-catch</code> æ•è·é”™è¯¯</td>
</tr>
</tbody></table>
<hr>
<h2 id="âœ…-ç¤ºä¾‹-config-yaml"><a href="#âœ…-ç¤ºä¾‹-config-yaml" class="headerlink" title="âœ… ç¤ºä¾‹ config.yaml"></a>âœ… ç¤ºä¾‹ config.yaml</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">username:</span> <span class="string">zhangbh</span></span><br><span class="line"><span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">features:</span></span><br><span class="line">  <span class="attr">enable_logging:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_cache:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">roles:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">admin</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">user</span></span><br></pre></td></tr></table></figure>

<hr>
<p>å¦‚éœ€éƒ¨ç½²åˆ° Linux&#x2F;Androidï¼Œåªéœ€åˆ‡æ¢å·¥å…·é“¾åé‡æ–°æ„å»ºå³å¯ã€‚</p>
]]></content>
      <categories>
        <category>QT_é…ç½®</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt ä¼ ç»Ÿæ—¥å¿—æœºåˆ¶ç¤ºä¾‹è§£æ</title>
    <url>/2025/04/12/qt_%E4%BC%A0%E7%BB%9F%E6%97%A5%E5%BF%97/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡ä»‹ç»å¦‚ä½•å°† Qt è‡ªå¸¦çš„æ—¥å¿—ï¼ˆå¦‚ <code>qDebug()</code>ã€<code>qWarning()</code> ç­‰ï¼‰é‡å®šå‘åˆ°æ–‡ä»¶ä¿å­˜ï¼Œå¹¶é€‚é…å¤šçº¿ç¨‹ç¯å¢ƒã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ“Œ-åŸºæœ¬æ¦‚å¿µ"><a href="#ğŸ“Œ-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ğŸ“Œ åŸºæœ¬æ¦‚å¿µ"></a>ğŸ“Œ åŸºæœ¬æ¦‚å¿µ</h2><p>Qt æä¾›å¦‚ä¸‹æ—¥å¿—å®ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">qDebug</span>()&lt;&lt; <span class="string">&quot;è°ƒè¯•ä¿¡æ¯&quot;</span>;</span><br><span class="line"><span class="built_in">qInfo</span>()&lt;&lt; <span class="string">&quot;ä¸€èˆ¬ä¿¡æ¯ï¼ˆQt 5.5+ï¼‰&quot;</span>;</span><br><span class="line"><span class="built_in">qWarning</span>()&lt;&lt; <span class="string">&quot;è­¦å‘Šä¿¡æ¯&quot;</span>;</span><br><span class="line"><span class="built_in">qCritical</span>()&lt;&lt; <span class="string">&quot;ä¸¥é‡é”™è¯¯ä¿¡æ¯&quot;</span>;</span><br><span class="line"><span class="built_in">qFatal</span>(<span class="string">&quot;è‡´å‘½é”™è¯¯ä¿¡æ¯&quot;</span>); <span class="comment">// è‡´å‘½é”™è¯¯ï¼Œå¼¹å‡ºè­¦å‘Šæç¤ºæ¡†ï¼Œç¨‹åºç»ˆæ­¢</span></span><br></pre></td></tr></table></figure>

<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚ä¸ºäº†ä¿å­˜åˆ°æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">qInstallMessageHandler</span>(myMessageHandler);</span><br></pre></td></tr></table></figure>

<p>å®ƒæ³¨å†Œä¸€ä¸ªå…¨å±€æ—¥å¿—å›è°ƒå‡½æ•° <code>myMessageHandler</code>ï¼Œä½ å¯ä»¥åœ¨æ­¤å‡½æ•°ä¸­å†³å®šå¦‚ä½•å¤„ç†æ—¥å¿—ï¼Œæ¯”å¦‚å†™å…¥æ–‡ä»¶ã€‚</p>
<hr>
<h2 id="ğŸ§±-å®ç°æ­¥éª¤"><a href="#ğŸ§±-å®ç°æ­¥éª¤" class="headerlink" title="ğŸ§± å®ç°æ­¥éª¤"></a>ğŸ§± å®ç°æ­¥éª¤</h2><h3 id="1-å®šä¹‰æ—¥å¿—å¤„ç†å‡½æ•°"><a href="#1-å®šä¹‰æ—¥å¿—å¤„ç†å‡½æ•°" class="headerlink" title="1. å®šä¹‰æ—¥å¿—å¤„ç†å‡½æ•°"></a>1. å®šä¹‰æ—¥å¿—å¤„ç†å‡½æ•°</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">myMessageHandler</span><span class="params">(QtMsgType type, </span></span></span><br><span class="line"><span class="params"><span class="function">                      <span class="type">const</span> QMessageLogContext &amp;context, </span></span></span><br><span class="line"><span class="params"><span class="function">                      <span class="type">const</span> QString &amp;msg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> QMutex mutex; <span class="comment">//åŠ é”</span></span><br><span class="line">    <span class="function">QMutexLocker <span class="title">locker</span><span class="params">(&amp;mutex)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é…ç½®ç›¸å¯¹åœ°å€</span></span><br><span class="line">    QString logPath = QCoreApplication::<span class="built_in">applicationDirPath</span>() + <span class="string">&quot;/logs/mylog.txt&quot;</span>;</span><br><span class="line">    <span class="built_in">QDir</span>().<span class="built_in">mkpath</span>(<span class="built_in">QFileInfo</span>(logPath).<span class="built_in">absolutePath</span>());  <span class="comment">// ç¡®ä¿ç›®å½•å­˜åœ¨</span></span><br><span class="line"></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(logPath)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::WriteOnly | QIODevice::Append))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">QTextStream <span class="title">out</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">    QString typeStr;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">        <span class="keyword">case</span> QtDebugMsg:    typeStr = <span class="string">&quot;DEBUG&quot;</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> QtInfoMsg:     typeStr = <span class="string">&quot;INFO&quot;</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> QtWarningMsg:  typeStr = <span class="string">&quot;WARNING&quot;</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> QtCriticalMsg: typeStr = <span class="string">&quot;CRITICAL&quot;</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> QtFatalMsg:    typeStr = <span class="string">&quot;FATAL&quot;</span>; <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    out &lt;&lt; <span class="string">&quot;[&quot;</span> &lt;&lt; QDateTime::<span class="built_in">currentDateTime</span>().<span class="built_in">toString</span>(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>) &lt;&lt; <span class="string">&quot;] &quot;</span></span><br><span class="line">        &lt;&lt; typeStr &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; msg</span><br><span class="line">        &lt;&lt; <span class="string">&quot; (&quot;</span> &lt;&lt; context.file &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; context.line</span><br><span class="line">        &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; context.function &lt;&lt; <span class="string">&quot;)\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-åœ¨-main-ä¸­æ³¨å†Œæ—¥å¿—å¤„ç†å™¨"><a href="#2-åœ¨-main-ä¸­æ³¨å†Œæ—¥å¿—å¤„ç†å™¨" class="headerlink" title="2.  åœ¨ main() ä¸­æ³¨å†Œæ—¥å¿—å¤„ç†å™¨"></a>2.  åœ¨ <code>main()</code> ä¸­æ³¨å†Œæ—¥å¿—å¤„ç†å™¨</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// âœ… å®‰è£…æ—¥å¿—å¤„ç†å™¨ï¼ˆå¿…é¡»æ”¾åœ¨ QApplication åˆ›å»ºä¹‹å‰ï¼‰</span></span><br><span class="line">    <span class="built_in">qInstallMessageHandler</span>(myMessageHandler);  </span><br><span class="line"></span><br><span class="line">    <span class="function">QApplication <span class="title">app</span><span class="params">(argc, argv)</span></span>;	<span class="comment">// åˆ›å»º Qt åº”ç”¨å®ä¾‹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»è¿™é‡Œå¼€å§‹çš„æ—¥å¿—éƒ½ä¼šè¢«æ•æ‰å†™å…¥ mylog.txt</span></span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;ç¨‹åºå¯åŠ¨&quot;</span>;                    </span><br><span class="line">    </span><br><span class="line">    MainWindow w;</span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> app.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-å¤šçº¿ç¨‹å®‰å…¨"><a href="#âœ…-å¤šçº¿ç¨‹å®‰å…¨" class="headerlink" title="âœ… å¤šçº¿ç¨‹å®‰å…¨"></a>âœ… å¤šçº¿ç¨‹å®‰å…¨</h2><p><code>myMessageHandler</code> ä½¿ç”¨ <code>QMutexLocker</code> æ¥ä¿è¯å†™å…¥æ–‡ä»¶æ—¶çº¿ç¨‹å®‰å…¨ï¼Œé¿å…å¤šçº¿ç¨‹å¹¶å‘å†™æ—¥å¿—æ—¶å‡ºé”™ã€‚</p>
<hr>
<h2 id="ğŸ¯-è¡¥å……æŠ€å·§"><a href="#ğŸ¯-è¡¥å……æŠ€å·§" class="headerlink" title="ğŸ¯ è¡¥å……æŠ€å·§"></a>ğŸ¯ è¡¥å……æŠ€å·§</h2><ul>
<li>å¦‚ä¸æƒ³å¼¹å‡ºæ§åˆ¶å°ï¼Œå¯åœ¨ <code>.pro</code> æ–‡ä»¶ä¸­ç§»é™¤ <code>CONFIG += console</code></li>
<li>å¯é…åˆ <code>QLoggingCategory</code> å®ç°æ¨¡å—åŒ–æ—¥å¿—è¾“å‡º</li>
<li>è‹¥éœ€æ ¼å¼æ§åˆ¶ï¼Œå¯ç”¨ <code>qSetMessagePattern()</code> è®¾ç½®å…¨å±€è¾“å‡ºæ ¼å¼</li>
</ul>
<hr>
<h2 id="ğŸ“„-è¾“å‡ºç¤ºä¾‹ï¼ˆmylog-txtï¼‰"><a href="#ğŸ“„-è¾“å‡ºç¤ºä¾‹ï¼ˆmylog-txtï¼‰" class="headerlink" title="ğŸ“„ è¾“å‡ºç¤ºä¾‹ï¼ˆmylog.txtï¼‰"></a>ğŸ“„ è¾“å‡ºç¤ºä¾‹ï¼ˆmylog.txtï¼‰</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">[2025-07-25 11:48:09] DEBUG: ç¨‹åºå¯åŠ¨ </span><br><span class="line">	(D:\myProject\qt\untitled\main.cpp:48, int __cdecl main(int,char *[]))</span><br><span class="line">[2025-07-25 11:48:09] WARNING: è­¦å‘Šä¿¡æ¯ </span><br><span class="line">	(D:\myProject\qt\untitled\main.cpp:49, int __cdecl main(int,char *[]))</span><br><span class="line">[2025-07-25 11:48:09] CRITICAL: ä¸¥é‡é”™è¯¯ä¿¡æ¯ </span><br><span class="line">	(D:\myProject\qt\untitled\main.cpp:50, int __cdecl main(int,char *[]))</span><br><span class="line">[2025-07-25 11:48:09] FATAL: è‡´å‘½é”™è¯¯ä¿¡æ¯ </span><br><span class="line">	(D:\myProject\qt\untitled\main.cpp:51, int __cdecl main(int,char *[]))</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“¦-æ¨èä½¿ç”¨åœºæ™¯"><a href="#ğŸ“¦-æ¨èä½¿ç”¨åœºæ™¯" class="headerlink" title="ğŸ“¦ æ¨èä½¿ç”¨åœºæ™¯"></a>ğŸ“¦ æ¨èä½¿ç”¨åœºæ™¯</h2><ul>
<li>å°å‹é¡¹ç›®ï¼š<code>qDebug()</code> + <code>myMessageHandler</code></li>
<li>ä¸­å‹é¡¹ç›®ï¼šå¯å¼•å…¥ <code>spdlog</code> ç­‰æ—¥å¿—åº“ç»“åˆä½¿ç”¨</li>
</ul>
]]></content>
      <categories>
        <category>QT_çŸ¥è¯†æ€»ç»“</category>
      </categories>
      <tags>
        <tag>QT</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt ä¼ ç»Ÿçº¿ç¨‹ä¸çº¿ç¨‹æ± æœºåˆ¶å¯¹æ¯”æ€»ç»“</title>
    <url>/2025/06/14/qt_%E4%BC%A0%E7%BB%9F%E7%BA%BF%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%B7%AE%E5%BC%82%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡é˜è¿°äº†ä¼ ç»Ÿçº¿ç¨‹å’Œçº¿ç¨‹æ± åœ¨åº”ç”¨åœºæ™¯å’Œç”¨æ³•ä¸Šçš„åŒºåˆ«å’Œä½¿ç”¨è¦ç‚¹ã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸€ã€æ ¸å¿ƒåŒºåˆ«æ€»è§ˆ"><a href="#ä¸€ã€æ ¸å¿ƒåŒºåˆ«æ€»è§ˆ" class="headerlink" title="ä¸€ã€æ ¸å¿ƒåŒºåˆ«æ€»è§ˆ"></a>ä¸€ã€æ ¸å¿ƒåŒºåˆ«æ€»è§ˆ</h2><table>
<thead>
<tr>
<th>å¯¹æ¯”é¡¹</th>
<th>QThread ä¼ ç»Ÿçº¿ç¨‹</th>
<th>QThreadPool + QRunnable çº¿ç¨‹æ± </th>
</tr>
</thead>
<tbody><tr>
<td>å¯åŠ¨æ–¹å¼</td>
<td><code>thread-&gt;start()</code></td>
<td><code>threadPool-&gt;start(runnable)</code></td>
</tr>
<tr>
<td>æ‰§è¡Œå…¥å£</td>
<td>é‡å†™ <code>QThread::run()</code></td>
<td>å®ç° <code>QRunnable::run()</code></td>
</tr>
<tr>
<td>æ˜¯å¦ä¸ºå­çº¿ç¨‹å¯¹è±¡æœ¬ä½“</td>
<td>âœ… <code>QThread</code> æ˜¯å­çº¿ç¨‹</td>
<td>âŒ <code>QRunnable</code> æ˜¯ä¸»çº¿ç¨‹å¯¹è±¡ï¼Œä»… run() å±äºå­çº¿ç¨‹</td>
</tr>
<tr>
<td>æ˜¯å¦æœ‰äº‹ä»¶å¾ªç¯</td>
<td>âœ”ï¸ å¯å¯ç”¨ï¼ˆé€šè¿‡ <code>exec()</code>ï¼‰</td>
<td>âŒ æ— äº‹ä»¶å¾ªç¯</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒ moveToThread</td>
<td>âœ”ï¸ å¯ç»‘å®š <code>QObject</code> å¯¹è±¡</td>
<td>âŒ ä¸æ”¯æŒ</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒä¿¡å·æ§½æœºåˆ¶</td>
<td>âœ”ï¸ å¯è·¨çº¿ç¨‹é€šä¿¡</td>
<td>âŒ é»˜è®¤ä¸æ”¯æŒï¼ˆéœ€æ‰‹åŠ¨ hackï¼‰</td>
</tr>
<tr>
<td>é€‚åˆç”¨é€”</td>
<td>é•¿æœŸå­˜åœ¨ã€å¤æ‚æ§åˆ¶ã€åè®®é€šä¿¡</td>
<td>è½»é‡ä»»åŠ¡ã€çŸ­æ—¶æ‰¹å¤„ç†</td>
</tr>
</tbody></table>
<hr>
<h2 id="äºŒã€QThread-ä¼ ç»Ÿçº¿ç¨‹ç”¨æ³•"><a href="#äºŒã€QThread-ä¼ ç»Ÿçº¿ç¨‹ç”¨æ³•" class="headerlink" title="äºŒã€QThread ä¼ ç»Ÿçº¿ç¨‹ç”¨æ³•"></a>äºŒã€QThread ä¼ ç»Ÿçº¿ç¨‹ç”¨æ³•</h2><h3 id="1-åˆ›å»ºé€»è¾‘å¯¹è±¡ä¸çº¿ç¨‹"><a href="#1-åˆ›å»ºé€»è¾‘å¯¹è±¡ä¸çº¿ç¨‹" class="headerlink" title="1. åˆ›å»ºé€»è¾‘å¯¹è±¡ä¸çº¿ç¨‹"></a>1. åˆ›å»ºé€»è¾‘å¯¹è±¡ä¸çº¿ç¨‹</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">Worker* worker = <span class="keyword">new</span> Worker;  <span class="comment">//ä»»åŠ¡å¯¹è±¡ï¼Œå¯ä»¥è¢«ç»‘å®šåˆ°å­çº¿ç¨‹çš„é€»è¾‘å¯¹è±¡ï¼Œç”¨äºæ‰§è¡Œå®é™…ä»»åŠ¡</span></span><br><span class="line">QThread* thread = <span class="keyword">new</span> QThread;  <span class="comment">//å­çº¿ç¨‹å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿ç§»å¯¹è±¡</span></span><br><span class="line">worker-&gt;moveToThread(thread); <span class="comment">//å°†ä»»åŠ¡å¯¹è±¡è¿ç§»è‡³å­çº¿ç¨‹å¯¹è±¡ï¼Œworkerå¯ä»¥ä¸ºåˆ›å»ºçº¿ç¨‹çš„thiså¯¹è±¡æœ¬èº«</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿¡å·æ§½è¿æ¥ï¼š</span></span><br><span class="line">	<span class="comment">//å½“çº¿ç¨‹å¯åŠ¨æ—¶è‡ªåŠ¨è°ƒç”¨å·¥ä½œå¯¹è±¡çš„ä»»åŠ¡å‡½æ•° doWork()</span></span><br><span class="line">connect(thread, &amp;<span class="attribute">QThread</span>::started, worker, &amp;<span class="attribute">Worker</span>::doWork); </span><br><span class="line">	<span class="comment">//å½“å·¥ä½œå¯¹è±¡å‘å‡º finished ä¿¡å·æ—¶ï¼Œé€šçŸ¥çº¿ç¨‹é€€å‡ºäº‹ä»¶å¾ªç¯</span></span><br><span class="line">connect(worker, &amp;<span class="attribute">Worker</span>::finished, thread, &amp;<span class="attribute">QThread</span>::quit);</span><br><span class="line">	<span class="comment">//å½“çº¿ç¨‹é€€å‡ºåï¼Œé”€æ¯ QThread å¯¹è±¡</span></span><br><span class="line">connect(thread, &amp;<span class="attribute">QThread</span>::finished, thread, &amp;<span class="attribute">QThread</span>::deleteLater);</span><br><span class="line">	<span class="comment">//å½“å·¥ä½œå®Œæˆï¼Œè‡ªåŠ¨é”€æ¯ worker å¯¹è±¡</span></span><br><span class="line">connect(worker, &amp;<span class="attribute">Worker</span>::finished, worker, &amp;<span class="attribute">QObject</span>::deleteLater);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">thread-&gt;start();</span><br></pre></td></tr></table></figure>

<p><code>QThread</code> æ˜¯ Qt æ¡†æ¶ä¸­ç”¨äº<strong>åˆ›å»ºå’Œç®¡ç†å­çº¿ç¨‹</strong>çš„ç±»ï¼Œæœ¬è´¨ä¸Šæ˜¯<strong>ä¸€ä¸ªçº¿ç¨‹æ§åˆ¶å™¨</strong>ã€‚</p>
<ul>
<li>å®ƒè‡ªèº«ä¸æ˜¯ç”¨æ¥å†™ä»»åŠ¡é€»è¾‘çš„</li>
<li>ä¹Ÿä¸å»ºè®®é‡å†™ <code>QThread::run()</code> æ¥åšäº‹</li>
<li>æ¨èåšæ³•æ˜¯ï¼š<strong>å°†é€»è¾‘ç±»ï¼ˆQObjectï¼‰é€šè¿‡ <code>moveToThread()</code> ç§»åˆ° <code>QThread</code> ä¸­è¿è¡Œ</strong></li>
</ul>
<h3 id="âœ…-ç‰¹ç‚¹"><a href="#âœ…-ç‰¹ç‚¹" class="headerlink" title="âœ… ç‰¹ç‚¹"></a>âœ… ç‰¹ç‚¹</h3><ul>
<li>é€»è¾‘å¯¹è±¡å¯ä»¥ç”¨ <code>moveToThread()</code> è¿ç§»è‡³çº¿ç¨‹ä¸­è¿è¡Œ</li>
<li>æ”¯æŒå®Œæ•´äº‹ä»¶å¾ªç¯ï¼šå®šæ—¶å™¨ã€ä¿¡å·æ§½ã€å¼‚æ­¥æ“ä½œ</li>
<li>é€‚åˆé•¿æœŸä¿æŒè¿è¡Œã€çŠ¶æ€é©±åŠ¨çš„ä»»åŠ¡ï¼ˆå¦‚åè®®è¿æ¥ã€è®¾å¤‡é€šè®¯ï¼‰</li>
</ul>
<hr>
<h2 id="ä¸‰ã€çº¿ç¨‹æ± -QThreadPool-QRunnable-æœºåˆ¶"><a href="#ä¸‰ã€çº¿ç¨‹æ± -QThreadPool-QRunnable-æœºåˆ¶" class="headerlink" title="ä¸‰ã€çº¿ç¨‹æ±  QThreadPool + QRunnable æœºåˆ¶"></a>ä¸‰ã€çº¿ç¨‹æ±  QThreadPool + QRunnable æœºåˆ¶</h2><h3 id="âœ…-åŸºæœ¬ç»“æ„"><a href="#âœ…-åŸºæœ¬ç»“æ„" class="headerlink" title="âœ… åŸºæœ¬ç»“æ„"></a>âœ… åŸºæœ¬ç»“æ„</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">class <span class="attribute">MyTask</span> : public <span class="title">QRunnable</span> &#123;</span><br><span class="line"><span class="attribute">public</span>:</span><br><span class="line">    <span class="keyword">void</span> run() <span class="title">override</span> &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œçš„ä»£ç å°†åœ¨çº¿ç¨‹æ± ä¸­æŸä¸ªçº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="attribute">QThreadPool</span>::globalInstance()-&gt;start(<span class="keyword">new</span> MyTask);</span><br></pre></td></tr></table></figure>

<h3 id="âœ…-ç‰¹ç‚¹-1"><a href="#âœ…-ç‰¹ç‚¹-1" class="headerlink" title="âœ… ç‰¹ç‚¹"></a>âœ… ç‰¹ç‚¹</h3><ul>
<li><p>æ— äº‹ä»¶å¾ªç¯ï¼Œä¸èƒ½ä½¿ç”¨ä¿¡å·æ§½ã€moveToThread</p>
</li>
<li><p>ä»»åŠ¡å‡½æ•° run() è¿è¡Œäºå­çº¿ç¨‹</p>
</li>
<li><p>é QObject ç±»ï¼Œä»…é€‚åˆä¸€æ¬¡æ€§çŸ­ä»»åŠ¡å¤„ç†</p>
</li>
</ul>
<h3 id="ğŸ“Œé‡ç‚¹"><a href="#ğŸ“Œé‡ç‚¹" class="headerlink" title="ğŸ“Œé‡ç‚¹"></a>ğŸ“Œé‡ç‚¹</h3><ul>
<li><p>run()å‡½æ•°å†…éƒ¨æ‰å±äºå­çº¿ç¨‹ï¼ŒMyTaskæœ¬èº«å¹¶ä¸å±äºå­çº¿ç¨‹ï¼</p>
</li>
<li><p>run()å‡½æ•°å†…éƒ¨è°ƒç”¨ä»»ä½•å±äºMyTaskæ„é€ å‡½æ•°å†…æ„å»ºçš„å¯¹è±¡ï¼Œéƒ½å±äºéæ³•è®¿é—®ï¼</p>
</li>
<li><p>run()å‡½æ•°å†…éƒ¨å¯ä»¥è°ƒç”¨MyTask.hå£°æ˜çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿™æ˜¯è¢«å…è®¸çš„ï¼</p>
</li>
</ul>
<hr>
<h2 id="å››ã€ä¸»çº¿ç¨‹å¯¹è±¡çš„è®¿é—®ä¸-QMetaObject-invokeMethod"><a href="#å››ã€ä¸»çº¿ç¨‹å¯¹è±¡çš„è®¿é—®ä¸-QMetaObject-invokeMethod" class="headerlink" title="å››ã€ä¸»çº¿ç¨‹å¯¹è±¡çš„è®¿é—®ä¸ QMetaObject::invokeMethod"></a>å››ã€ä¸»çº¿ç¨‹å¯¹è±¡çš„è®¿é—®ä¸ QMetaObject::invokeMethod</h2><h3 id="âœ…-è¯­æ³•ç»“æ„"><a href="#âœ…-è¯­æ³•ç»“æ„" class="headerlink" title="âœ… è¯­æ³•ç»“æ„"></a>âœ… è¯­æ³•ç»“æ„</h3><p>æ— è¿”å›å€¼å¤šå‚è°ƒç”¨ï¼š</p>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line"><span class="attribute">QMetaObject</span>::invokeMethod(mainObj, <span class="string">&quot;update&quot;</span>, </span><br><span class="line">                          <span class="attribute">Qt</span>::QueuedConnection,</span><br><span class="line">                          Q_ARG(QString, <span class="string">&quot;å‚æ•°ä¸€&quot;</span>),</span><br><span class="line">                          Q_ARG(QString, <span class="string">&quot;å‚æ•°äºŒ&quot;</span>),</span><br><span class="line">                          Q_ARG(<span class="built_in">int</span>, <span class="number">3</span>),</span><br><span class="line">                          Q_ARG(float, <span class="literal">true</span>));</span><br></pre></td></tr></table></figure>
<p>æœ‰è¿”å›å€¼è°ƒç”¨ï¼š</p>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QString result;</span><br><span class="line"><span class="built_in">bool</span> success = <span class="attribute">QMetaObject</span>::invokeMethod(targetObj, <span class="string">&quot;getProcessedString&quot;</span>,</span><br><span class="line">                                         <span class="attribute">Qt</span>::BlockingQueuedConnection,</span><br><span class="line">                                         Q_RETURN_ARG(QString, result),</span><br><span class="line">                                         Q_ARG(QString, <span class="string">&quot;å‚æ•°ä¸€&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="âœ…-å‚æ•°è§£æ"><a href="#âœ…-å‚æ•°è§£æ" class="headerlink" title="âœ… å‚æ•°è§£æ"></a>âœ… å‚æ•°è§£æ</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>mainObj</code></td>
<td align="left">ä¸»çº¿ç¨‹ä¸­çš„ QObject æ´¾ç”Ÿå¯¹è±¡æŒ‡é’ˆ</td>
</tr>
<tr>
<td><code>&quot;update&quot;</code></td>
<td align="left">è¦è°ƒç”¨çš„æ§½å‡½æ•°å<br />ï¼ˆå¿…é¡»æ˜¯ slot æˆ– Q_INVOKABLE å³å‡½æ•°è¢« public slots: å£°æ˜ ï¼‰</td>
</tr>
<tr>
<td><code>Qt::QueuedConnection</code></td>
<td align="left">è·¨çº¿ç¨‹æ’é˜Ÿæ‰§è¡Œ</td>
</tr>
<tr>
<td><code>Q_ARG(QString, result)</code></td>
<td align="left">å‚æ•°ç±»å‹å’Œå€¼å°è£…</td>
</tr>
<tr>
<td><code>Qt::BlockingQueuedConnection</code></td>
<td align="left">è·¨çº¿ç¨‹æ’é˜Ÿæ‰§è¡Œ  å¸¦è¿”å›å€¼</td>
</tr>
<tr>
<td><code>Q_RETURN_ARG(QString, result)</code></td>
<td align="left">è¿”å›å€¼ç±»å‹å’Œå€¼å°è£…</td>
</tr>
</tbody></table>
<h3 id="âœ…-æ‰§è¡ŒåŸç†"><a href="#âœ…-æ‰§è¡ŒåŸç†" class="headerlink" title="âœ… æ‰§è¡ŒåŸç†"></a>âœ… æ‰§è¡ŒåŸç†</h3><ul>
<li>å­çº¿ç¨‹è°ƒç”¨ <code>invokeMethod</code></li>
<li>Qt æ£€æµ‹ <code>mainObj</code> æ‰€å±çº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰</li>
<li>å°†è°ƒç”¨è¯·æ±‚æ”¾å…¥ <code>mainObj</code> æ‰€å±çº¿ç¨‹çš„äº‹ä»¶é˜Ÿåˆ—</li>
<li>æœ€ç»ˆç”±ä¸»çº¿ç¨‹äº‹ä»¶å¾ªç¯æ‰§è¡Œæ­¤æ–¹æ³•</li>
</ul>
<h3 id="âœ…-ç¤ºä¾‹"><a href="#âœ…-ç¤ºä¾‹" class="headerlink" title="âœ… ç¤ºä¾‹"></a>âœ… ç¤ºä¾‹</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">class <span class="attribute">MyTask</span> : public <span class="title">QRunnable</span> &#123;</span><br><span class="line"><span class="attribute">public</span>:</span><br><span class="line">    MyTask(QObject* target) : mainObj(target) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> run() <span class="title">override</span> &#123;</span><br><span class="line">        <span class="attribute">QMetaObject</span>::invokeMethod(mainObj, <span class="string">&quot;updateUI&quot;</span>,</span><br><span class="line">                                  <span class="attribute">Qt</span>::QueuedConnection,</span><br><span class="line">                                  Q_ARG(QString, <span class="string">&quot;ä»»åŠ¡å®Œæˆ&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="attribute">private</span>:</span><br><span class="line">    QObject* mainObj;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ğŸ“Œé‡ç‚¹-1"><a href="#ğŸ“Œé‡ç‚¹-1" class="headerlink" title="ğŸ“Œé‡ç‚¹"></a>ğŸ“Œé‡ç‚¹</h3><ul>
<li>mainObjå±äºä¸»çº¿ç¨‹ï¼ŒQMetaObject::invokeMethodå­˜åœ¨äºå­çº¿ç¨‹ä»…å£°æ˜äº†mainObjå¯¹è±¡ï¼Œä¸å±äºç›´æ¥è°ƒç”¨ï¼Œå¹¶ä¸ä¼šè§¦å‘æŠ¥é”™ã€‚</li>
<li>åœ¨ <code>run()</code> ä¸­ä½ åªæ˜¯ä½¿ç”¨å®ƒçš„åœ°å€è°ƒç”¨ <code>invokeMethod</code>ï¼Œå®é™…æ‰§è¡Œä»åœ¨ä¸»çº¿ç¨‹ã€‚</li>
</ul>
<hr>
<h2 id="äº”ã€çº¿ç¨‹å®‰å…¨æ€§è¯´æ˜"><a href="#äº”ã€çº¿ç¨‹å®‰å…¨æ€§è¯´æ˜" class="headerlink" title="äº”ã€çº¿ç¨‹å®‰å…¨æ€§è¯´æ˜"></a>äº”ã€çº¿ç¨‹å®‰å…¨æ€§è¯´æ˜</h2><h3 id="âœ…-å­çº¿ç¨‹ä¸­å¯å®‰å…¨æ“ä½œï¼š"><a href="#âœ…-å­çº¿ç¨‹ä¸­å¯å®‰å…¨æ“ä½œï¼š" class="headerlink" title="âœ… å­çº¿ç¨‹ä¸­å¯å®‰å…¨æ“ä½œï¼š"></a>âœ… å­çº¿ç¨‹ä¸­å¯å®‰å…¨æ“ä½œï¼š</h3><ul>
<li>å±€éƒ¨åŸºæœ¬ç±»å‹å˜é‡ï¼ˆint, float, QString ç­‰ï¼‰</li>
<li>ä¸ä¸å…¶ä»–çº¿ç¨‹å…±äº«çš„ç§æœ‰æ•°æ®</li>
</ul>
<h3 id="âš ï¸-éœ€è¦åŠ é”çš„æƒ…å†µï¼š"><a href="#âš ï¸-éœ€è¦åŠ é”çš„æƒ…å†µï¼š" class="headerlink" title="âš ï¸ éœ€è¦åŠ é”çš„æƒ…å†µï¼š"></a>âš ï¸ éœ€è¦åŠ é”çš„æƒ…å†µï¼š</h3><ul>
<li>å…¨å±€å˜é‡</li>
<li>å¤šçº¿ç¨‹å…±äº«çš„æˆå‘˜å˜é‡ï¼ˆstaticã€å¼•ç”¨ï¼‰</li>
</ul>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">mutex.lock();</span><br><span class="line">sharedData += <span class="number">1</span>;</span><br><span class="line">mutex.unlock();</span><br></pre></td></tr></table></figure>

<h3 id="âŒ-ä¸¥ç¦å­çº¿ç¨‹ä¸­ç›´æ¥æ“ä½œä¸»çº¿ç¨‹-UIï¼š"><a href="#âŒ-ä¸¥ç¦å­çº¿ç¨‹ä¸­ç›´æ¥æ“ä½œä¸»çº¿ç¨‹-UIï¼š" class="headerlink" title="âŒ ä¸¥ç¦å­çº¿ç¨‹ä¸­ç›´æ¥æ“ä½œä¸»çº¿ç¨‹ UIï¼š"></a>âŒ ä¸¥ç¦å­çº¿ç¨‹ä¸­ç›´æ¥æ“ä½œä¸»çº¿ç¨‹ UIï¼š</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">ui-&gt;label-&gt;setText(<span class="string">&quot;XXX&quot;</span>);  <span class="comment">// âŒ ä¸å…è®¸ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</span></span><br></pre></td></tr></table></figure>

<p>è¯·ä½¿ç”¨ <code>invokeMethod</code> æˆ–ä¿¡å·æ§½è·¨çº¿ç¨‹é€šçŸ¥ä¸»çº¿ç¨‹æ“ä½œ UIã€‚</p>
<hr>
<h2 id="å…­ã€ä¿¡å·æ§½-è·¨çº¿ç¨‹é€šä¿¡-è¦ç‚¹å£°æ˜"><a href="#å…­ã€ä¿¡å·æ§½-è·¨çº¿ç¨‹é€šä¿¡-è¦ç‚¹å£°æ˜" class="headerlink" title="å…­ã€ä¿¡å·æ§½ è·¨çº¿ç¨‹é€šä¿¡ è¦ç‚¹å£°æ˜"></a>å…­ã€ä¿¡å·æ§½ è·¨çº¿ç¨‹é€šä¿¡ è¦ç‚¹å£°æ˜</h2><h3 id="âœ…-è·¨çº¿ç¨‹é€šä¿¡æ—¶ï¼Œé¡»ä½¿ç”¨-Qt-QueuedConnection-å¼ºåˆ¶æ’é˜Ÿè°ƒç”¨æ§½å‡½æ•°"><a href="#âœ…-è·¨çº¿ç¨‹é€šä¿¡æ—¶ï¼Œé¡»ä½¿ç”¨-Qt-QueuedConnection-å¼ºåˆ¶æ’é˜Ÿè°ƒç”¨æ§½å‡½æ•°" class="headerlink" title="âœ… è·¨çº¿ç¨‹é€šä¿¡æ—¶ï¼Œé¡»ä½¿ç”¨ Qt::QueuedConnection å¼ºåˆ¶æ’é˜Ÿè°ƒç”¨æ§½å‡½æ•°"></a>âœ… è·¨çº¿ç¨‹é€šä¿¡æ—¶ï¼Œé¡»ä½¿ç”¨ Qt::QueuedConnection å¼ºåˆ¶æ’é˜Ÿè°ƒç”¨æ§½å‡½æ•°</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">connect(worker, &amp;Worker::resultReady,</span><br><span class="line">        mainWindow, &amp;MainWindow::updateUI,</span><br><span class="line">        Qt::QueuedConnection);  // å¼ºåˆ¶ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<h3 id="âš ï¸-ä¸ºä»€ä¹ˆéœ€è¦å¼ºåˆ¶æ’é˜Ÿï¼š"><a href="#âš ï¸-ä¸ºä»€ä¹ˆéœ€è¦å¼ºåˆ¶æ’é˜Ÿï¼š" class="headerlink" title="âš ï¸ ä¸ºä»€ä¹ˆéœ€è¦å¼ºåˆ¶æ’é˜Ÿï¼š"></a>âš ï¸ ä¸ºä»€ä¹ˆéœ€è¦å¼ºåˆ¶æ’é˜Ÿï¼š</h3><ul>
<li><code>Qt::AutoConnection</code> é»˜è®¤è¡Œä¸ºä¸ç¡®å®šï¼šçº¿ç¨‹æœªå¯åŠ¨æˆ–è¿ç§»å¤±è´¥æ—¶ï¼Œå¯èƒ½æ§½å‡½æ•°ä»åœ¨é”™è¯¯çº¿ç¨‹ä¸­æ‰§è¡Œ</li>
<li><code>Qt::QueuedConnection</code> å¯ç¡®ä¿æ§½å‡½æ•°<strong>æ€»æ˜¯åœ¨çº¿ç¨‹å½’å±å¯¹è±¡çš„çº¿ç¨‹ä¸­æ‰§è¡Œ</strong>ï¼ˆå¦‚ä¸»çº¿ç¨‹ï¼‰</li>
<li>é¿å…å´©æºƒã€æ­»é”ã€UI çº¿ç¨‹è®¿é—®å†²çª</li>
</ul>
<h3 id="âœ…-å¸¸è§è¿æ¥ç±»å‹è§£é‡Š"><a href="#âœ…-å¸¸è§è¿æ¥ç±»å‹è§£é‡Š" class="headerlink" title="âœ… å¸¸è§è¿æ¥ç±»å‹è§£é‡Š"></a>âœ… å¸¸è§è¿æ¥ç±»å‹è§£é‡Š</h3><table>
<thead>
<tr>
<th>è¿æ¥ç±»å‹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>Qt::AutoConnection</code></td>
<td>è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦è·¨çº¿ç¨‹ï¼Œé»˜è®¤å€¼ï¼ˆâš ï¸ä¸å®‰å…¨ï¼‰</td>
</tr>
<tr>
<td><code>Qt::DirectConnection</code></td>
<td>ç«‹å³åœ¨å½“å‰çº¿ç¨‹è°ƒç”¨æ§½å‡½æ•°ï¼ˆâš ï¸è·¨çº¿ç¨‹é£é™©ï¼‰</td>
</tr>
<tr>
<td><code>Qt::QueuedConnection</code></td>
<td>æŠ•é€’åˆ°ç›®æ ‡çº¿ç¨‹äº‹ä»¶é˜Ÿåˆ—æ‰§è¡Œï¼ˆâœ”ï¸æ¨èï¼‰</td>
</tr>
<tr>
<td><code>Qt::BlockingQueuedConnection</code></td>
<td>é˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°æ§½å‡½æ•°æ‰§è¡Œå®Œï¼ˆâš ï¸å®¹æ˜“æ­»é”ï¼‰</td>
</tr>
<tr>
<td><code>Qt::UniqueConnection</code></td>
<td>é˜²æ­¢é‡å¤è¿æ¥ï¼Œå¯ä¸å…¶ä»–è¿æ¥ç±»å‹ç»„åˆä½¿ç”¨</td>
</tr>
</tbody></table>
<hr>
<h2 id="ä¸ƒã€æ€»ç»“å»ºè®®"><a href="#ä¸ƒã€æ€»ç»“å»ºè®®" class="headerlink" title="ä¸ƒã€æ€»ç»“å»ºè®®"></a>ä¸ƒã€æ€»ç»“å»ºè®®</h2><ul>
<li><strong>åè®®æ¥å…¥ã€ä¸²å£é€šä¿¡ã€é•¿æœŸä»»åŠ¡ï¼š</strong> æ¨èä½¿ç”¨ <code>QThread + QObject + moveToThread</code> æ¨¡å¼</li>
<li><strong>é«˜å¹¶å‘çŸ­æ—¶ä»»åŠ¡ï¼Œå¦‚æ•°æ®å—è®¡ç®—ã€å›¾åƒå¤„ç†ï¼š</strong> æ¨èä½¿ç”¨ <code>QThreadPool + QRunnable</code></li>
<li>**è·¨çº¿ç¨‹é€šä¿¡ï¼š**ç»Ÿä¸€ç”¨ <code>ä¿¡å·æ§½</code> æˆ– <code>QMetaObject::invokeMethod(Qt::QueuedConnection)</code></li>
</ul>
<p>äºŒè€…å¯ä»¥åœ¨é¡¹ç›®ä¸­æ··åˆä½¿ç”¨ï¼ŒæŒ‰ç…§ä»»åŠ¡ç‰¹ç‚¹çµæ´»é€‰å‹ã€‚</p>
]]></content>
      <categories>
        <category>QT_çŸ¥è¯†æ€»ç»“</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>çº¿ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>Qt ä¸­å®ç°å…¨å±€æ•°æ®ä¸å‡½æ•°çš„å‡ ç§æ–¹å¼</title>
    <url>/2025/04/24/qt_%E5%AE%9E%E7%8E%B0%E5%85%A8%E5%B1%80%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<blockquote>
<p>åœ¨ Qt æˆ– C++ å¼€å‘ä¸­ï¼Œå…¨å±€çŠ¶æ€ç®¡ç†æ˜¯è¾ƒå¸¸è§çš„éœ€æ±‚ã€‚æœ¬æ–‡å°†æ€»ç»“å‡ ç§å¸¸è§çš„å…¨å±€æ•°æ®ä¸å‡½æ•°ç®¡ç†æ–¹å¼ï¼Œå¹¶è¯¦ç»†è¯´æ˜å„è‡ªçš„ä½¿ç”¨åœºæ™¯ã€ä¼˜ç¼ºç‚¹å’Œç¤ºä¾‹ã€‚</p>
</blockquote>
<hr>
<h2 id="âœ…-æ€»è§ˆï¼šQt-ä¸­å…¨å±€æ•°æ®-å‡½æ•°çš„å‡ ç§ä½¿ç”¨æ–¹å¼"><a href="#âœ…-æ€»è§ˆï¼šQt-ä¸­å…¨å±€æ•°æ®-å‡½æ•°çš„å‡ ç§ä½¿ç”¨æ–¹å¼" class="headerlink" title="âœ… æ€»è§ˆï¼šQt ä¸­å…¨å±€æ•°æ®&#x2F;å‡½æ•°çš„å‡ ç§ä½¿ç”¨æ–¹å¼"></a>âœ… æ€»è§ˆï¼šQt ä¸­å…¨å±€æ•°æ®&#x2F;å‡½æ•°çš„å‡ ç§ä½¿ç”¨æ–¹å¼</h2><table>
<thead>
<tr>
<th>æ–¹å¼</th>
<th>è¯´æ˜</th>
<th>æ˜¯å¦çº¿ç¨‹å®‰å…¨</th>
<th>æ˜¯å¦æ¨è</th>
</tr>
</thead>
<tbody><tr>
<td>1. <code>extern</code> å…¨å±€å˜é‡</td>
<td>ä½¿ç”¨ <code>extern</code> å£°æ˜å’Œå®šä¹‰</td>
<td>âŒ æ‰‹åŠ¨åŠ é”</td>
<td>âš ï¸ ä¸€èˆ¬</td>
</tr>
<tr>
<td>2. é™æ€ç±»æˆå‘˜å˜é‡</td>
<td><code>static</code> æˆå‘˜å½’å±ç±»æœ¬èº«</td>
<td>âŒ æ‰‹åŠ¨åŠ é”</td>
<td>âœ… æ¨è</td>
</tr>
<tr>
<td>3. å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰</td>
<td>æ§åˆ¶å¯¹è±¡å”¯ä¸€å®ä¾‹ï¼Œå…¨å±€è®¿é—®</td>
<td>âœ… å¯åŠ é”</td>
<td>âœ… å¼ºçƒˆæ¨è</td>
</tr>
<tr>
<td>4. <code>Q_GLOBAL_STATIC</code></td>
<td>Qt å®å°è£…çº¿ç¨‹å®‰å…¨é™æ€å®ä¾‹</td>
<td>âœ… çº¿ç¨‹å®‰å…¨</td>
<td>âœ… æ¨è</td>
</tr>
<tr>
<td>5. <code>qApp</code> å…¨å±€è®¿é—®</td>
<td>åœ¨ QApplication å­ç±»ä¸­æŒ‚è½½æ•°æ®</td>
<td>âš ï¸ ä¾èµ– GUI</td>
<td>âš ï¸ æœ‰é™</td>
</tr>
<tr>
<td>6. å‘½åç©ºé—´å˜é‡&#x2F;å‡½æ•°</td>
<td>ä½¿ç”¨ <code>namespace</code> ç»„ç»‡å‡½æ•°&#x2F;å˜é‡</td>
<td>âŒ æ‰‹åŠ¨åŠ é”</td>
<td>âœ… æ¨è</td>
</tr>
<tr>
<td>7. å·¥å…·å‡½æ•°</td>
<td>ç‹¬ç«‹å·¥å…·å‡½æ•°ï¼ŒStateless æ“ä½œ</td>
<td>âœ…</td>
<td>âœ… æ¨è</td>
</tr>
</tbody></table>
<hr>
<h2 id="âœ…-1-ä½¿ç”¨-extern-å£°æ˜å…¨å±€å˜é‡-å¯¹è±¡"><a href="#âœ…-1-ä½¿ç”¨-extern-å£°æ˜å…¨å±€å˜é‡-å¯¹è±¡" class="headerlink" title="âœ… 1. ä½¿ç”¨ extern å£°æ˜å…¨å±€å˜é‡&#x2F;å¯¹è±¡"></a>âœ… 1. ä½¿ç”¨ <code>extern</code> å£°æ˜å…¨å±€å˜é‡&#x2F;å¯¹è±¡</h2><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// globaldata.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;globalclass.h&quot;</span></span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> globalCounter; <span class="comment">//å˜é‡</span></span><br><span class="line"><span class="keyword">extern</span> GlobalClass *globalClass; <span class="comment">//è‡ªå®šä¹‰ç±»ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// globaldata.cpp</span></span><br><span class="line"><span class="type">int</span> globalCounter = <span class="number">0</span>;</span><br><span class="line">GlobalClass* globalClass = <span class="keyword">new</span> GlobalClass;</span><br></pre></td></tr></table></figure>

<p><code>extern</code> å£°æ˜çš„å…¨å±€å˜é‡ <strong>ä¸éœ€è¦å†™åœ¨ <code>main()</code> å‡½æ•° æ–‡ä»¶æ‰€åœ¨ä½ç½®</strong>ï¼Œå®ƒå¯ä»¥å‡ºç°åœ¨<strong>æ‰€æœ‰éœ€è¦ä½¿ç”¨è¿™ä¸ªå˜é‡çš„æ–‡ä»¶ä¸­çš„å…¨å±€ä½œç”¨åŸŸ</strong>ï¼Œå˜é‡çš„<strong>å®šä¹‰åªèƒ½æœ‰ä¸€ä¸ª</strong>ï¼Œé€šå¸¸æ”¾åœ¨ä¸€ä¸ª <code>.cpp</code> æ–‡ä»¶ä¸­ã€‚</p>
<p>âš ï¸externå£°æ˜çš„å…¨å±€å˜é‡æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå°½é‡åŠ é”ä½¿ç”¨</p>
<hr>
<h2 id="âœ…-2-é™æ€ç±»æˆå‘˜"><a href="#âœ…-2-é™æ€ç±»æˆå‘˜" class="headerlink" title="âœ… 2. é™æ€ç±»æˆå‘˜"></a>âœ… 2. é™æ€ç±»æˆå‘˜</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AppState</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> counter;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">reset</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> AppState::counter = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AppState::reset</span><span class="params">()</span> </span>&#123; counter = <span class="number">0</span>; &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-3-å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰"><a href="#âœ…-3-å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰" class="headerlink" title="âœ… 3. å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰"></a>âœ… 3. å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GlobalManager</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> GlobalManager&amp; <span class="title">instance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> GlobalManager inst;</span><br><span class="line">        <span class="keyword">return</span> inst;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">GlobalManager</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">Q_DISABLE_COPY</span>(GlobalManager)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">GlobalManager::<span class="built_in">instance</span>().counter++;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-4-ä½¿ç”¨-Qt-çš„-Q-GLOBAL-STATIC"><a href="#âœ…-4-ä½¿ç”¨-Qt-çš„-Q-GLOBAL-STATIC" class="headerlink" title="âœ… 4. ä½¿ç”¨ Qt çš„ Q_GLOBAL_STATIC"></a>âœ… 4. ä½¿ç”¨ Qt çš„ <code>Q_GLOBAL_STATIC</code></h2><p><code>Q_GLOBAL_STATIC</code> æ˜¯ Qt æä¾›çš„ä¸€ä¸ªå®ï¼Œç”¨äº <strong>åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„ã€å»¶è¿Ÿåˆå§‹åŒ–çš„å…¨å±€å•ä¾‹å¯¹è±¡</strong>ã€‚<br> å®ƒå¯ä»¥åœ¨å¤šä¸ª <code>.cpp</code> æ–‡ä»¶ä¸­å®‰å…¨ä½¿ç”¨ï¼Œé¿å…ä¼ ç»Ÿé™æ€å¯¹è±¡çš„åˆå§‹åŒ–é¡ºåºé—®é¢˜ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Q_GLOBAL_STATIC</span>(QMap&lt;QString, <span class="type">int</span>&gt;, globalMap)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨æ—¶</span></span><br><span class="line">(*<span class="built_in">globalMap</span>())[<span class="string">&quot;apple&quot;</span>] = <span class="number">5</span>; </span><br><span class="line"><span class="comment">//1ï¼šæ‹¬å·éƒ½æ˜¯å¿…é¡»çš„ï¼ŒglobalMap() æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œè¿”å›çš„æ˜¯ QMap&lt;QString, int&gt;* ç±»å‹çš„æŒ‡é’ˆã€‚</span></span><br><span class="line"><span class="comment">//2ï¼š*globalMap() æŠŠè¿™ä¸ªæŒ‡é’ˆè§£å¼•ç”¨ï¼Œå˜æˆ QMap&lt;QString, int&gt;&amp;ã€‚</span></span><br><span class="line"><span class="comment">//3ï¼šå¤–å±‚æ‹¬å· (*globalMap()) æ˜¯å¿…é¡»åŠ çš„ï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚</span></span><br><span class="line"><span class="comment">//4ï¼š(*globalMap())[&quot;apple&quot;] è®¿é—®æˆ–åˆ›å»ºé”® &quot;apple&quot; çš„å€¼ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>âš ï¸<code>Q_GLOBAL_STATIC</code>åˆ›å»ºå¯¹è±¡æ—¶ï¼Œ <strong>ä¸èƒ½é™„å¸¦æ„é€ å‡½æ•°å‚æ•°</strong>ï¼Œå®ƒåªæ”¯æŒé»˜è®¤æ„é€ å‡½æ•°ã€‚å¦‚æœéœ€è¦é™„å¸¦å‚æ•°åˆå§‹åŒ–å…¨å±€å•ä¾‹ï¼Œåº”è¯¥ç”¨ <strong><code>Q_GLOBAL_STATIC_WITH_ARGS</code></strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Q_GLOBAL_STATIC</span>(GlobalClass, globalClass) <span class="comment">//GlobalClass å¿…é¡»æœ‰é»˜è®¤æ„é€ å‡½æ•°ã€‚</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// ä½¿ç”¨æ—¶</span></span><br><span class="line"><span class="built_in">GlobalClass</span>()-&gt;<span class="built_in">myfunction</span>(<span class="string">&quot;å®å‚&quot;</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-5-QApplication-å­ç±»-å®-æ–¹å¼"><a href="#âœ…-5-QApplication-å­ç±»-å®-æ–¹å¼" class="headerlink" title="âœ… 5. QApplication å­ç±»+å® æ–¹å¼"></a>âœ… 5. QApplication å­ç±»+å® æ–¹å¼</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é‡å†™QApplication</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyQApplication</span> : <span class="keyword">public</span> QApplication &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    QString userToken;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//mainå‡½æ•°åˆå§‹åŒ–æ„é€ MyQApplication</span></span><br><span class="line"><span class="function">MyApp <span class="title">app</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–å½“å‰é¡¹ç›®å”¯ä¸€çš„ MyQApplication å®ä¾‹ ,å®šä¹‰ä¸ºå®</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> myApp (static_cast<span class="string">&lt;MyQApplication*&gt;</span>(QCoreApplication::instance()))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨å®å…¨å±€è°ƒç”¨</span></span><br><span class="line">myApp-&gt;userToken = <span class="string">&quot;abc123&quot;</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-6-å‘½åç©ºé—´æ–¹å¼"><a href="#âœ…-6-å‘½åç©ºé—´æ–¹å¼" class="headerlink" title="âœ… 6. å‘½åç©ºé—´æ–¹å¼"></a>âœ… 6. å‘½åç©ºé—´æ–¹å¼</h2><p>âš ï¸ä»…æ”¯æŒ C++17 åŠä»¥ä¸Š</p>
<p><strong>inline variables</strong>ï¼ˆå†…è”å˜é‡ï¼‰ â€”â€” å…è®¸åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰ä¸”åªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Global &#123;</span><br><span class="line">    <span class="keyword">inline</span> <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123; counter = <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Global::counter++;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="âœ…-7-å…¨å±€å·¥å…·å‡½æ•°"><a href="#âœ…-7-å…¨å±€å·¥å…·å‡½æ•°" class="headerlink" title="âœ… 7. å…¨å±€å·¥å…·å‡½æ•°"></a>âœ… 7. å…¨å±€å·¥å…·å‡½æ•°</h2><p>âš ï¸ä»…æ”¯æŒ C++17 åŠä»¥ä¸Š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Util &#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">log</span><span class="params">(<span class="type">const</span> QString&amp; msg)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;[LOG]&quot;</span> &lt;&lt; msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Util::<span class="built_in">log</span>(<span class="string">&quot;App started&quot;</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ“Œ-æ€»ç»“å»ºè®®"><a href="#ğŸ“Œ-æ€»ç»“å»ºè®®" class="headerlink" title="ğŸ“Œ æ€»ç»“å»ºè®®"></a>ğŸ“Œ æ€»ç»“å»ºè®®</h2><ul>
<li>ç®€å•æ•°æ®å¯ç”¨ <code>extern + QMutex</code>ï¼›</li>
<li>å¤šæ¨¡å—å…±äº«ç”¨ <code>static</code> æˆå‘˜ï¼›</li>
<li>å…¨å±€å¤æ‚çŠ¶æ€æ¨èç”¨å•ä¾‹ï¼›</li>
<li>è½»é‡çº¿ç¨‹å®‰å…¨é¦–é€‰ <code>Q_GLOBAL_STATIC</code>ï¼›</li>
<li>GUI å±‚æ¬¡å¯åœ¨ QApplication æŒ‚è½½ï¼›</li>
<li>å·¥å…·å‡½æ•°ã€å¸¸é‡ç»„ç»‡å»ºè®®ç”¨ <code>namespace</code>ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>QT_çŸ¥è¯†æ€»ç»“</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆC++ï¼‰</title>
    <url>/2025/04/25/qt_%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<blockquote>
<p>åœ¨ C++ çš„å…¨å±€çŠ¶æ€ç®¡ç†ä¸­ï¼Œå•ä¾‹æ¨¡å¼æ˜¯éå¸¸é‡è¦çš„è§£å†³æ–¹æ¡ˆï¼Œä¿è¯å…¶çº¿ç¨‹çš„å®‰å…¨æ€§å°¤ä¸ºé‡è¦ï¼Œæœ¬æ–‡ä»‹ç»äº†å•ä¾‹æ¨¡å¼çš„å¤šç§å½¢å¼ï¼Œç±»æ¯”äº†ä¸åŒå½¢å¼çš„å·®å¼‚ã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚</p>
<p>é€‚ç”¨äºï¼š</p>
<ul>
<li>é…ç½®ç®¡ç†å™¨</li>
<li>æ—¥å¿—ç®¡ç†å™¨</li>
<li>çº¿ç¨‹æ± </li>
<li>æ•°æ®åº“è¿æ¥æ± </li>
<li>å…¨å±€å”¯ä¸€èµ„æºç­‰</li>
</ul>
<hr>
<h2 id="äºŒã€å®ç°æ–¹å¼"><a href="#äºŒã€å®ç°æ–¹å¼" class="headerlink" title="äºŒã€å®ç°æ–¹å¼"></a>äºŒã€å®ç°æ–¹å¼</h2><h3 id="1-é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œç±»åŠ è½½å³å®ä¾‹åŒ–ï¼‰"><a href="#1-é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œç±»åŠ è½½å³å®ä¾‹åŒ–ï¼‰" class="headerlink" title="1. é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œç±»åŠ è½½å³å®ä¾‹åŒ–ï¼‰"></a>1. é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œç±»åŠ è½½å³å®ä¾‹åŒ–ï¼‰</h3><p><code>Singleton.h</code>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> SINGLETON_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SINGLETON_H</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// è·å–å…¨å±€å”¯ä¸€å®ä¾‹</span></span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton&amp; <span class="title">getInstance</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æ‹·è´æ„é€ ä¸èµ‹å€¼ï¼Œé˜²æ­¢å¤åˆ¶</span></span><br><span class="line">    <span class="built_in">Singleton</span>(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ç§æœ‰åŒ–ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ–</span></span><br><span class="line">    <span class="built_in">Singleton</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°ç§æœ‰åŒ–ï¼Œé˜²æ­¢è¢« delete</span></span><br><span class="line">    ~<span class="built_in">Singleton</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™æ€æˆå‘˜å¯¹è±¡å£°æ˜ï¼ˆæ³¨æ„è¿™é‡Œåªæ˜¯å£°æ˜ï¼‰</span></span><br><span class="line">    <span class="type">static</span> Singleton instance;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// SINGLETON_H</span></span></span><br></pre></td></tr></table></figure>
<p><code>Singleton.cpp</code>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Singleton.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»å¤–å®šä¹‰å¹¶åˆå§‹åŒ–é™æ€æˆå‘˜å˜é‡</span></span><br><span class="line">Singleton Singleton::instance;</span><br><span class="line"></span><br><span class="line">Singleton::<span class="built_in">Singleton</span>() &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Singleton æ„é€ å‡½æ•°è°ƒç”¨\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Singleton::~<span class="built_in">Singleton</span>() &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Singleton ææ„å‡½æ•°è°ƒç”¨\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Singleton&amp; <span class="title">Singleton::getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¼˜ç‚¹</strong>ï¼šçº¿ç¨‹å®‰å…¨ï¼Œç®€å•</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šç±»åŠ è½½æ—¶å³åˆ›å»ºï¼Œæµªè´¹èµ„æº</p>
<hr>
<h3 id="2-æ‡’æ±‰å¼ï¼ˆå»¶è¿ŸåŠ è½½-çº¿ç¨‹ä¸å®‰å…¨ï¼‰"><a href="#2-æ‡’æ±‰å¼ï¼ˆå»¶è¿ŸåŠ è½½-çº¿ç¨‹ä¸å®‰å…¨ï¼‰" class="headerlink" title="2. æ‡’æ±‰å¼ï¼ˆå»¶è¿ŸåŠ è½½ + çº¿ç¨‹ä¸å®‰å…¨ï¼‰"></a>2. æ‡’æ±‰å¼ï¼ˆå»¶è¿ŸåŠ è½½ + çº¿ç¨‹ä¸å®‰å…¨ï¼‰</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> Singleton* instance;</span><br><span class="line">    <span class="built_in">Singleton</span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">Singleton</span>(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!instance)</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>();</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::instance = <span class="literal">nullptr</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼ºç‚¹</strong>ï¼šå¤šçº¿ç¨‹åŒæ—¶è®¿é—®æ—¶å¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹</p>
<hr>
<h3 id="3-æ‡’æ±‰å¼-åŠ é”ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰"><a href="#3-æ‡’æ±‰å¼-åŠ é”ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰" class="headerlink" title="3. æ‡’æ±‰å¼ + åŠ é”ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰"></a>3. æ‡’æ±‰å¼ + åŠ é”ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> Singleton* instance;</span><br><span class="line">    <span class="type">static</span> std::mutex mtx;</span><br><span class="line">    <span class="built_in">Singleton</span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">Singleton</span>(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (!instance)</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>();</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::instance = <span class="literal">nullptr</span>;</span><br><span class="line">std::mutex Singleton::mtx;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-åŒé‡æ£€æŸ¥é”å®šï¼ˆDCLï¼‰"><a href="#4-åŒé‡æ£€æŸ¥é”å®šï¼ˆDCLï¼‰" class="headerlink" title="4. åŒé‡æ£€æŸ¥é”å®šï¼ˆDCLï¼‰"></a>4. åŒé‡æ£€æŸ¥é”å®šï¼ˆDCLï¼‰</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> Singleton* instance;</span><br><span class="line">    <span class="type">static</span> std::mutex mtx;</span><br><span class="line">    <span class="built_in">Singleton</span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">Singleton</span>(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!instance) &#123;</span><br><span class="line">            <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (!instance)</span><br><span class="line">                instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::instance = <span class="literal">nullptr</span>;</span><br><span class="line">std::mutex Singleton::mtx;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„</strong>ï¼šC++11 ä¹‹å <code>std::atomic</code> å¯ç”¨äºé˜²æ­¢é‡æ’åº</p>
<hr>
<h3 id="5-C-11-é™æ€å±€éƒ¨å˜é‡ï¼ˆæ¨èï¼‰"><a href="#5-C-11-é™æ€å±€éƒ¨å˜é‡ï¼ˆæ¨èï¼‰" class="headerlink" title="5. C++11 é™æ€å±€éƒ¨å˜é‡ï¼ˆæ¨èï¼‰"></a>5. C++11 é™æ€å±€éƒ¨å˜é‡ï¼ˆæ¨èï¼‰</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton&amp; <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// C++11 çº¿ç¨‹å®‰å…¨  </span></span><br><span class="line">        <span class="type">static</span> Singleton instance; <span class="comment">//åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ï¼ˆå³ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ä¸‰ã€çº¿ç¨‹å®‰å…¨çš„æªæ–½"><a href="#ä¸‰ã€çº¿ç¨‹å®‰å…¨çš„æªæ–½" class="headerlink" title="ä¸‰ã€çº¿ç¨‹å®‰å…¨çš„æªæ–½"></a>ä¸‰ã€çº¿ç¨‹å®‰å…¨çš„æªæ–½</h2><ul>
<li>ä½¿ç”¨ <code>std::mutex</code> + åŠ é”</li>
<li>C++11 <code>static</code> å±€éƒ¨å˜é‡ï¼ˆæ¨èï¼‰</li>
<li><code>std::call_once</code> + <code>std::once_flag</code>ï¼ˆé«˜çº§æ–¹æ¡ˆï¼‰</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>() &#123;&#125;</span><br><span class="line">    <span class="type">static</span> Singleton* instance;</span><br><span class="line">    <span class="type">static</span> std::once_flag flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        std::<span class="built_in">call_once</span>(flag, []()&#123; instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>(); &#125;);</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::instance = <span class="literal">nullptr</span>;</span><br><span class="line">std::once_flag Singleton::flag;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å››ã€å­çº¿ç¨‹ä¸­ä½¿ç”¨å•ä¾‹å¯¹è±¡"><a href="#å››ã€å­çº¿ç¨‹ä¸­ä½¿ç”¨å•ä¾‹å¯¹è±¡" class="headerlink" title="å››ã€å­çº¿ç¨‹ä¸­ä½¿ç”¨å•ä¾‹å¯¹è±¡"></a>å››ã€å­çº¿ç¨‹ä¸­ä½¿ç”¨å•ä¾‹å¯¹è±¡</h2><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ <code>Singleton::getInstance()</code> è·å–å•ä¾‹å¯¹è±¡å¹¶åœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨å®ƒï¼Œ<strong>ä¸éœ€è¦</strong>è°ƒç”¨ <code>moveToThread()</code>ã€‚</p>
<ol>
<li><strong>å•ä¾‹å¯¹è±¡æœ¬èº«ä¸ç»‘å®šåˆ°ä»»ä½•çº¿ç¨‹</strong>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„å®ä¾‹ã€‚</li>
<li>åˆ›å»ºæ—¶<strong>çº¿ç¨‹å®‰å…¨æ€§</strong>ç”±å•ä¾‹æœ¬èº«å®ç°ä¿è¯ï¼ˆå¦‚å‰é¢æåˆ°çš„ <code>std::once_flag</code> æˆ–é™æ€å±€éƒ¨å˜é‡ï¼‰ã€‚</li>
<li><strong>å¦‚æœå•ä¾‹çš„æˆå‘˜å‡½æ•°æ˜¯çº¿ç¨‹å®‰å…¨çš„</strong>ï¼ˆä¾‹å¦‚ä½¿ç”¨äº’æ–¥é”ä¿æŠ¤å…±äº«æ•°æ®ï¼‰ï¼Œåˆ™å¯ä»¥ç›´æ¥åœ¨å­çº¿ç¨‹ä¸­è°ƒç”¨ã€‚</li>
</ol>
<hr>
<h2 id="äº”ã€æˆå‘˜å‡½æ•°æ˜¯å¦åŠ é”ï¼Œå–å†³äºä½ æ˜¯å¦æœ‰å…±äº«èµ„æºå†™æ“ä½œâš ï¸"><a href="#äº”ã€æˆå‘˜å‡½æ•°æ˜¯å¦åŠ é”ï¼Œå–å†³äºä½ æ˜¯å¦æœ‰å…±äº«èµ„æºå†™æ“ä½œâš ï¸" class="headerlink" title="äº”ã€æˆå‘˜å‡½æ•°æ˜¯å¦åŠ é”ï¼Œå–å†³äºä½ æ˜¯å¦æœ‰å…±äº«èµ„æºå†™æ“ä½œâš ï¸"></a>äº”ã€æˆå‘˜å‡½æ•°æ˜¯å¦åŠ é”ï¼Œå–å†³äºä½ æ˜¯å¦æœ‰<strong>å…±äº«èµ„æºå†™æ“ä½œ</strong>âš ï¸</h2><p>ä¸‹é¢æ˜¯é‡ç‚¹ï¼</p>
<table>
<thead>
<tr>
<th>æƒ…å†µ</th>
<th>æ˜¯å¦éœ€è¦åŠ é”</th>
</tr>
</thead>
<tbody><tr>
<td>åªè¯»æˆå‘˜æ•°æ®</td>
<td>âŒ ä¸éœ€è¦åŠ é”</td>
</tr>
<tr>
<td>å¤šçº¿ç¨‹å¹¶å‘ä¿®æ”¹æˆå‘˜æ•°æ®</td>
<td>âœ… å¿…é¡»åŠ é”</td>
</tr>
<tr>
<td>å¤šçº¿ç¨‹è°ƒç”¨å‡½æ•°å†…åˆ›å»ºçš„å±€éƒ¨å˜é‡ï¼ˆæ ˆå˜é‡ï¼‰</td>
<td>âŒ ä¸éœ€è¦åŠ é”</td>
</tr>
<tr>
<td>è°ƒç”¨ Qt ä¿¡å·æ§½æœºåˆ¶ã€äº‹ä»¶å¾ªç¯çš„æˆå‘˜å‡½æ•°</td>
<td>âš ï¸ éœ€è¦è€ƒè™‘çº¿ç¨‹ä¸Šä¸‹æ–‡æ˜¯å¦ä¸€è‡´</td>
</tr>
</tbody></table>
<h2 id="å…­ã€æ€»ç»“å¯¹æ¯”è¡¨"><a href="#å…­ã€æ€»ç»“å¯¹æ¯”è¡¨" class="headerlink" title="å…­ã€æ€»ç»“å¯¹æ¯”è¡¨"></a>å…­ã€æ€»ç»“å¯¹æ¯”è¡¨</h2><table>
<thead>
<tr>
<th>å®ç°æ–¹å¼</th>
<th>æ˜¯å¦çº¿ç¨‹å®‰å…¨</th>
<th>æ˜¯å¦å»¶è¿ŸåŠ è½½</th>
<th>å®ç°å¤æ‚åº¦</th>
<th>æ¨èç­‰çº§</th>
</tr>
</thead>
<tbody><tr>
<td>é¥¿æ±‰å¼</td>
<td>æ˜¯</td>
<td>å¦</td>
<td>ç®€å•</td>
<td>â˜…â˜…â˜…â˜†â˜†</td>
</tr>
<tr>
<td>æ‡’æ±‰å¼</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>ç®€å•</td>
<td>â˜…â˜…â˜†â˜†â˜†</td>
</tr>
<tr>
<td>æ‡’æ±‰å¼åŠ é”</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>ä¸­</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
</tr>
<tr>
<td>åŒé‡æ£€æŸ¥é”å®š</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>ä¸­ç­‰åé«˜</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
</tr>
<tr>
<td>C++11 å±€éƒ¨é™æ€</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æœ€ç®€å•</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
</tr>
</tbody></table>
<hr>
<h2 id="ä¸ƒã€æ³¨æ„äº‹é¡¹"><a href="#ä¸ƒã€æ³¨æ„äº‹é¡¹" class="headerlink" title="ä¸ƒã€æ³¨æ„äº‹é¡¹"></a>ä¸ƒã€æ³¨æ„äº‹é¡¹</h2><ul>
<li>å•ä¾‹æ„é€ å‡½æ•°å¿…é¡»ç§æœ‰ï¼Œé˜²æ­¢å¤–éƒ¨åˆ›å»º</li>
<li>ç¦ç”¨æ‹·è´æ„é€ å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼Œé˜²æ­¢å¤åˆ¶</li>
<li>å¤šçº¿ç¨‹åœºæ™¯ä¸­åŠ¡å¿…è€ƒè™‘çº¿ç¨‹å®‰å…¨</li>
<li>Qt ä¸­å¦‚æ¶‰åŠä¿¡å·æ§½åŠ QObjectï¼Œåˆ™ä½¿ç”¨çº¿ç¨‹è¿ç§»è¦æ ¼å¤–å°å¿ƒ</li>
</ul>
]]></content>
      <categories>
        <category>QT_çŸ¥è¯†æ€»ç»“</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤šçº¿ç¨‹ä¸­çš„çº¿ç¨‹å®‰å…¨ç­–ç•¥è¯¦è§£</title>
    <url>/2025/06/14/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡è¯¦ç»†æ•´ç†äº†ä¿è¯çº¿ç¨‹å®‰å…¨çš„å„ç§å¸¸ç”¨æ‰‹æ®µï¼ŒåŒ…æ‹¬åŠ é”ã€åŸå­æ“ä½œã€çº¿ç¨‹é—´é€šä¿¡ã€è®¾è®¡æ¨¡å¼ç­‰ï¼Œé€‚åˆ C++ &#x2F; Qt å¼€å‘è€…å‚è€ƒä½¿ç”¨ã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸€ã€åŒæ­¥æœºåˆ¶ï¼ˆä¿æŠ¤å…±äº«èµ„æºï¼‰"><a href="#ä¸€ã€åŒæ­¥æœºåˆ¶ï¼ˆä¿æŠ¤å…±äº«èµ„æºï¼‰" class="headerlink" title="ä¸€ã€åŒæ­¥æœºåˆ¶ï¼ˆä¿æŠ¤å…±äº«èµ„æºï¼‰"></a>ä¸€ã€åŒæ­¥æœºåˆ¶ï¼ˆä¿æŠ¤å…±äº«èµ„æºï¼‰</h2><h3 id="1-åŠ é”ï¼ˆMutexï¼‰"><a href="#1-åŠ é”ï¼ˆMutexï¼‰" class="headerlink" title="1. åŠ é”ï¼ˆMutexï¼‰"></a>1. åŠ é”ï¼ˆMutexï¼‰</h3><blockquote>
<p>æœ€å¸¸è§ï¼Œä¹Ÿæ˜¯æœ€é€šç”¨çš„çº¿ç¨‹åŒæ­¥æ‰‹æ®µã€‚</p>
</blockquote>
<ul>
<li>C++: <code>std::mutex</code> &#x2F; <code>std::recursive_mutex</code> &#x2F; <code>std::shared_mutex</code></li>
<li>Qt: <code>QMutex</code> &#x2F; <code>QReadWriteLock</code></li>
</ul>
<h4 id="ç¤ºä¾‹ï¼ˆC-11ï¼‰ï¼š"><a href="#ç¤ºä¾‹ï¼ˆC-11ï¼‰ï¼š" class="headerlink" title="ç¤ºä¾‹ï¼ˆC++11ï¼‰ï¼š"></a>ç¤ºä¾‹ï¼ˆC++11ï¼‰ï¼š</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">std::mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">threadSafeFunc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mtx.<span class="built_in">lock</span>();</span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒº</span></span><br><span class="line">    mtx.<span class="built_in">unlock</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¨èä½¿ç”¨-RAII-å†™æ³•ï¼š"><a href="#æ¨èä½¿ç”¨-RAII-å†™æ³•ï¼š" class="headerlink" title="æ¨èä½¿ç”¨ RAII å†™æ³•ï¼š"></a>æ¨èä½¿ç”¨ RAII å†™æ³•ï¼š</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>; <span class="comment">// è‡ªåŠ¨åŠ é”å’Œè§£é”</span></span><br></pre></td></tr></table></figure>

<h4 id="Qt-ä¸­æ¨èä½¿ç”¨ï¼š"><a href="#Qt-ä¸­æ¨èä½¿ç”¨ï¼š" class="headerlink" title="Qt ä¸­æ¨èä½¿ç”¨ï¼š"></a>Qt ä¸­æ¨èä½¿ç”¨ï¼š</h4><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QMutexLocker locker(&amp;m_mutex); <span class="comment">// è‡ªåŠ¨åŠ é”/è§£é”</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-åŸå­æ“ä½œï¼ˆAtomicï¼‰"><a href="#2-åŸå­æ“ä½œï¼ˆAtomicï¼‰" class="headerlink" title="2. åŸå­æ“ä½œï¼ˆAtomicï¼‰"></a>2. åŸå­æ“ä½œï¼ˆAtomicï¼‰</h3><p>ç”¨äº<strong>æ— éœ€åŠ é”çš„ç®€å•å˜é‡</strong>æ“ä½œï¼Œæ€§èƒ½æ›´å¥½ã€‚</p>
<ul>
<li>Qt: <code>QAtomicInt</code>, <code>QAtomicPointer</code></li>
<li>C++: <code>std::atomic</code></li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">std::atomic&lt;<span class="type">int</span>&gt; counter = <span class="number">0</span>;</span><br><span class="line">counter++;</span><br></pre></td></tr></table></figure>

<p>é€‚ç”¨äºï¼šè®¡æ•°å™¨ã€è‡ªå¢IDç­‰åœºæ™¯ã€‚</p>
<hr>
<h3 id="3-æ¡ä»¶å˜é‡ï¼ˆCondition-Variableï¼‰"><a href="#3-æ¡ä»¶å˜é‡ï¼ˆCondition-Variableï¼‰" class="headerlink" title="3. æ¡ä»¶å˜é‡ï¼ˆCondition Variableï¼‰"></a>3. æ¡ä»¶å˜é‡ï¼ˆCondition Variableï¼‰</h3><p>ç”¨äºçº¿ç¨‹é—´åä½œï¼Œ<strong>ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…æ¡ä»¶è¾¾æˆåç»§ç»­æ‰§è¡Œ</strong>ã€‚</p>
<ul>
<li>C++: <code>std::condition_variable</code></li>
<li>Qt: <code>QWaitCondition</code></li>
</ul>
<hr>
<h2 id="äºŒã€çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶"><a href="#äºŒã€çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶" class="headerlink" title="äºŒã€çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶"></a>äºŒã€çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶</h2><h3 id="1-Qt-ä¿¡å·æ§½æœºåˆ¶ï¼ˆæ¨èï¼‰"><a href="#1-Qt-ä¿¡å·æ§½æœºåˆ¶ï¼ˆæ¨èï¼‰" class="headerlink" title="1. Qt ä¿¡å·æ§½æœºåˆ¶ï¼ˆæ¨èï¼‰"></a>1. Qt ä¿¡å·æ§½æœºåˆ¶ï¼ˆæ¨èï¼‰</h3><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">connect(worker, &amp;<span class="attribute">Worker</span>::finished, <span class="keyword">this</span>, &amp;<span class="attribute">MainWindow</span>::onWorkerDone, <span class="attribute">Qt</span>::QueuedConnection);</span><br></pre></td></tr></table></figure>

<ul>
<li>è·¨çº¿ç¨‹ä½¿ç”¨ <code>Qt::QueuedConnection</code>ï¼Œè‡ªåŠ¨æ’é˜Ÿå¤„ç†ï¼Œ<strong>é¿å…å¹¶å‘å†²çª</strong>ã€‚</li>
</ul>
<hr>
<h3 id="2-æ¶ˆæ¯é˜Ÿåˆ—-ç¯å½¢ç¼“å†²åŒº"><a href="#2-æ¶ˆæ¯é˜Ÿåˆ—-ç¯å½¢ç¼“å†²åŒº" class="headerlink" title="2. æ¶ˆæ¯é˜Ÿåˆ— &#x2F; ç¯å½¢ç¼“å†²åŒº"></a>2. æ¶ˆæ¯é˜Ÿåˆ— &#x2F; ç¯å½¢ç¼“å†²åŒº</h3><ul>
<li>è‡ªå®šä¹‰çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ï¼ˆå¸¦é”æˆ–æ— é”ï¼‰</li>
<li>ç”¨äºï¼šç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼Œæ•°æ®é‡‡é›†ã€ä»»åŠ¡é˜Ÿåˆ—</li>
</ul>
<hr>
<h2 id="ä¸‰ã€è®¾è®¡å±‚é¢ç­–ç•¥"><a href="#ä¸‰ã€è®¾è®¡å±‚é¢ç­–ç•¥" class="headerlink" title="ä¸‰ã€è®¾è®¡å±‚é¢ç­–ç•¥"></a>ä¸‰ã€è®¾è®¡å±‚é¢ç­–ç•¥</h2><h3 id="1-çº¿ç¨‹å°é—­ï¼ˆThread-Confinementï¼‰"><a href="#1-çº¿ç¨‹å°é—­ï¼ˆThread-Confinementï¼‰" class="headerlink" title="1. çº¿ç¨‹å°é—­ï¼ˆThread Confinementï¼‰"></a>1. çº¿ç¨‹å°é—­ï¼ˆThread Confinementï¼‰</h3><blockquote>
<p>ä¿è¯æŸèµ„æºåªç”±ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œ<strong>ä¸å…±äº«</strong>ï¼Œè‡ªç„¶çº¿ç¨‹å®‰å…¨ã€‚</p>
</blockquote>
<p>ä¾‹å¦‚ï¼šæ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹æ•°æ®åº“è¿æ¥ã€æ—¥å¿—æ–‡ä»¶å¥æŸ„ç­‰ã€‚</p>
<hr>
<h3 id="2-ä¸å¯å˜å¯¹è±¡ï¼ˆImmutableï¼‰"><a href="#2-ä¸å¯å˜å¯¹è±¡ï¼ˆImmutableï¼‰" class="headerlink" title="2. ä¸å¯å˜å¯¹è±¡ï¼ˆImmutableï¼‰"></a>2. ä¸å¯å˜å¯¹è±¡ï¼ˆImmutableï¼‰</h3><p>ä¸å¯å˜å¯¹è±¡åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯ä»¥å®‰å…¨å…±äº«ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> QString config = <span class="string">&quot;setting.conf&quot;</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-æ‹·è´è€Œéå…±äº«ï¼ˆCopy-on-writeï¼‰"><a href="#3-æ‹·è´è€Œéå…±äº«ï¼ˆCopy-on-writeï¼‰" class="headerlink" title="3. æ‹·è´è€Œéå…±äº«ï¼ˆCopy-on-writeï¼‰"></a>3. æ‹·è´è€Œéå…±äº«ï¼ˆCopy-on-writeï¼‰</h3><p>Qt å®¹å™¨å’Œ QString é»˜è®¤å®ç°äº†å†™æ—¶å¤åˆ¶ï¼ˆéšå¼å…±äº«ï¼‰ï¼Œå¦‚ï¼š</p>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QString a = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">QString b = a; <span class="comment">// å®é™…æœªå¤åˆ¶ï¼Œç›´åˆ° b ä¿®æ”¹æ—¶æ‰å¤åˆ¶</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å››ã€ç°ä»£è¯­è¨€æœºåˆ¶æ”¯æŒ"><a href="#å››ã€ç°ä»£è¯­è¨€æœºåˆ¶æ”¯æŒ" class="headerlink" title="å››ã€ç°ä»£è¯­è¨€æœºåˆ¶æ”¯æŒ"></a>å››ã€ç°ä»£è¯­è¨€æœºåˆ¶æ”¯æŒ</h2><h3 id="1-std-future-std-promiseï¼ˆC-11ï¼‰"><a href="#1-std-future-std-promiseï¼ˆC-11ï¼‰" class="headerlink" title="1. std::future &#x2F; std::promiseï¼ˆC++11ï¼‰"></a>1. <code>std::future</code> &#x2F; <code>std::promise</code>ï¼ˆC++11ï¼‰</h3><p>æ”¯æŒçº¿ç¨‹è¿”å›å€¼ã€å¼‚æ­¥ç­‰å¾…ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">std::future&lt;<span class="type">int</span>&gt; result = std::<span class="built_in">async</span>([]()&#123; <span class="keyword">return</span> <span class="number">42</span>; &#125;);</span><br><span class="line"><span class="type">int</span> value = result.<span class="built_in">get</span>(); <span class="comment">// ç­‰å¾…å¹¶è·å–ç»“æœ</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-QtConcurrentï¼ˆé«˜çº§å¹¶è¡Œæ¡†æ¶ï¼‰"><a href="#2-QtConcurrentï¼ˆé«˜çº§å¹¶è¡Œæ¡†æ¶ï¼‰" class="headerlink" title="2. QtConcurrentï¼ˆé«˜çº§å¹¶è¡Œæ¡†æ¶ï¼‰"></a>2. QtConcurrentï¼ˆé«˜çº§å¹¶è¡Œæ¡†æ¶ï¼‰</h3><p>é€‚ç”¨äºå¹¶è¡Œå¤„ç†å®¹å™¨ã€å›¾åƒæ•°æ®ç­‰ï¼š</p>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QFuture&lt;<span class="built_in">int</span>&gt; future = <span class="attribute">QtConcurrent</span>::run(myFunction);</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ <code>QFutureWatcher</code> æ¥æ”¶å›è°ƒã€‚</p>
<hr>
<h2 id="äº”ã€å…¶ä»–è¾…åŠ©å»ºè®®"><a href="#äº”ã€å…¶ä»–è¾…åŠ©å»ºè®®" class="headerlink" title="äº”ã€å…¶ä»–è¾…åŠ©å»ºè®®"></a>äº”ã€å…¶ä»–è¾…åŠ©å»ºè®®</h2><table>
<thead>
<tr>
<th>å»ºè®®</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>âœ… ç¼©å°é”ç²’åº¦</td>
<td>å°½é‡ç¼©å°åŠ é”ä»£ç èŒƒå›´ï¼Œæå‡æ€§èƒ½</td>
</tr>
<tr>
<td>âœ… é¿å…æ­»é”</td>
<td>ä¿è¯åŠ é”é¡ºåºä¸€è‡´ï¼Œå°‘ç”¨åµŒå¥—é”</td>
</tr>
<tr>
<td>âœ… å¤šç”¨å€¼ä¼ é€’ï¼Œå°‘ç”¨å…±äº«</td>
<td>å€¾å‘å±€éƒ¨å˜é‡ï¼Œå‡å°‘å…±äº«èµ„æº</td>
</tr>
<tr>
<td>âœ… ä½¿ç”¨çº¿ç¨‹æ± </td>
<td>é¿å…é¢‘ç¹åˆ›å»º&#x2F;é”€æ¯çº¿ç¨‹ï¼Œç»Ÿä¸€ç®¡ç†èµ„æº</td>
</tr>
</tbody></table>
<hr>
<h2 id="å…­ã€å…¸å‹çº¿ç¨‹å®‰å…¨å†™æ³•ï¼ˆQtï¼‰"><a href="#å…­ã€å…¸å‹çº¿ç¨‹å®‰å…¨å†™æ³•ï¼ˆQtï¼‰" class="headerlink" title="å…­ã€å…¸å‹çº¿ç¨‹å®‰å…¨å†™æ³•ï¼ˆQtï¼‰"></a>å…­ã€å…¸å‹çº¿ç¨‹å®‰å…¨å†™æ³•ï¼ˆQtï¼‰</h2><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">class <span class="title">MyClass</span> &#123;</span><br><span class="line"><span class="attribute">private</span>:</span><br><span class="line">    QMutex m_mutex;</span><br><span class="line">    <span class="built_in">int</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="attribute">public</span>:</span><br><span class="line">    <span class="keyword">void</span> increment() &#123;</span><br><span class="line">        QMutexLocker locker(&amp;m_mutex);</span><br><span class="line">        counter++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h2><p>çº¿ç¨‹å®‰å…¨çš„ç›®æ ‡æ˜¯ï¼š<strong>å¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶ä¸å‘ç”Ÿå†²çª</strong>ã€‚åŠ é”åªæ˜¯æ‰‹æ®µä¹‹ä¸€ï¼Œåˆç†çš„æ¶æ„è®¾è®¡ã€å¹¶å‘æ¨¡å‹å’Œå·¥å…·é€‰æ‹©ä¹Ÿéå¸¸å…³é”®ã€‚</p>
<p>å¦‚æœ‰æ›´å¤æ‚çš„çº¿ç¨‹éœ€æ±‚ï¼Œå¦‚çº¿ç¨‹æ± ã€å¼‚æ­¥é€šä¿¡ã€è·¨çº¿ç¨‹ GUI æ“ä½œç­‰ï¼Œå»ºè®®ç»“åˆ QtConcurrent &#x2F; QThread &#x2F; QMetaObject::invokeMethod è¿›ä¸€æ­¥æ‰©å±•ã€‚</p>
]]></content>
      <categories>
        <category>QT_çŸ¥è¯†æ€»ç»“</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>C++</tag>
        <tag>çº¿ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>é”æœºåˆ¶ä¸ç±»å‹è¯¦è§£ï¼ˆC++ / Qtï¼‰</title>
    <url>/2025/06/15/%E9%94%81%E6%9C%BA%E5%88%B6%E4%B8%8E%E7%B1%BB%E5%9E%8B%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡é’ˆå¯¹äºï¼ˆC++ &#x2F; Qtï¼‰äº’æ–¥è®¿é—®æœºåˆ¶ï¼Œå³å„ç±»äº’æ–¥é”è¿›è¡Œäº†è¯¦ç»†è¯´æ˜ï¼Œå¹¶ç®€è¦ä»‹ç»äº†QTå’ŒC++çš„é”ç®¡ç†å·¥å…·ã€‚</p>
</blockquote>
<hr>
<h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯é”æœºåˆ¶ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯é”æœºåˆ¶ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯é”æœºåˆ¶ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯é”æœºåˆ¶ï¼Ÿ</h2><p>é”æœºåˆ¶ï¼ˆLock Mechanismï¼‰æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶æ‰‹æ®µï¼Œç”¨äºé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºï¼Œä»¥é¿å…æ•°æ®ç«äº‰ï¼ˆRace Conditionï¼‰å’Œæ•°æ®ä¸ä¸€è‡´ã€‚</p>
<p>å…¶æœ¬è´¨æ˜¯é€šè¿‡ä¸€ä¸ªâ€œäº’æ–¥æ ‡å¿—â€æ§åˆ¶ä¸´ç•ŒåŒºçš„è®¿é—®ã€‚</p>
<hr>
<h2 id="äºŒã€é”çš„åŸºæœ¬åŸç†"><a href="#äºŒã€é”çš„åŸºæœ¬åŸç†" class="headerlink" title="äºŒã€é”çš„åŸºæœ¬åŸç†"></a>äºŒã€é”çš„åŸºæœ¬åŸç†</h2><ul>
<li>å¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶å¿…é¡»ä½¿ç”¨é”ã€‚</li>
<li><strong>ä¸€ä¸ªæ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥é”ä¿æŠ¤çš„ä»£ç å—</strong>ã€‚</li>
<li>å…¶ä½™çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">QMutex mutex;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">example</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mutex.<span class="built_in">lock</span>();     <span class="comment">// åŠ é”</span></span><br><span class="line">    <span class="comment">// è®¿é—®å…±äº«èµ„æº</span></span><br><span class="line">    mutex.<span class="built_in">unlock</span>();   <span class="comment">// è§£é”</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´å®‰å…¨çš„å†™æ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QMutexLocker <span class="title">locker</span><span class="params">(&amp;mutex)</span></span>;  <span class="comment">// è‡ªåŠ¨åŠ é” + è‡ªåŠ¨é‡Šæ”¾ï¼ˆRAIIï¼‰</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ä¸‰ã€å¸¸è§é”ç±»å‹"><a href="#ä¸‰ã€å¸¸è§é”ç±»å‹" class="headerlink" title="ä¸‰ã€å¸¸è§é”ç±»å‹"></a>ä¸‰ã€å¸¸è§é”ç±»å‹</h2><table>
<thead>
<tr>
<th>é”ç±»å‹</th>
<th>ç±»å</th>
<th>ç‰¹ç‚¹</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td><strong>äº’æ–¥é”</strong></td>
<td><code>QMutex</code> &#x2F; <code>std::mutex</code></td>
<td>æœ€åŸºæœ¬çš„é”ï¼Œäº’æ–¥è®¿é—®ä¸´ç•ŒåŒº</td>
<td>ä¸€èˆ¬å…±äº«èµ„æºä¿æŠ¤</td>
</tr>
<tr>
<td><strong>é€’å½’é”</strong></td>
<td><code>QRecursiveMutex</code> &#x2F; <code>std::recursive_mutex</code></td>
<td>åŒä¸€çº¿ç¨‹å¯é‡å¤åŠ é”</td>
<td>åŒä¸€å‡½æ•°é€’å½’&#x2F;å¤šå±‚è°ƒç”¨éœ€é”</td>
</tr>
<tr>
<td><strong>è¯»å†™é”</strong></td>
<td><code>QReadWriteLock</code> &#x2F; <code>std::shared_mutex</code></td>
<td>å¤šè¯»å•å†™ï¼Œæé«˜è¯»æ•ˆç‡</td>
<td>è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œå¦‚ç¼“å­˜ã€é…ç½®</td>
</tr>
<tr>
<td><strong>ä¿¡å·é‡</strong></td>
<td><code>QSemaphore</code> &#x2F; <code>std::counting_semaphore</code></td>
<td>æ§åˆ¶å¹¶å‘çº¿ç¨‹æ•°é‡</td>
<td>è¿æ¥æ± ã€é™æµå™¨</td>
</tr>
<tr>
<td><strong>æ¡ä»¶å˜é‡</strong></td>
<td><code>QWaitCondition</code> &#x2F; <code>std::condition_variable</code></td>
<td>é…åˆäº’æ–¥é”ï¼Œè¿›è¡Œçº¿ç¨‹é˜»å¡ä¸å”¤é†’</td>
<td>çº¿ç¨‹åŒæ­¥ã€ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹</td>
</tr>
<tr>
<td><strong>åŸå­å˜é‡</strong></td>
<td><code>std::atomic&lt;T&gt;</code></td>
<td>æ— é”æ“ä½œï¼Œåº•å±‚ä½¿ç”¨åŸå­æŒ‡ä»¤</td>
<td>ç®€å•å˜é‡å¹¶å‘å®‰å…¨å¤„ç†</td>
</tr>
</tbody></table>
<hr>
<h2 id="å››ã€å„ç±»é”è¯¦ç»†è¯´æ˜"><a href="#å››ã€å„ç±»é”è¯¦ç»†è¯´æ˜" class="headerlink" title="å››ã€å„ç±»é”è¯¦ç»†è¯´æ˜"></a>å››ã€å„ç±»é”è¯¦ç»†è¯´æ˜</h2><h3 id="1-QMutex-std-mutex"><a href="#1-QMutex-std-mutex" class="headerlink" title="1. QMutex &#x2F; std::mutex"></a>1. QMutex &#x2F; std::mutex</h3><ul>
<li>æœ€å¸¸è§äº’æ–¥é”ã€‚</li>
<li>å¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œä½¿ç”¨åŠ é”&#x2F;è§£é”æ§åˆ¶ã€‚</li>
<li>Qt æ¨èé…åˆ <code>QMutexLocker</code> ä½¿ç”¨ï¼ŒC++ æ¨è <code>std::lock_guard</code>ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">QMutex mutex;</span><br><span class="line"><span class="function">QMutexLocker <span class="title">locker</span><span class="params">(&amp;mutex)</span></span>; <span class="comment">// æ¨èæ–¹å¼</span></span><br></pre></td></tr></table></figure>

<h3 id="2-QRecursiveMutex-std-recursive-mutex"><a href="#2-QRecursiveMutex-std-recursive-mutex" class="headerlink" title="2. QRecursiveMutex &#x2F; std::recursive_mutex"></a>2. QRecursiveMutex &#x2F; std::recursive_mutex</h3><ul>
<li>æ”¯æŒ<strong>åŒä¸€çº¿ç¨‹é‡å¤åŠ é”</strong>ï¼Œä½†éœ€è¦å¯¹åº”æ¬¡æ•°è§£é”ã€‚</li>
<li>å¦‚æœä½ é€’å½’è°ƒç”¨äº†æŸä¸ªéœ€è¦åŠ é”çš„å‡½æ•°ï¼Œä½¿ç”¨é€’å½’é”å¯é¿å…æ­»é”ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">QRecursiveMutex rmutex;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">QMutexLocker <span class="title">locker</span><span class="params">(&amp;rmutex)</span></span>;</span><br><span class="line">    <span class="built_in">foo</span>(); <span class="comment">// é€’å½’å®‰å…¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-QReadWriteLock-std-shared-mutex"><a href="#3-QReadWriteLock-std-shared-mutex" class="headerlink" title="3. QReadWriteLock &#x2F; std::shared_mutex"></a>3. QReadWriteLock &#x2F; std::shared_mutex</h3><ul>
<li><strong>å¤šä¸ªçº¿ç¨‹å¯åŒæ—¶è¯»</strong>ï¼Œä½†å†™æ—¶ç‹¬å ã€‚</li>
<li>å¦‚æœä½ æœ‰å¤§é‡è¯»æ“ä½œï¼Œè¯»å†™é”å¯æå‡æ€§èƒ½ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">QReadWriteLock lock;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»çº¿ç¨‹</span></span><br><span class="line">lock.<span class="built_in">lockForRead</span>();</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">lock.<span class="built_in">unlock</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™çº¿ç¨‹</span></span><br><span class="line">lock.<span class="built_in">lockForWrite</span>();</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">lock.<span class="built_in">unlock</span>();</span><br></pre></td></tr></table></figure>

<h3 id="4-QSemaphore-std-counting-semaphore"><a href="#4-QSemaphore-std-counting-semaphore" class="headerlink" title="4. QSemaphore &#x2F; std::counting_semaphore"></a>4. QSemaphore &#x2F; std::counting_semaphore</h3><ul>
<li>è¡¨ç¤º<strong>èµ„æºæ•°é‡</strong>ï¼Œå¯ä»¥æ§åˆ¶åŒæ—¶è®¿é—®æŸèµ„æºçš„çº¿ç¨‹æ•°ã€‚</li>
<li>ç±»ä¼¼â€œé€šè¡Œè¯â€ï¼Œæ¯æ¬¡ <code>acquire()</code> æ¶ˆè€—ä¸€ä¸ªï¼Œ<code>release()</code> å½’è¿˜ä¸€ä¸ªã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QSemaphore <span class="title">sem</span><span class="params">(<span class="number">3</span>)</span></span>; <span class="comment">// æœ€å¤šå…è®¸3ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥</span></span><br><span class="line">sem.<span class="built_in">acquire</span>();</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">sem.<span class="built_in">release</span>();</span><br></pre></td></tr></table></figure>

<h3 id="5-QWaitCondition-std-condition-variable"><a href="#5-QWaitCondition-std-condition-variable" class="headerlink" title="5. QWaitCondition &#x2F; std::condition_variable"></a>5. QWaitCondition &#x2F; std::condition_variable</h3><ul>
<li>ç”¨äº<strong>çº¿ç¨‹é˜»å¡ä¸å”¤é†’</strong>ã€‚</li>
<li>é€šå¸¸ä¸ <code>QMutex</code> é…åˆï¼Œåœ¨çº¿ç¨‹éœ€è¦ç­‰å¾…æŸä¸ªæ¡ä»¶è¾¾æˆæ—¶ä½¿ç”¨ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">QMutex mutex;</span><br><span class="line">QWaitCondition cond;</span><br><span class="line"></span><br><span class="line">mutex.<span class="built_in">lock</span>();</span><br><span class="line">cond.<span class="built_in">wait</span>(&amp;mutex);  <span class="comment">// é˜»å¡ç­‰å¾…</span></span><br><span class="line">mutex.<span class="built_in">unlock</span>();</span><br><span class="line"></span><br><span class="line">cond.<span class="built_in">wakeOne</span>(); <span class="comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹</span></span><br></pre></td></tr></table></figure>

<h3 id="6-std-atomic"><a href="#6-std-atomic" class="headerlink" title="6. std::atomic"></a>6. std::atomic<T></h3><ul>
<li>C++ åŸå­ç±»å‹ï¼Œ<strong>æ— é”</strong>å®ç°çº¿ç¨‹å®‰å…¨çš„å˜é‡è®¿é—®ã€‚</li>
<li>é€‚ç”¨äºç®€å•çš„æ•°å€¼ç±»å‹ï¼ˆå¦‚ intã€boolï¼‰ç­‰ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">std::atomic&lt;<span class="type">int</span>&gt; <span class="title">count</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">count++;   <span class="comment">// åŸå­è‡ªå¢ï¼Œæ— éœ€åŠ é”</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="äº”ã€é”ç®¡ç†å·¥å…·"><a href="#äº”ã€é”ç®¡ç†å·¥å…·" class="headerlink" title="äº”ã€é”ç®¡ç†å·¥å…·"></a>äº”ã€é”ç®¡ç†å·¥å…·</h2><h3 id="1-Qt-å’Œ-C-é”ç®¡ç†å·¥å…·çš„å¯¹æ¯”"><a href="#1-Qt-å’Œ-C-é”ç®¡ç†å·¥å…·çš„å¯¹æ¯”" class="headerlink" title="1. Qt å’Œ C++ é”ç®¡ç†å·¥å…·çš„å¯¹æ¯”"></a>1. Qt å’Œ C++ é”ç®¡ç†å·¥å…·çš„å¯¹æ¯”</h3><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Qt (<code>QMutexLocker</code>)</th>
<th>C++ (<code>std::lock_guard</code> &#x2F; <code>std::unique_lock</code>)</th>
</tr>
</thead>
<tbody><tr>
<td><strong>è‡ªåŠ¨åŠ é”ä¸è§£é”</strong></td>
<td>âœ… è‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨è§£é”</td>
<td>âœ… è‡ªåŠ¨åŠ é”ã€è‡ªåŠ¨è§£é”ï¼ˆ<code>std::lock_guard</code>ï¼‰</td>
</tr>
<tr>
<td><strong>æ‰‹åŠ¨è§£é”æ”¯æŒ</strong></td>
<td>âŒ ä¸æ”¯æŒ</td>
<td>âœ… æ”¯æŒï¼ˆ<code>std::unique_lock</code>ï¼‰</td>
</tr>
<tr>
<td><strong>çµæ´»æ€§</strong></td>
<td>âŒ åªæ”¯æŒç®€å•åŠ é”</td>
<td>âœ… æ”¯æŒæ›´å¤æ‚çš„åŠ é”å’Œè§£é”åœºæ™¯ï¼ˆ<code>std::unique_lock</code>ï¼‰</td>
</tr>
<tr>
<td><strong>æ€§èƒ½</strong></td>
<td>è¾ƒé«˜ï¼ˆç®€åŒ–ï¼‰</td>
<td><code>std::lock_guard</code> è¾ƒè½»ï¼Œ<code>std::unique_lock</code> è¾ƒé‡</td>
</tr>
<tr>
<td><strong>é€‚ç”¨åœºæ™¯</strong></td>
<td>ç®€å•åŠ é”ä¿æŠ¤</td>
<td>ç®€å•åŠ é”ï¼ˆ<code>std::lock_guard</code>ï¼‰ã€å¤æ‚åŠ é”ï¼ˆ<code>std::unique_lock</code>ï¼‰</td>
</tr>
<tr>
<td><strong>å¹³å°æ”¯æŒ</strong></td>
<td>ä»… Qt</td>
<td>C++ æ ‡å‡†åº“ï¼ˆè·¨å¹³å°ï¼‰</td>
</tr>
</tbody></table>
<h3 id="2-Qtï¼šQMutexLocker"><a href="#2-Qtï¼šQMutexLocker" class="headerlink" title="2. Qtï¼šQMutexLocker"></a>2. Qtï¼š<code>QMutexLocker</code></h3><ul>
<li><strong>ä½œç”¨</strong>ï¼š<code>QMutexLocker</code> æ˜¯ Qt æä¾›çš„ä¸€ä¸ªç®€åŒ–åŠ é”çš„å·¥å…·ã€‚å®ƒéµå¾ª <strong>RAII</strong>ï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰æ¨¡å¼ï¼Œè‡ªåŠ¨åŠ é”å’Œè‡ªåŠ¨è§£é”ã€‚</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šé€‚åˆåœ¨ç®€å•çš„é”ä¿æŠ¤åœºæ™¯ä¸­ä½¿ç”¨ã€‚è‡ªåŠ¨ç®¡ç†é”ï¼Œé¿å…æ‰‹åŠ¨ç®¡ç†æ—¶å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ï¼ˆå¦‚å¿˜è®°è§£é”ï¼‰ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼š</li>
</ul>
<figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">cppå¤åˆ¶ç¼–è¾‘QMutex mutex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> func() &#123;</span><br><span class="line">    QMutexLocker locker(&amp;mutex);  <span class="comment">// è‡ªåŠ¨åŠ é”</span></span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒºä»£ç </span></span><br><span class="line">&#125;  <span class="comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨è§£é”</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼š<ul>
<li>è‡ªåŠ¨åŠ é”å’Œè§£é”ï¼Œé¿å…å¿˜è®°è§£é”çš„é£é™©ã€‚</li>
<li>é€‚ç”¨äºç®€å•çš„ä¸´ç•ŒåŒºä¿æŠ¤ã€‚</li>
</ul>
</li>
<li><strong>ç¼ºç‚¹</strong>ï¼š<ul>
<li>åªæ”¯æŒè‡ªåŠ¨åŠ é”å’Œè§£é”ï¼Œä¸æ”¯æŒæ‰‹åŠ¨è§£é”ã€‚</li>
</ul>
</li>
</ul>
<h3 id="3-C-ï¼šstd-lock-guard"><a href="#3-C-ï¼šstd-lock-guard" class="headerlink" title="3. C++ï¼šstd::lock_guard"></a>3. C++ï¼š<code>std::lock_guard</code></h3><ul>
<li><strong>ä½œç”¨</strong>ï¼š<code>std::lock_guard</code> æ˜¯ C++11 ä¸­å¼•å…¥çš„é”ç®¡ç†å·¥å…·ã€‚å®ƒä¹Ÿéµå¾ª <strong>RAII</strong> æ¨¡å¼ï¼Œè‡ªåŠ¨ç®¡ç†é”ã€‚</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºç®€å•çš„åŠ é”ä¿æŠ¤ï¼Œä¸éœ€è¦æ‰‹åŠ¨è§£é”çš„åœºæ™¯ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼š</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">cppå¤åˆ¶ç¼–è¾‘<span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;  <span class="comment">// è‡ªåŠ¨åŠ é”</span></span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒºä»£ç </span></span><br><span class="line">&#125;  <span class="comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨è§£é”</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼š<ul>
<li>è‡ªåŠ¨åŠ é”å’Œè§£é”ï¼Œé¿å…æ‰‹åŠ¨è§£é”çš„é—®é¢˜ã€‚</li>
<li>é€‚ç”¨äºç®€å•çš„åŠ é”ä¿æŠ¤ï¼Œä»£ç ç®€æ´ã€‚</li>
</ul>
</li>
<li><strong>ç¼ºç‚¹</strong>ï¼š<ul>
<li>åªæ”¯æŒè‡ªåŠ¨åŠ é”å’Œè§£é”ï¼Œä¸æ”¯æŒæ‰‹åŠ¨è§£é”ã€‚</li>
</ul>
</li>
</ul>
<h3 id="4-C-ï¼šstd-unique-lock"><a href="#4-C-ï¼šstd-unique-lock" class="headerlink" title="4. C++ï¼šstd::unique_lock"></a>4. C++ï¼š<code>std::unique_lock</code></h3><ul>
<li><strong>ä½œç”¨</strong>ï¼š<code>std::unique_lock</code> æ˜¯ C++11 å¼•å…¥çš„ä¸€ä¸ªæ›´çµæ´»çš„é”ç®¡ç†å·¥å…·ã€‚å®ƒæ”¯æŒè‡ªåŠ¨åŠ é”ã€æ‰‹åŠ¨è§£é”ã€é‡æ–°åŠ é”ç­‰åŠŸèƒ½ã€‚</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºéœ€è¦çµæ´»æ§åˆ¶é”çš„åœºæ™¯ï¼Œä¾‹å¦‚éœ€è¦å»¶è¿ŸåŠ é”æˆ–æ‰‹åŠ¨è§£é”çš„æƒ…å†µã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼š</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">cppå¤åˆ¶ç¼–è¾‘<span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>;  <span class="comment">// è‡ªåŠ¨åŠ é”</span></span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒºä»£ç </span></span><br><span class="line"></span><br><span class="line">    lock.<span class="built_in">unlock</span>();  <span class="comment">// æ‰‹åŠ¨è§£é”</span></span><br><span class="line">    <span class="comment">// å…¶ä»–æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">    lock.<span class="built_in">lock</span>();    <span class="comment">// é‡æ–°åŠ é”</span></span><br><span class="line">&#125;  <span class="comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨è§£é”</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼š<ul>
<li>æ”¯æŒçµæ´»çš„é”ç®¡ç†ï¼Œå¯ä»¥æ‰‹åŠ¨è§£é”å’Œé‡æ–°åŠ é”ã€‚</li>
<li>åœ¨æ›´å¤æ‚çš„å¤šçº¿ç¨‹åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚</li>
</ul>
</li>
<li><strong>ç¼ºç‚¹</strong>ï¼š<ul>
<li>æ¯” <code>std::lock_guard</code> ç¨é‡ï¼Œæ€§èƒ½å¼€é”€æ›´å¤§ã€‚</li>
</ul>
</li>
</ul>
<h2 id="å…­ã€å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹"><a href="#å…­ã€å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹" class="headerlink" title="å…­ã€å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹"></a>å…­ã€å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹</h2><h3 id="1-æ˜¯å¦é”ä½äº†å˜é‡ï¼Ÿ"><a href="#1-æ˜¯å¦é”ä½äº†å˜é‡ï¼Ÿ" class="headerlink" title="1. æ˜¯å¦é”ä½äº†å˜é‡ï¼Ÿ"></a>1. æ˜¯å¦é”ä½äº†å˜é‡ï¼Ÿ</h3><blockquote>
<p>âŒ é”ä½çš„ä¸æ˜¯å˜é‡ï¼Œè€Œæ˜¯è®¿é—®å˜é‡çš„ä»£ç å—ã€‚<br>âœ… åªæœ‰æ‰€æœ‰è®¿é—®è·¯å¾„éƒ½åŠ é”ï¼Œæ‰èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</p>
</blockquote>
<h3 id="2-æ­»é”é—®é¢˜"><a href="#2-æ­»é”é—®é¢˜" class="headerlink" title="2. æ­»é”é—®é¢˜"></a>2. æ­»é”é—®é¢˜</h3><ul>
<li>å¤šä¸ªçº¿ç¨‹<strong>å¾ªç¯ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é”</strong>ä¼šé€ æˆç¨‹åºæ°¸ä¹…å¡ä½ã€‚</li>
<li>å»ºè®®ç»Ÿä¸€åŠ é”é¡ºåºï¼Œé¿å…å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ã€‚</li>
</ul>
<h3 id="3-æ€§èƒ½æŸè€—"><a href="#3-æ€§èƒ½æŸè€—" class="headerlink" title="3. æ€§èƒ½æŸè€—"></a>3. æ€§èƒ½æŸè€—</h3><ul>
<li>è¿‡å¤šåŠ é”ä¼šå¯¼è‡´çº¿ç¨‹é¢‘ç¹åˆ‡æ¢ï¼Œå½±å“æ€§èƒ½ã€‚</li>
<li>ä¼˜åŒ–ç­–ç•¥ï¼šç¼©å°ä¸´ç•ŒåŒºã€ä½¿ç”¨è¯»å†™é”ã€ç”¨åŸå­å˜é‡ä»£æ›¿é”ã€‚</li>
</ul>
<hr>
<h2 id="ä¸ƒã€é”æœºåˆ¶ç¤ºæ„å›¾"><a href="#ä¸ƒã€é”æœºåˆ¶ç¤ºæ„å›¾" class="headerlink" title="ä¸ƒã€é”æœºåˆ¶ç¤ºæ„å›¾"></a>ä¸ƒã€é”æœºåˆ¶ç¤ºæ„å›¾</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">çº¿ç¨‹A         çº¿ç¨‹B</span><br><span class="line">  |              |</span><br><span class="line">lock(mutex)    lock(mutex)  &lt;-- é˜»å¡ç­‰å¾…</span><br><span class="line">  |              |</span><br><span class="line">[ä¸´ç•ŒåŒº]        ç­‰å¾…ä¸­</span><br><span class="line">  |              |</span><br><span class="line">unlock(mutex)   è·å¾—é”åæ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a>å…«ã€æ€»ç»“</h2><ul>
<li>åŠ é”ä¿æŠ¤çš„æ˜¯ä»£ç å—ï¼Œä¸æ˜¯å˜é‡æœ¬èº« </li>
<li>æ‰€æœ‰è®¿é—®å…±äº«èµ„æºçš„è·¯å¾„éƒ½å¿…é¡»åŠ é” </li>
<li>æ¨èä½¿ç”¨ RAII é£æ ¼ç®¡ç†é”ï¼ˆå¦‚ QMutexLockerï¼‰ </li>
<li>å¯¹ç®€å•å˜é‡æ¨èä½¿ç”¨ <code>std::atomic</code> æ›¿ä»£é” </li>
<li>æ³¨æ„æ­»é”ã€æ€§èƒ½ã€è°ƒè¯•æˆæœ¬é—®é¢˜</li>
</ul>
<p>å¦‚éœ€æ›´é«˜çº§çš„å¹¶å‘æ¨¡å‹ï¼Œè¿˜å¯ä»¥è€ƒè™‘ Qt Concurrentã€çº¿ç¨‹æ± ï¼ˆ<code>QThreadPool</code>ï¼‰ã€ä»»åŠ¡é˜Ÿåˆ—ç­‰æ–¹å¼ã€‚</p>
]]></content>
      <categories>
        <category>QT_çŸ¥è¯†æ€»ç»“</category>
      </categories>
      <tags>
        <tag>QT</tag>
        <tag>C++</tag>
        <tag>çº¿ç¨‹</tag>
      </tags>
  </entry>
</search>
